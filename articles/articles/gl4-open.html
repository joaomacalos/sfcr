<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 6: Models REG and OPEN • sfcr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Chapter 6: Models REG and OPEN">
<meta property="og:description" content="sfcr">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@jpmacalos">
<meta name="twitter:site" content="www.joaomacalos.com">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">sfcr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/gl1-sim.html">Chapter 3: Model SIM</a>
    </li>
    <li>
      <a href="../../articles/articles/gl2-pc.html">Chapter 4: Model PC</a>
    </li>
    <li>
      <a href="../../articles/articles/gl3-lp.html">Chapter 5: Model LP</a>
    </li>
    <li>
      <a href="../../articles/articles/gl4-open.html">Chapter 6: Models REG and OPEN</a>
    </li>
    <li>
      <a href="../../articles/articles/gl5-bmw.html">Chapter 7: Model BMW</a>
    </li>
    <li>
      <a href="../../articles/articles/gl6-dis.html">Chapter 9: Model DIS and DISINF</a>
    </li>
    <li>
      <a href="../../articles/articles/gl7-insout.html">Chapter 10: Model INSOUT</a>
    </li>
    <li>
      <a href="../../articles/articles/gl8-growth.html">Chapter 11: Model GROWTH</a>
    </li>
    <li>
      <a href="../../articles/articles/gl9-open12.html">Chapter 12: Model Advanced OPEN</a>
    </li>
    <li>
      <a href="../../articles/sfcr_multis.html">sfcr_multis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/joaomacalos/sfcr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="gl4-open_files/kePrint-0.0.1/kePrint.js"></script><link href="gl4-open_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="gl4-open_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="gl4-open_files/d3-4.5.0/d3.min.js"></script><script src="gl4-open_files/sankey-1/sankey.js"></script><script src="gl4-open_files/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Chapter 6: Models REG and OPEN</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/joaomacalos/sfcr/blob/master/vignettes/articles/gl4-open.Rmd"><code>vignettes/articles/gl4-open.Rmd</code></a></small>
      <div class="hidden name"><code>gl4-open.Rmd</code></div>

    </div>

    
    
<p>Required packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joaomacalos/sfcr">sfcr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="co">#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</span>
<span class="co">#&gt; ✔ ggplot2 3.3.5     ✔ purrr   0.3.4</span>
<span class="co">#&gt; ✔ tibble  3.1.5     ✔ dplyr   1.0.7</span>
<span class="co">#&gt; ✔ tidyr   1.1.4     ✔ stringr 1.4.0</span>
<span class="co">#&gt; ✔ readr   2.0.2     ✔ forcats 0.5.1</span>
<span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span>
<span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></code></pre></div>
<div id="model-reg" class="section level1">
<h1 class="hasAnchor">
<a href="#model-reg" class="anchor"></a>Model REG</h1>
<p>We start this notebook with the model <strong>REG</strong>, that represents a country with two regions and a single monetary and fiscal authority. This model is presented in <span class="citation">Godley and Lavoie (2007, 171–87)</span>.</p>
<p>This model draws upon the PC model, dividing its private sector into two entities: “north” and “south”.</p>
<p>From this model onward there will be a proliferation of subscripts and superscripts. If not stated otherwise, I will try to follow the convention below when naming the variables:</p>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
Variable name
</th>
<th style="text-align:left;">
subscript
</th>
<th style="text-align:left;">
_SUPERSCRIPT
</th>
<th style="text-align:left;">
result
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Y
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
_N
</td>
<td style="text-align:left;">
Y_N
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
h
</td>
<td style="text-align:left;">
_S
</td>
<td style="text-align:left;">
Bh_S
</td>
</tr>
</tbody>
</table>
<div id="equations" class="section level2">
<h2 class="hasAnchor">
<a href="#equations" class="anchor"></a>Equations</h2>
<p>As usual, we start by writing down the equations, exogenous variables, and parameters:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg_eqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">Y_N</span> <span class="op">~</span> <span class="va">C_N</span> <span class="op">+</span> <span class="va">G_N</span> <span class="op">+</span> <span class="va">X_N</span> <span class="op">-</span> <span class="va">IM_N</span>,
  <span class="va">Y_S</span> <span class="op">~</span> <span class="va">C_S</span> <span class="op">+</span> <span class="va">G_S</span> <span class="op">+</span> <span class="va">X_S</span> <span class="op">-</span> <span class="va">IM_S</span>,
  <span class="va">IM_N</span> <span class="op">~</span> <span class="va">mu_N</span> <span class="op">*</span> <span class="va">Y_N</span>,
  <span class="va">IM_S</span> <span class="op">~</span> <span class="va">mu_S</span> <span class="op">*</span> <span class="va">Y_S</span>,
  <span class="va">X_N</span> <span class="op">~</span> <span class="va">IM_S</span>,
  <span class="va">X_S</span> <span class="op">~</span> <span class="va">IM_N</span>,
  <span class="va">YD_N</span> <span class="op">~</span> <span class="va">Y_N</span> <span class="op">-</span> <span class="va">TX_N</span> <span class="op">+</span> <span class="va">r</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bh_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">YD_S</span> <span class="op">~</span> <span class="va">Y_S</span> <span class="op">-</span> <span class="va">TX_S</span> <span class="op">+</span> <span class="va">r</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bh_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">TX_N</span> <span class="op">~</span> <span class="va">theta</span> <span class="op">*</span> <span class="op">(</span> <span class="va">Y_N</span> <span class="op">+</span> <span class="va">r</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bh_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span>,
  <span class="va">TX_S</span> <span class="op">~</span> <span class="va">theta</span> <span class="op">*</span> <span class="op">(</span> <span class="va">Y_S</span> <span class="op">+</span> <span class="va">r</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bh_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span>,
  <span class="va">V_N</span> <span class="op">~</span> <span class="va">V_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span> <span class="va">YD_N</span> <span class="op">-</span> <span class="va">C_N</span> <span class="op">)</span>,
  <span class="va">V_S</span> <span class="op">~</span> <span class="va">V_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span> <span class="va">YD_S</span> <span class="op">-</span> <span class="va">C_S</span> <span class="op">)</span>,
  <span class="va">C_N</span> <span class="op">~</span> <span class="va">alpha1_N</span> <span class="op">*</span> <span class="va">YD_N</span> <span class="op">+</span> <span class="va">alpha2_N</span> <span class="op">*</span> <span class="va">V_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">C_S</span> <span class="op">~</span> <span class="va">alpha1_S</span> <span class="op">*</span> <span class="va">YD_S</span> <span class="op">+</span> <span class="va">alpha2_S</span> <span class="op">*</span> <span class="va">V_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">Hh_N</span> <span class="op">~</span> <span class="va">V_N</span> <span class="op">-</span> <span class="va">Bh_N</span>,
  <span class="va">Hh_S</span> <span class="op">~</span> <span class="va">V_S</span> <span class="op">-</span> <span class="va">Bh_S</span>,
  <span class="va">Bh_N</span> <span class="op">~</span> <span class="va">V_N</span> <span class="op">*</span> <span class="op">(</span> <span class="va">lambda0_N</span> <span class="op">+</span> <span class="va">lambda1_N</span> <span class="op">*</span> <span class="va">r</span> <span class="op">-</span> <span class="va">lambda2_N</span> <span class="op">*</span> <span class="op">(</span> <span class="va">YD_N</span><span class="op">/</span><span class="va">V_N</span> <span class="op">)</span> <span class="op">)</span>,
  <span class="va">Bh_S</span> <span class="op">~</span> <span class="va">V_S</span> <span class="op">*</span> <span class="op">(</span> <span class="va">lambda0_S</span> <span class="op">+</span> <span class="va">lambda1_S</span> <span class="op">*</span> <span class="va">r</span> <span class="op">-</span> <span class="va">lambda2_S</span> <span class="op">*</span> <span class="op">(</span> <span class="va">YD_S</span><span class="op">/</span><span class="va">V_S</span> <span class="op">)</span> <span class="op">)</span>,
  <span class="va">TX</span> <span class="op">~</span> <span class="va">TX_N</span> <span class="op">+</span> <span class="va">TX_S</span>,
  <span class="va">G</span> <span class="op">~</span> <span class="va">G_N</span> <span class="op">+</span> <span class="va">G_S</span>,
  <span class="va">Bh</span> <span class="op">~</span> <span class="va">Bh_N</span> <span class="op">+</span> <span class="va">Bh_S</span>,
  <span class="va">Hh</span> <span class="op">~</span> <span class="va">Hh_N</span> <span class="op">+</span> <span class="va">Hh_S</span>,
  <span class="va">Bs</span> <span class="op">~</span> <span class="va">Bs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span> <span class="va">G</span> <span class="op">+</span> <span class="va">r</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span> <span class="op">-</span> <span class="op">(</span> <span class="va">TX</span> <span class="op">+</span> <span class="va">r</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bcb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span>,
  <span class="va">Hs</span> <span class="op">~</span> <span class="va">Hs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">Bcb</span> <span class="op">-</span> <span class="va">Bcb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">Bcb</span> <span class="op">~</span> <span class="va">Bs</span> <span class="op">-</span> <span class="va">Bh</span>
<span class="op">)</span>

<span class="va">reg_ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">r</span> <span class="op">~</span> <span class="fl">0.025</span>,
  <span class="va">G_S</span> <span class="op">~</span> <span class="fl">20</span>,
  <span class="va">G_N</span> <span class="op">~</span> <span class="fl">20</span>,
  <span class="va">mu_N</span> <span class="op">~</span> <span class="fl">0.15</span>,
  <span class="va">mu_S</span> <span class="op">~</span> <span class="fl">0.15</span>,
  <span class="va">alpha1_N</span> <span class="op">~</span> <span class="fl">0.7</span>,
  <span class="va">alpha1_S</span> <span class="op">~</span> <span class="fl">0.7</span>,
  <span class="va">alpha2_N</span> <span class="op">~</span> <span class="fl">0.3</span>,
  <span class="va">alpha2_S</span> <span class="op">~</span> <span class="fl">0.3</span>,
  <span class="va">lambda0_N</span> <span class="op">~</span> <span class="fl">0.67</span>,
  <span class="va">lambda0_S</span> <span class="op">~</span> <span class="fl">0.67</span>,
  <span class="va">lambda1_N</span> <span class="op">~</span> <span class="fl">0.05</span>,
  <span class="va">lambda1_S</span> <span class="op">~</span> <span class="fl">0.05</span>,
  <span class="va">lambda2_N</span> <span class="op">~</span> <span class="fl">0.01</span>,
  <span class="va">lambda2_S</span> <span class="op">~</span> <span class="fl">0.01</span>,
  <span class="va">theta</span> <span class="op">~</span> <span class="fl">0.2</span>
<span class="op">)</span></code></pre></div>
<p>We can now simulate the model, adding also the hidden equation to spot any errors in the equations<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span><span class="va">reg_eqs</span>, <span class="va">reg_ext</span>, <span class="fl">100</span>, hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hh"</span> <span class="op">=</span> <span class="st">"Hs"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We start by investigating some aspects of the stationary (steady) state of the REG model.</p>
<p>First, we calculate the trade balance and government deficit for each region:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg</span> <span class="op">&lt;-</span> <span class="va">reg</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>TB_N <span class="op">=</span> <span class="va">X_N</span> <span class="op">-</span> <span class="va">IM_N</span>,
         TB_S <span class="op">=</span> <span class="va">X_S</span> <span class="op">-</span> <span class="va">IM_S</span>,
         GB_N <span class="op">=</span> <span class="va">TX_N</span> <span class="op">-</span> <span class="op">(</span><span class="va">G_N</span> <span class="op">+</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">Bh_N</span><span class="op">)</span><span class="op">)</span>,
         GB_S <span class="op">=</span> <span class="va">TX_S</span> <span class="op">-</span> <span class="op">(</span><span class="va">G_S</span> <span class="op">+</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">Bh_S</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>As always, we reshape the model object to plot. I will also create an extra column <code>region</code> to indicate whether the variable relates to the <code>N</code> or <code>S</code> region. Global variables like <code>G</code> and <code>Hh</code> are classified as <code>NA</code> region.</p>
<p>To do so I used the <code><a href="https://rdrr.io/pkg/dplyr/man/case_when.html">case_when()</a></code> function from <code>dplyr</code>, and I searched for the "_N" or "_S" components in each variable name with the <code>str_detect()</code> function from <code>stringr</code>. Both packages are part of the <code>tidyverse</code> packages.</p>
<p>These operations are “piped” together in a single call.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg_long</span> <span class="op">&lt;-</span> <span class="va">reg</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">period</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/case_when.html">case_when</a></span><span class="op">(</span>
    <span class="fu">str_detect</span><span class="op">(</span><span class="va">name</span>, <span class="st">'_N'</span><span class="op">)</span> <span class="op">~</span> <span class="st">"North"</span>,
    <span class="fu">str_detect</span><span class="op">(</span><span class="va">name</span>, <span class="st">"_S"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"South"</span>,
    <span class="co"># `T` means everything else inside</span>
    <span class="co"># the case_when function</span>
    <span class="cn">T</span> <span class="op">~</span> <span class="cn">NA_character_</span>
  <span class="op">)</span><span class="op">)</span></code></pre></div>
<p>I will also make an auxiliary function that create the balances, reshape the model, and add the region group to avoid repeating this code for every new model:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">to_long</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">model</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>TB_N <span class="op">=</span> <span class="va">X_N</span> <span class="op">-</span> <span class="va">IM_N</span>,
         TB_S <span class="op">=</span> <span class="va">X_S</span> <span class="op">-</span> <span class="va">IM_S</span>,
         GB_N <span class="op">=</span> <span class="va">TX_N</span> <span class="op">-</span> <span class="op">(</span><span class="va">G_N</span> <span class="op">+</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">Bh_N</span><span class="op">)</span><span class="op">)</span>,
         GB_S <span class="op">=</span> <span class="va">TX_S</span> <span class="op">-</span> <span class="op">(</span><span class="va">G_S</span> <span class="op">+</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">Bh_S</span><span class="op">)</span><span class="op">)</span>,
         deltaV_N <span class="op">=</span> <span class="va">V_N</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">V_N</span><span class="op">)</span>,
         deltaV_S <span class="op">=</span> <span class="va">V_S</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">V_S</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">period</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/case_when.html">case_when</a></span><span class="op">(</span>
    <span class="fu">str_detect</span><span class="op">(</span><span class="va">name</span>, <span class="st">'_N'</span><span class="op">)</span> <span class="op">~</span> <span class="st">"North"</span>,
    <span class="fu">str_detect</span><span class="op">(</span><span class="va">name</span>, <span class="st">"_S"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"South"</span>,
    <span class="co"># `T` means everything else inside</span>
    <span class="co"># the case_when function</span>
    <span class="cn">T</span> <span class="op">~</span> <span class="cn">NA_character_</span>
  <span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GB_N"</span>, <span class="st">"GB_S"</span>, <span class="st">"TB_N"</span>, <span class="st">"TB_S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">region</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>With this Figure we note that the model is correctly specified since the sector balances converge to equality as was expected from equations 6.30 to 6.32 from <span class="citation">Godley and Lavoie (2007, 177)</span>. Below I reproduce equation 6.32, an important result that will be used often in this notebook<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>:</p>
<p><span class="math display">\[
G_T^N - T^N = IM^N - X^N
\]</span></p>
<p>Also, in this example, both regions are exactly balanced, with their sectoral balances equal to zero. This is, as <span class="citation">Godley and Lavoie (2007, 179)</span>, a super stationary state that is achieved because all the parameters are the same for the both regions. There is nothing in the system that will lead to this result. The reader is invited to change the parameters by her/himself to check this claim.</p>
</div>
<div id="matrices-of-model-reg" class="section level2">
<h2 class="hasAnchor">
<a href="#matrices-of-model-reg" class="anchor"></a>Matrices of model REG</h2>
<div id="balance-sheet-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#balance-sheet-matrix" class="anchor"></a>Balance-sheet matrix</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bs_reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_matrix.html">sfcr_matrix</a></span><span class="op">(</span>
  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"North_HH"</span>, <span class="st">"South_HH"</span>, <span class="st">"Government"</span>, <span class="st">"Central Bank"</span><span class="op">)</span>,
  codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"nh"</span>, <span class="st">"sh"</span>, <span class="st">"g"</span>, <span class="st">"cb"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Money"</span>, nh <span class="op">=</span> <span class="st">"+Hh_N"</span>, sh <span class="op">=</span> <span class="st">"+Hh_S"</span>, cb <span class="op">=</span> <span class="st">"-Hs"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bills"</span>, nh <span class="op">=</span> <span class="st">"+Bh_N"</span>, sh <span class="op">=</span> <span class="st">"+Bh_S"</span>, g <span class="op">=</span> <span class="st">"-Bs"</span>, cb <span class="op">=</span> <span class="st">"+Bcb"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Wealth"</span>, nh <span class="op">=</span> <span class="st">"-V_N"</span>, sh <span class="op">=</span> <span class="st">"-V_S"</span>, g <span class="op">=</span> <span class="st">"V_N + V_S"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Validate:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_validate.html">sfcr_validate</a></span><span class="op">(</span><span class="va">bs_reg</span>, <span class="va">reg</span>, <span class="st">"bs"</span><span class="op">)</span>
<span class="co">#&gt; Water tight! The balance-sheet matrix is consistent with the simulated model.</span></code></pre></div>
</div>
<div id="transactions-flow-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#transactions-flow-matrix" class="anchor"></a>Transactions-flow matrix</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tfm_reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_matrix.html">sfcr_matrix</a></span><span class="op">(</span>
  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"North_HH"</span>, <span class="st">"North_Firms"</span>, <span class="st">"South_HH"</span>, <span class="st">"South_Firms"</span>, <span class="st">"Government"</span>, <span class="st">"Central Bank"</span><span class="op">)</span>,
  codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"nh"</span>, <span class="st">"nf"</span>, <span class="st">"sh"</span>, <span class="st">"sf"</span>, <span class="st">"g"</span>, <span class="st">"cb"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Consumption"</span>, nh <span class="op">=</span> <span class="st">"-C_N"</span>, nf <span class="op">=</span> <span class="st">"+C_N"</span>, sh <span class="op">=</span> <span class="st">"-C_S"</span>, sf <span class="op">=</span> <span class="st">"+C_S"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Govt. Exp"</span>, nf <span class="op">=</span> <span class="st">"+G_N"</span>, sf <span class="op">=</span> <span class="st">"+G_S"</span>, g <span class="op">=</span> <span class="st">"-G"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"North X to South"</span>, nf <span class="op">=</span> <span class="st">"+X_N"</span>, sf <span class="op">=</span> <span class="st">"-IM_S"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"South X to North"</span>, nf <span class="op">=</span> <span class="st">"-IM_N"</span>, sf <span class="op">=</span> <span class="st">"+X_S"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GDP"</span>, nh <span class="op">=</span> <span class="st">"+Y_N"</span>, nf <span class="op">=</span> <span class="st">"-Y_N"</span>, sh <span class="op">=</span> <span class="st">"+Y_S"</span>, sf <span class="op">=</span> <span class="st">"-Y_S"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Interest payments"</span>, nh <span class="op">=</span> <span class="st">"+r[-1] * Bh_N[-1]"</span>, sh <span class="op">=</span> <span class="st">"+r[-1] * Bh_S[-1]"</span>, g <span class="op">=</span> <span class="st">"-r[-1] * Bs[-1]"</span>, cb <span class="op">=</span> <span class="st">"+r[-1] * Bcb[-1]"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CB Profits"</span>, g <span class="op">=</span> <span class="st">"+r[-1] * Bcb[-1]"</span>, cb <span class="op">=</span> <span class="st">"-r[-1] * Bcb[-1]"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxes"</span>, nh <span class="op">=</span> <span class="st">"-TX_N"</span>, sh <span class="op">=</span> <span class="st">"-TX_S"</span>, g <span class="op">=</span> <span class="st">"+TX"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. cash"</span>, nh <span class="op">=</span> <span class="st">"-d(Hh_N)"</span>, sh <span class="op">=</span> <span class="st">"-d(Hh_S)"</span>, cb <span class="op">=</span> <span class="st">"+d(Hs)"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. bills"</span>, nh <span class="op">=</span> <span class="st">"-d(Bh_N)"</span>, sh <span class="op">=</span> <span class="st">"-d(Bh_S)"</span>, g <span class="op">=</span> <span class="st">"+d(Bs)"</span>, cb <span class="op">=</span> <span class="st">"-d(Bcb)"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Validate:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_validate.html">sfcr_validate</a></span><span class="op">(</span><span class="va">tfm_reg</span>, <span class="va">reg</span>, <span class="st">"tfm"</span><span class="op">)</span>
<span class="co">#&gt; Water tight! The transactions-flow matrix is consistent with the simulated model.</span></code></pre></div>
</div>
<div id="sankeys-diagram" class="section level3">
<h3 class="hasAnchor">
<a href="#sankeys-diagram" class="anchor"></a>Sankey’s diagram</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_sankey.html">sfcr_sankey</a></span><span class="op">(</span><span class="va">tfm_reg</span>, <span class="va">reg</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-75f67d78d175fc151bb2" style="width:700px;height:432.632880098888px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-75f67d78d175fc151bb2">{"x":{"links":{"source":[10,12,14,13,11,11,13,14,15,10,12,10,12,10,12,15,0,0,1,1,2,3,4,4,5,5,5,6,7,8,9],"target":[0,0,1,2,3,4,4,5,6,7,7,8,8,9,9,9,17,19,17,19,17,19,16,18,16,18,21,20,20,21,20],"value":[45.641786,45.641786,40,9.846268,9.846268,65.641786,65.641786,1.436521,0.496311,13.222378,13.222378,2.430499,2.430499,4.817228,4.817228,4.860998,45.641786,45.641786,20,20,9.846268,9.846268,65.641786,65.641786,0.470105,0.470105,0.496311,0.496311,26.444757,4.860998,14.495454]},"nodes":{"name":["Consumption","Govt. Exp","North X to South","South X to North","GDP","Interest payments","CB Profits","Taxes","Ch. cash","Ch. bills","North_HH","North_Firms","South_HH","South_Firms","Government","Central Bank","North_HH","North_Firms","South_HH","South_Firms","Government","Central Bank"],"group":["Consumption","Govt. Exp","North X to South","South X to North","GDP","Interest payments","CB Profits","Taxes","Ch. cash","Ch. bills","North_HH","North_Firms","South_HH","South_Firms","Government","Central Bank","North_HH","North_Firms","South_HH","South_Firms","Government","Central Bank"]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":14,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"dollars","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="scenario-1-an-increase-in-the-propensity-to-import-of-the-south" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-1-an-increase-in-the-propensity-to-import-of-the-south" class="anchor"></a>Scenario 1: An increase in the propensity to import of the South</h2>
<p>To see what would happen if there was an increase in the propensity to import in the southern region, we calculate a scenario by adding a shock to <code>reg</code> model:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">mu_S</span> <span class="op">~</span> <span class="fl">0.25</span><span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">60</span>
<span class="op">)</span>

<span class="va">reg_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span>
  <span class="va">reg</span>,
  scenario <span class="op">=</span> <span class="va">shock1</span>,
  periods <span class="op">=</span> <span class="fl">60</span>
<span class="op">)</span></code></pre></div>
<p>I use the <code>to_long()</code> function created earlier to reshape this model:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg_1long</span> <span class="op">&lt;-</span> <span class="fu">to_long</span><span class="op">(</span><span class="va">reg_1</span><span class="op">)</span></code></pre></div>
<p>And reproduce Figure 6.1 that describes what happens with the variation of the wealth of Southern households, the government balance with this region, and the trade balance of this region:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg_1long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"deltaV_S"</span>, <span class="st">"GB_S"</span>, <span class="st">"TB_S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>What would happen with the GDP in both regions?</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg_1long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Y_N"</span>, <span class="st">"Y_S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
<div id="scenario-2-an-increase-in-the-government-expenditures-of-the-south" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-2-an-increase-in-the-government-expenditures-of-the-south" class="anchor"></a>Scenario 2: An increase in the government expenditures of the South</h2>
<p>Before we saw that an exogenous increase of the Southern imports <strong>caused</strong> a higher government deficit in that region. What would happen if we exogenously increase the government deficit instead?</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">G_S</span> <span class="op">~</span> <span class="fl">25</span><span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">60</span>
<span class="op">)</span>

<span class="va">reg_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">reg</span>, <span class="va">shock2</span>, <span class="fl">60</span><span class="op">)</span>
<span class="va">reg_2long</span> <span class="op">&lt;-</span> <span class="fu">to_long</span><span class="op">(</span><span class="va">reg_2</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg_2long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Y_N"</span>, <span class="st">"Y_S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Impact on regrional GDPs"</span><span class="op">)</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg_2long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"deltaV_S"</span>, <span class="st">"TB_S"</span>, <span class="st">"GB_S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
<div id="scenario-3-an-increase-in-the-propensity-to-save-of-the-southern-households" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-3-an-increase-in-the-propensity-to-save-of-the-southern-households" class="anchor"></a>Scenario 3: An increase in the propensity to save of the Southern households</h2>
<p>One of the puzzling results of model PC was that an increase in the propensity to save led to higher long-run output. This results is in contrast with the post-Keynesian “paradox of thrift”. what would happen in model REG if the households of one of its regions increased its propensity to save?</p>
<p>To check it, we add a shock to model REG, creating a new scenario:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">alpha1_S</span> <span class="op">~</span> <span class="fl">0.6</span><span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">60</span>
<span class="op">)</span>

<span class="va">reg_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">reg</span>, <span class="va">shock3</span>, periods <span class="op">=</span> <span class="fl">60</span><span class="op">)</span>
<span class="va">reg_3long</span> <span class="op">&lt;-</span> <span class="fu">to_long</span><span class="op">(</span><span class="va">reg_3</span><span class="op">)</span></code></pre></div>
<p>Let’s see what happened with the GDP of both regions:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg_3long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Y_S"</span>, <span class="st">"Y_N"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>Again we see that higher thriftiness lead to higher steady state output levels, although the short-run effect is markedly negative.</p>
<p>The evolution of the sectoral balances and wealth of the South region is visualized next:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg_3long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"deltaV_S"</span>, <span class="st">"TB_S"</span>, <span class="st">"GB_S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>The interesting feature of this exercise is that it shows that it is possible to have government deficits (or surpluses) at the same time as trade surpluses (deficits), but only in the transitional period to the new steady state.</p>
</div>
<div id="scenario-4-a-change-in-the-liquidity-preference-of-southern-households" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-4-a-change-in-the-liquidity-preference-of-southern-households" class="anchor"></a>Scenario 4: A change in the liquidity preference of Southern households</h2>
<p>The last exercise with this model is to check the effect of an increase in the liquidity preference of Northern households.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">lambda0_S</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">60</span>
<span class="op">)</span>

<span class="va">reg_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">reg</span>, <span class="va">shock4</span>, <span class="fl">60</span><span class="op">)</span>
<span class="va">reg_4long</span> <span class="op">&lt;-</span> <span class="fu">to_long</span><span class="op">(</span><span class="va">reg_4</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg_4long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Y_S"</span>, <span class="st">"Y_N"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Effects on GDP"</span><span class="op">)</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg_4long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"deltaV_S"</span>, <span class="st">"TB_S"</span>, <span class="st">"GB_S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Effects on sectoral balances"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<p>As we can see, a decrease in liquidity preference leads to higher stationary output in both regions. The higher wealth in the form of bonds lead to more interest payments, which initially increases the government deficit but this effect dies out when consumption out of wealth picks up. The Southern region ends up with a twin deficit.</p>
<p>It is also noteworthy that the size of this effect is rather small.</p>
</div>
</div>
<div id="model-open" class="section level1">
<h1 class="hasAnchor">
<a href="#model-open" class="anchor"></a>Model OPEN</h1>
<p>We are finally ready to create a model with two countries, two governments, two currencies!</p>
<p>Without further adue, let’s write the equations, parameters, and exogenous values.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open_eqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">Y_N</span> <span class="op">~</span> <span class="va">C_N</span> <span class="op">+</span> <span class="va">G_N</span> <span class="op">+</span> <span class="va">X_N</span> <span class="op">-</span> <span class="va">IM_N</span>,
  <span class="va">Y_S</span> <span class="op">~</span> <span class="va">C_S</span> <span class="op">+</span> <span class="va">G_S</span> <span class="op">+</span> <span class="va">X_S</span> <span class="op">-</span> <span class="va">IM_S</span>,
  <span class="va">IM_N</span> <span class="op">~</span> <span class="va">mu_N</span> <span class="op">*</span> <span class="va">Y_N</span>,
  <span class="va">IM_S</span> <span class="op">~</span> <span class="va">mu_S</span> <span class="op">*</span> <span class="va">Y_S</span>,
  <span class="va">X_N</span> <span class="op">~</span> <span class="va">IM_S</span> <span class="op">/</span> <span class="va">xr</span>,
  <span class="va">X_S</span> <span class="op">~</span> <span class="va">IM_N</span> <span class="op">*</span> <span class="va">xr</span>,
  <span class="va">YD_N</span> <span class="op">~</span> <span class="va">Y_N</span> <span class="op">-</span> <span class="va">TX_N</span> <span class="op">+</span> <span class="va">r_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bh_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">YD_S</span> <span class="op">~</span> <span class="va">Y_S</span> <span class="op">-</span> <span class="va">TX_S</span> <span class="op">+</span> <span class="va">r_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bh_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">TX_N</span> <span class="op">~</span> <span class="va">theta_N</span> <span class="op">*</span> <span class="op">(</span> <span class="va">Y_N</span> <span class="op">+</span> <span class="va">r_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bh_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span>,
  <span class="va">TX_S</span> <span class="op">~</span> <span class="va">theta_S</span> <span class="op">*</span> <span class="op">(</span> <span class="va">Y_S</span> <span class="op">+</span> <span class="va">r_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bh_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span>,
  <span class="va">V_N</span> <span class="op">~</span> <span class="va">V_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span> <span class="va">YD_N</span> <span class="op">-</span> <span class="va">C_N</span> <span class="op">)</span>,
  <span class="va">V_S</span> <span class="op">~</span> <span class="va">V_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span> <span class="va">YD_S</span> <span class="op">-</span> <span class="va">C_S</span> <span class="op">)</span>,
  <span class="va">C_N</span> <span class="op">~</span> <span class="va">alpha1_N</span> <span class="op">*</span> <span class="va">YD_N</span> <span class="op">+</span> <span class="va">alpha2_N</span> <span class="op">*</span> <span class="va">V_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">C_S</span> <span class="op">~</span> <span class="va">alpha1_S</span> <span class="op">*</span> <span class="va">YD_S</span> <span class="op">+</span> <span class="va">alpha2_S</span> <span class="op">*</span> <span class="va">V_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">Hh_N</span> <span class="op">~</span> <span class="va">V_N</span> <span class="op">-</span> <span class="va">Bh_N</span>,
  <span class="va">Hh_S</span> <span class="op">~</span> <span class="va">V_S</span> <span class="op">-</span> <span class="va">Bh_S</span>,
  <span class="va">Bh_N</span> <span class="op">~</span> <span class="va">V_N</span> <span class="op">*</span> <span class="op">(</span> <span class="va">lambda0_N</span> <span class="op">+</span> <span class="va">lambda1_N</span> <span class="op">*</span> <span class="va">r_N</span> <span class="op">-</span> <span class="va">lambda2_N</span> <span class="op">*</span> <span class="op">(</span> <span class="va">YD_N</span><span class="op">/</span><span class="va">V_N</span> <span class="op">)</span> <span class="op">)</span>,
  <span class="va">Bh_S</span> <span class="op">~</span> <span class="va">V_S</span> <span class="op">*</span> <span class="op">(</span> <span class="va">lambda0_S</span> <span class="op">+</span> <span class="va">lambda1_S</span> <span class="op">*</span> <span class="va">r_S</span> <span class="op">-</span> <span class="va">lambda2_S</span> <span class="op">*</span> <span class="op">(</span> <span class="va">YD_S</span><span class="op">/</span><span class="va">V_S</span> <span class="op">)</span> <span class="op">)</span>,
  <span class="va">Bs_N</span> <span class="op">~</span> <span class="va">Bs_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span> <span class="va">G_N</span> <span class="op">+</span> <span class="va">r_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bs_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span> <span class="op">-</span> <span class="op">(</span> <span class="va">TX_N</span> <span class="op">+</span> <span class="va">r_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bcb_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span>,
  <span class="va">Bs_S</span> <span class="op">~</span> <span class="va">Bs_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span> <span class="va">G_S</span> <span class="op">+</span> <span class="va">r_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bs_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span> <span class="op">-</span> <span class="op">(</span> <span class="va">TX_S</span> <span class="op">+</span> <span class="va">r_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bcb_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span>,
  <span class="va">Bcb_N</span> <span class="op">~</span> <span class="va">Bs_N</span> <span class="op">-</span> <span class="va">Bh_N</span>,
  <span class="va">Bcb_S</span> <span class="op">~</span> <span class="va">Bs_S</span> <span class="op">-</span> <span class="va">Bh_S</span>,
  <span class="va">or_N</span> <span class="op">~</span> <span class="va">or_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="op">(</span> <span class="va">Hs_N</span> <span class="op">-</span> <span class="va">Hs_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="op">(</span> <span class="va">Bcb_N</span> <span class="op">-</span> <span class="va">Bcb_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span> <span class="op">)</span><span class="op">/</span><span class="va">pg_N</span><span class="op">)</span>,
  <span class="va">or_S</span> <span class="op">~</span> <span class="va">or_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="op">(</span> <span class="va">Hs_S</span> <span class="op">-</span> <span class="va">Hs_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="op">(</span> <span class="va">Bcb_S</span> <span class="op">-</span> <span class="va">Bcb_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span> <span class="op">)</span><span class="op">/</span><span class="va">pg_S</span><span class="op">)</span>,
  <span class="va">Hs_N</span> <span class="op">~</span> <span class="va">Hh_N</span>,
  <span class="va">Hs_S</span> <span class="op">~</span> <span class="va">Hh_S</span>,
  <span class="va">pg_S</span> <span class="op">~</span> <span class="va">pg_N</span> <span class="op">*</span> <span class="va">xr</span>,
  <span class="va">deltaor_S</span> <span class="op">~</span> <span class="va">or_S</span> <span class="op">-</span> <span class="va">or_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">deltaor_N</span> <span class="op">~</span> <span class="op">-</span> <span class="op">(</span><span class="va">or_N</span> <span class="op">-</span> <span class="va">or_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="op">)</span>


<span class="va">open_ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">xr</span> <span class="op">~</span> <span class="fl">1</span>,
  <span class="va">pg_N</span> <span class="op">~</span> <span class="fl">1</span>,
  <span class="va">r_N</span> <span class="op">~</span> <span class="fl">0.025</span>,
  <span class="va">r_S</span> <span class="op">~</span> <span class="fl">0.025</span>,
  <span class="va">G_S</span> <span class="op">~</span> <span class="fl">20</span>,
  <span class="va">G_N</span> <span class="op">~</span> <span class="fl">20</span>,
  <span class="va">mu_N</span> <span class="op">~</span> <span class="fl">0.15</span>,
  <span class="va">mu_S</span> <span class="op">~</span> <span class="fl">0.15</span>,
  <span class="va">alpha1_N</span> <span class="op">~</span> <span class="fl">0.7</span>,
  <span class="va">alpha1_S</span> <span class="op">~</span> <span class="fl">0.8</span>,
  <span class="va">alpha2_N</span> <span class="op">~</span> <span class="fl">0.3</span>,
  <span class="va">alpha2_S</span> <span class="op">~</span> <span class="fl">0.2</span>,
  <span class="va">lambda0_N</span> <span class="op">~</span> <span class="fl">0.67</span>,
  <span class="va">lambda0_S</span> <span class="op">~</span> <span class="fl">0.67</span>,
  <span class="va">lambda1_N</span> <span class="op">~</span> <span class="fl">0.05</span>,
  <span class="va">lambda1_S</span> <span class="op">~</span> <span class="fl">0.05</span>,
  <span class="va">lambda2_N</span> <span class="op">~</span> <span class="fl">0.01</span>,
  <span class="va">lambda2_S</span> <span class="op">~</span> <span class="fl">0.01</span>,
  <span class="va">theta_N</span> <span class="op">~</span> <span class="fl">0.2</span>,
  <span class="va">theta_S</span> <span class="op">~</span> <span class="fl">0.2</span>
<span class="op">)</span></code></pre></div>
<p>The hidden equation in this model is:</p>
<p><span class="math display">\[
\Delta or^S = \Delta or^N
\]</span></p>
<p>Hence, we created two auxiliary variables: <code>deltaor_S</code> and <code>deltaor_N</code>. These are the variation of gold reserves in each country at each period, with the <code>deltaor_N</code> variable multiplied by -1. The reason is that the hidden equation argument only recognize the names of the variables and test for their equality.</p>
<p>Note also that at least something must be different from one country to the other. Otherwise, the model will simulate two twin economies. In this case, we made the propensities to consume out of disposable income and wealth different.</p>
<p>We can simulate the model:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span><span class="va">open_eqs</span>, <span class="va">open_ext</span>, periods <span class="op">=</span> <span class="fl">100</span>, hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"deltaor_S"</span> <span class="op">=</span> <span class="st">"deltaor_N"</span><span class="op">)</span>, .hidden_tol <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></code></pre></div>
<p>Let’s also adapt our <code>to_long()</code> function to incorporate the new questions we want to investigate with the OPEN model:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">to_long</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">model</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>TB_N <span class="op">=</span> <span class="va">X_N</span> <span class="op">-</span> <span class="va">IM_N</span>,
         TB_S <span class="op">=</span> <span class="va">X_S</span> <span class="op">-</span> <span class="va">IM_S</span>,
         GB_N <span class="op">=</span> <span class="va">TX_N</span> <span class="op">-</span> <span class="op">(</span><span class="va">G_N</span> <span class="op">+</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">r_N</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">Bh_N</span><span class="op">)</span><span class="op">)</span>,
         GB_S <span class="op">=</span> <span class="va">TX_S</span> <span class="op">-</span> <span class="op">(</span><span class="va">G_S</span> <span class="op">+</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">r_S</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">Bh_S</span><span class="op">)</span><span class="op">)</span>,
         deltaV_N <span class="op">=</span> <span class="va">V_N</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">V_N</span><span class="op">)</span>,
         deltaV_S <span class="op">=</span> <span class="va">V_S</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">V_S</span><span class="op">)</span>,
         deltaBcb_N <span class="op">=</span> <span class="va">Bcb_N</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">Bcb_N</span><span class="op">)</span>,
         deltaBcb_S <span class="op">=</span> <span class="va">Bcb_S</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">Bcb_S</span><span class="op">)</span>,
         deltaHs_N <span class="op">=</span> <span class="va">Hs_N</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">Hs_N</span><span class="op">)</span>,
         deltaHs_S <span class="op">=</span> <span class="va">Hs_S</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">Hs_S</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">period</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>country <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/case_when.html">case_when</a></span><span class="op">(</span>
    <span class="fu">str_detect</span><span class="op">(</span><span class="va">name</span>, <span class="st">'_N'</span><span class="op">)</span> <span class="op">~</span> <span class="st">"North"</span>,
    <span class="fu">str_detect</span><span class="op">(</span><span class="va">name</span>, <span class="st">"_S"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"South"</span>,
    <span class="co"># `T` means everything else inside</span>
    <span class="co"># the case_when function</span>
    <span class="cn">T</span> <span class="op">~</span> <span class="cn">NA_character_</span>
  <span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>And let’s plot the main variables to check if the model arrived into the super stationary steady state:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open_long</span> <span class="op">&lt;-</span> <span class="fu">to_long</span><span class="op">(</span><span class="va">open</span><span class="op">)</span>

<span class="va">open_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"TB_S"</span>, <span class="st">"TB_N"</span>, <span class="st">"GB_N"</span>, <span class="st">"GB_S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">country</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
<div id="matrices-of-model-open" class="section level2">
<h2 class="hasAnchor">
<a href="#matrices-of-model-open" class="anchor"></a>Matrices of model OPEN</h2>
<div id="balance-sheet-matrix-1" class="section level3">
<h3 class="hasAnchor">
<a href="#balance-sheet-matrix-1" class="anchor"></a>Balance-sheet matrix</h3>
<p>The “Sum” column of the balance-sheet matrix does not sum to zero in all of its entries. Therefore, we must add a “Sum” column by hand with the <code><a href="../../reference/sfcr_matrix.html">sfcr_matrix()</a></code> function in order to have it validated with <code><a href="../../reference/sfcr_validate.html">sfcr_validate()</a></code>.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bs_open</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_matrix.html">sfcr_matrix</a></span><span class="op">(</span>
  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"North_HH"</span>, <span class="st">"North_Govt"</span>, <span class="st">"North_CB"</span>, <span class="st">"South_HH"</span>, <span class="st">"South_Govt"</span>, <span class="st">"South_CB"</span>, <span class="st">"Sum"</span><span class="op">)</span>,
  codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"nh"</span>, <span class="st">"ng"</span>, <span class="st">"ncb"</span>, <span class="st">"sh"</span>, <span class="st">"sg"</span>, <span class="st">"scb"</span>, <span class="st">"s"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Money"</span>, nh <span class="op">=</span> <span class="st">"+Hh_N"</span>, ncb <span class="op">=</span> <span class="st">"-Hs_N"</span>, sh <span class="op">=</span> <span class="st">"+Hh_S"</span>, scb <span class="op">=</span> <span class="st">"-Hs_S"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bills"</span>, nh <span class="op">=</span> <span class="st">"+Bh_N"</span>, ng <span class="op">=</span> <span class="st">"-Bs_N"</span>, ncb <span class="op">=</span> <span class="st">"+Bcb_N"</span>, sh <span class="op">=</span> <span class="st">"+Bh_S"</span>, sg <span class="op">=</span> <span class="st">"-Bs_S"</span>, scb <span class="op">=</span> <span class="st">"+Bcb_S"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gold"</span>, ncb <span class="op">=</span> <span class="st">"+or_N * pg_N * xr"</span>, scb <span class="op">=</span> <span class="st">"or_S * pg_S"</span>, s <span class="op">=</span> <span class="st">"or_N * pg_N * xr + (or_S * pg_S)"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Wealth"</span>, nh <span class="op">=</span> <span class="st">"-V_N"</span>, ng <span class="op">=</span> <span class="st">"Bs_N"</span>, sh <span class="op">=</span> <span class="st">"-V_S"</span>, sg <span class="op">=</span> <span class="st">"Bs_S"</span>, s <span class="op">=</span> <span class="st">"-(or_N * pg_N * xr + (or_S * pg_S))"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Validate:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_validate.html">sfcr_validate</a></span><span class="op">(</span><span class="va">bs_open</span>, <span class="va">open</span>, <span class="st">"bs"</span><span class="op">)</span>
<span class="co">#&gt; Water tight! The balance-sheet matrix is consistent with the simulated model.</span></code></pre></div>
</div>
<div id="transactions-flow-matrix-1" class="section level3">
<h3 class="hasAnchor">
<a href="#transactions-flow-matrix-1" class="anchor"></a>Transactions-flow matrix</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tfm_open</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_matrix.html">sfcr_matrix</a></span><span class="op">(</span>
  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"N_Households"</span>, <span class="st">"N_Firms"</span>, <span class="st">"N_Govt"</span>, <span class="st">"N_CentralBank"</span>, <span class="st">"S_Households"</span>, <span class="st">"S_Firms"</span>, <span class="st">"S_Govt"</span>, <span class="st">"S_CentralBank"</span><span class="op">)</span>,
  codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"nh"</span>, <span class="st">"nf"</span>, <span class="st">"ng"</span>, <span class="st">"ncb"</span>, <span class="st">"sh"</span>, <span class="st">"sf"</span>, <span class="st">"sg"</span>, <span class="st">"scb"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Consumption"</span>, nh <span class="op">=</span> <span class="st">"-C_N"</span>, nf <span class="op">=</span> <span class="st">"+C_N"</span>, sh <span class="op">=</span> <span class="st">"-C_S"</span>, sf <span class="op">=</span> <span class="st">"+C_S"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Govt. Exp"</span>, nf <span class="op">=</span> <span class="st">"+G_N"</span>, ng <span class="op">=</span> <span class="st">"-G_N"</span>, sf <span class="op">=</span> <span class="st">"+G_S"</span>, sg <span class="op">=</span> <span class="st">"-G_S"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"North X to South"</span>, nf <span class="op">=</span> <span class="st">"+X_N * xr"</span>, sf <span class="op">=</span> <span class="st">"-IM_S"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"South X to North"</span>, nf <span class="op">=</span> <span class="st">"-IM_N * xr"</span>, sf <span class="op">=</span> <span class="st">"+X_S"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GDP"</span>, nh <span class="op">=</span> <span class="st">"+Y_N"</span>, nf <span class="op">=</span> <span class="st">"-Y_N"</span>, sh <span class="op">=</span> <span class="st">"+Y_S"</span>, sf <span class="op">=</span> <span class="st">"-Y_S"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Interest payments"</span>, nh <span class="op">=</span> <span class="st">"+r_N[-1] * Bh_N[-1]"</span>, ng <span class="op">=</span> <span class="st">"-r_N[-1] * Bs_N[-1]"</span>, ncb <span class="op">=</span> <span class="st">"+r_N[-1] * Bcb_N[-1]"</span>, sh <span class="op">=</span> <span class="st">"+r_S[-1] * Bh_S[-1]"</span>, sg <span class="op">=</span> <span class="st">"-r_S[-1] * Bs_S[-1]"</span>, scb <span class="op">=</span> <span class="st">"+r_S[-1] * Bcb_S[-1]"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CB Profits"</span>, ng <span class="op">=</span> <span class="st">"+r_N[-1] * Bcb_N[-1]"</span>, ncb <span class="op">=</span> <span class="st">"-r_N[-1] * Bcb_N[-1]"</span>, sg <span class="op">=</span> <span class="st">"+r_S[-1] * Bcb_S[-1]"</span>, scb <span class="op">=</span> <span class="st">"-r_S[-1] * Bcb_S[-1]"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxes"</span>, nh <span class="op">=</span> <span class="st">"-TX_N"</span>, ng <span class="op">=</span> <span class="st">"+TX_N"</span>, sh <span class="op">=</span> <span class="st">"-TX_S"</span>, sg <span class="op">=</span> <span class="st">"+TX_S"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. cash"</span>, nh <span class="op">=</span> <span class="st">"-d(Hh_N)"</span>, ncb <span class="op">=</span> <span class="st">"+d(Hs_N)"</span>, sh <span class="op">=</span> <span class="st">"-d(Hh_S)"</span>, scb <span class="op">=</span> <span class="st">"+d(Hs_S)"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. bills"</span>, nh <span class="op">=</span> <span class="st">"-d(Bh_N)"</span>, ng <span class="op">=</span> <span class="st">"+d(Bs_N)"</span>, ncb <span class="op">=</span> <span class="st">"-d(Bcb_N)"</span>, sh <span class="op">=</span> <span class="st">"-d(Bh_S)"</span>, sg <span class="op">=</span> <span class="st">"+d(Bs_S)"</span>, scb <span class="op">=</span> <span class="st">"-d(Bcb_S)"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. Gold"</span>, ncb <span class="op">=</span> <span class="st">"-d(or_N) * pg_N * xr"</span>, scb <span class="op">=</span> <span class="st">"-d(or_S) * pg_S"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Validate:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_validate.html">sfcr_validate</a></span><span class="op">(</span><span class="va">tfm_open</span>, <span class="va">open</span>, <span class="st">"tfm"</span><span class="op">)</span>
<span class="co">#&gt; Water tight! The transactions-flow matrix is consistent with the simulated model.</span></code></pre></div>
</div>
</div>
<div id="sankeys-diagram-1" class="section level2">
<h2 class="hasAnchor">
<a href="#sankeys-diagram-1" class="anchor"></a>Sankey’s diagram</h2>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_sankey.html">sfcr_sankey</a></span><span class="op">(</span><span class="va">tfm_open</span>, <span class="va">open</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-9f0e4b837cbc038d4541" style="width:700px;height:432.632880098888px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-9f0e4b837cbc038d4541">{"x":{"links":{"source":[11,15,13,17,16,12,12,16,13,17,14,18,11,15,11,15,11,14,15,18,14,0,0,1,1,2,3,4,4,5,5,5,5,6,6,7,7,8,8,9,9,10],"target":[0,0,1,1,2,3,4,4,5,5,6,6,7,7,8,8,9,9,9,9,10,20,24,20,24,20,24,19,23,19,22,23,26,21,25,21,25,22,26,21,25,26],"value":[46.564532,48.709666,20,20,10.269323,10.021807,66.812047,68.46215,0.693173,0.628241,0.208845,0.250723,13.459275,13.767934,2.436568,2.128779,4.836001,2.189052,4.23329,2.376295,0.247515,46.564532,48.709666,20,20,10.269323,10.021807,66.812047,68.46215,0.484328,0.208845,0.377518,0.250723,0.208845,0.250723,13.459275,13.767934,2.436568,2.128779,7.025053,6.609585,0.247515]},"nodes":{"name":["Consumption","Govt. Exp","North X to South","South X to North","GDP","Interest payments","CB Profits","Taxes","Ch. cash","Ch. bills","Ch. Gold","N_Households","N_Firms","N_Govt","N_CentralBank","S_Households","S_Firms","S_Govt","S_CentralBank","N_Households","N_Firms","N_Govt","N_CentralBank","S_Households","S_Firms","S_Govt","S_CentralBank"],"group":["Consumption","Govt. Exp","North X to South","South X to North","GDP","Interest payments","CB Profits","Taxes","Ch. cash","Ch. bills","Ch. Gold","N_Households","N_Firms","N_Govt","N_CentralBank","S_Households","S_Firms","S_Govt","S_CentralBank","N_Households","N_Firms","N_Govt","N_CentralBank","S_Households","S_Firms","S_Govt","S_CentralBank"]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":14,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"dollars","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><p>Perfect. Now let’s play with scenarios.</p>
</div>
<div id="scenario-1-ever-falling-gold-reserves" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-1-ever-falling-gold-reserves" class="anchor"></a>Scenario 1: Ever-falling gold reserves</h2>
<p>What happens if there is an increase in the propensity to import in the South?</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">mu_S</span> <span class="op">~</span> <span class="fl">0.25</span><span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">60</span>
<span class="op">)</span>

<span class="va">open_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">open</span>, scenario <span class="op">=</span> <span class="va">shock1</span>, periods <span class="op">=</span> <span class="fl">60</span><span class="op">)</span>
<span class="va">open_1l</span> <span class="op">&lt;-</span> <span class="fu">to_long</span><span class="op">(</span><span class="va">open_1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open_1l</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Y_N"</span>, <span class="st">"Y_S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Evolution of GDP"</span><span class="op">)</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-37-1.png" width="700"></p>
<p>We see that both economies arrive to a new stationary GDP, with the Southern economy being permanently below its initial GDP.</p>
<p>What happen with the trade and government balances?</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open_1l</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"TB_S"</span>, <span class="st">"TB_N"</span>, <span class="st">"GB_S"</span>, <span class="st">"GB_N"</span>, <span class="st">"deltaV_S"</span>, <span class="st">"deltaV_N"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">country</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Twin deficits/surpluses"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 4 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-38-1.png" width="700"></p>
<p>An increase in the propensity to consume leads to a permanent twin deficit in the South economy and a permanent twin surplus in the North economy. This situation makes one wonder: what happens with the gold reserves of both countries?</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open_1l</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"or_S"</span>, <span class="st">"or_N"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Ever falling gold reserves"</span><span class="op">)</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-39-1.png" width="700"></p>
<p>This situation is obviously unsustainable. A country cannot have a ever-falling gold reserves ad-infinitum. However, here it is nice to see what’s happening with the balance sheet of the Southern central bank:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open_1l</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"deltaHs_S"</span>, <span class="st">"deltaBcb_S"</span>, <span class="st">"deltaor_S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Evolution of the Balance sheet of South Central Bank"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-40-1.png" width="700"></p>
<p>This graph shows the compensation thesis in action: the variation in the money stocks in the economy is equal to zero in the long-run. All the depletion of gold reserves is being compensated by the central bank by acquiring Bonds from the government.</p>
<p>Yet, this model is unsustainable. A country cannot have ever-falling gold reserves (at least not in a gold standard system).</p>
</div>
<div id="open2-adjustment-through-government-expenditures" class="section level2">
<h2 class="hasAnchor">
<a href="#open2-adjustment-through-government-expenditures" class="anchor"></a>OPEN2: Adjustment through government expenditures</h2>
<p>Let’s slightly modify model OPEN to introduce an adjustment mechanism through government expenditures. The idea here is that the government running out of gold will contract pure government expenditures in order to reestablish the balance in its balance of payments.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open2_eqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">open_eqs</span>,
  <span class="va">G_N</span> <span class="op">~</span> <span class="va">G_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">phi_N</span> <span class="op">*</span> <span class="op">(</span> <span class="op">(</span><span class="va">or_N</span> <span class="op">-</span> <span class="va">or_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">pg_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span>,
  <span class="va">G_S</span> <span class="op">~</span> <span class="va">G_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">phi_S</span> <span class="op">*</span> <span class="op">(</span> <span class="op">(</span><span class="va">or_S</span> <span class="op">-</span> <span class="va">or_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">pg_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span>
<span class="op">)</span>


<span class="co"># Remove G_N and G_S from exogenous variables</span>

<span class="co"># Find the ids to exclude</span>
<span class="fu"><a href="../../reference/sfcr_set_index.html">sfcr_set_index</a></span><span class="op">(</span><span class="va">open_ext</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">lhs</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"G_N"</span>, <span class="st">"G_S"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 × 3</span>
<span class="co">#&gt;      id lhs   rhs  </span>
<span class="co">#&gt;   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1     5 G_S   20   </span>
<span class="co">#&gt; 2     6 G_N   20</span>


<span class="va">open2_ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">open_ext</span>,
  <span class="va">phi_N</span> <span class="op">~</span> <span class="fl">0.25</span>,
  <span class="va">phi_S</span> <span class="op">~</span> <span class="fl">0.25</span>,
  exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>
<span class="op">)</span>


<span class="co"># open2_exg &lt;- open_exg[1:4]</span>
<span class="co"># </span>

<span class="co"># Add initial values to govt. expenditures</span>
<span class="va">open2_initial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
   <span class="va">G_N</span> <span class="op">~</span> <span class="fl">20</span>,
   <span class="va">G_S</span> <span class="op">~</span> <span class="fl">20</span>
 <span class="op">)</span>

<span class="va">open2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span><span class="va">open2_eqs</span>, <span class="va">open2_ext</span>, <span class="fl">60</span>, initial <span class="op">=</span> <span class="va">open2_initial</span>, hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"deltaor_N"</span> <span class="op">=</span> <span class="st">"deltaor_S"</span><span class="op">)</span>, .hidden_tol <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></code></pre></div>
</div>
<div id="scenario-1" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-1" class="anchor"></a>Scenario 1:</h2>
<p>We then add <code>shock1</code> to this model:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open2_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">open2</span>, <span class="va">shock1</span>, <span class="fl">60</span><span class="op">)</span>
<span class="va">open2_1l</span> <span class="op">&lt;-</span> <span class="fu">to_long</span><span class="op">(</span><span class="va">open2_1</span><span class="op">)</span></code></pre></div>
<p>And we plot the variables:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open2_1l</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"TB_S"</span>, <span class="st">'TB_N'</span>, <span class="st">'deltaV_N'</span>, <span class="st">"deltaV_S"</span>, <span class="st">"GB_S"</span>,  <span class="st">"GB_N"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">country</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 4 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-43-1.png" width="700"></p>
</div>
</div>
<div id="model-open3-adjustment-through-interest-rates" class="section level1">
<h1 class="hasAnchor">
<a href="#model-open3-adjustment-through-interest-rates" class="anchor"></a>Model OPEN3: Adjustment through interest rates</h1>
<p>International organizations like the IMF and the WB usually suggest monetary contraction together with fiscal austerity for countries dealing with balance of payments crisis. How would our model fare if we added an adjustment mechanism through interest rates instead?</p>
<p>The answer is simple: it will not adjust. This model inherits from model PC where there higher interest rates actually lead to higher economic activity. Therefore, adjusting the interest rate in response to the balance of payments disequilibrium will only aggravate the problem as it will lead to higher economic activity and henceforth to higher imports.</p>
<p>Let’s take a look at this developments.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#TODO here: the equations for model OPENM should have the percent change in gold reserves as a determinant of interest rates, rather than the absolute change in gold reserves (Source: Zezza)</span>

<span class="fu"><a href="../../reference/sfcr_set_index.html">sfcr_set_index</a></span><span class="op">(</span><span class="va">open_ext</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">lhs</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"r_N"</span>, <span class="st">"r_S"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 × 3</span>
<span class="co">#&gt;      id lhs   rhs  </span>
<span class="co">#&gt;   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1     3 r_N   0.025</span>
<span class="co">#&gt; 2     4 r_S   0.025</span>

<span class="va">open3_eqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">open_eqs</span>,
  <span class="va">r_N</span> <span class="op">~</span> <span class="va">r_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">phi_N</span> <span class="op">*</span> <span class="op">(</span> <span class="op">(</span><span class="op">(</span><span class="va">or_N</span> <span class="op">-</span> <span class="va">or_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="va">or_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">pg_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span>,
  <span class="va">r_S</span> <span class="op">~</span> <span class="va">r_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">phi_S</span> <span class="op">*</span> <span class="op">(</span> <span class="op">(</span><span class="op">(</span><span class="va">or_S</span> <span class="op">-</span> <span class="va">or_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="va">or_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">pg_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span>
<span class="op">)</span>

<span class="va">open3_ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">open_ext</span>,
  <span class="va">phi_N</span> <span class="op">~</span> <span class="fl">0.005</span>,
  <span class="va">phi_S</span> <span class="op">~</span> <span class="fl">0.005</span>,
  exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># We have to initialize the interest rates now</span>
<span class="va">open3_initial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  <span class="va">r_N</span> <span class="op">~</span> <span class="fl">0.025</span>,
  <span class="va">r_S</span> <span class="op">~</span> <span class="fl">0.025</span>
<span class="op">)</span>

<span class="va">open3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span><span class="va">open3_eqs</span>, <span class="va">open3_ext</span>, periods <span class="op">=</span> <span class="fl">100</span>, initial <span class="op">=</span> <span class="va">open3_initial</span>,
                  hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"deltaor_S"</span> <span class="op">=</span> <span class="st">"deltaor_N"</span><span class="op">)</span>, .hidden_tol <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>

<span class="va">open3</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">period</span>, <span class="va">r_N</span>, <span class="va">r_S</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 100 × 3</span>
<span class="co">#&gt;    period    r_N    r_S</span>
<span class="co">#&gt;     &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt;  1      1 0.025  0.025 </span>
<span class="co">#&gt;  2      2 0.0207 0.0293</span>
<span class="co">#&gt;  3      3 0.0171 0.0258</span>
<span class="co">#&gt;  4      4 0.0157 0.0244</span>
<span class="co">#&gt;  5      5 0.0150 0.0236</span>
<span class="co">#&gt;  6      6 0.0147 0.0233</span>
<span class="co">#&gt;  7      7 0.0145 0.0231</span>
<span class="co">#&gt;  8      8 0.0144 0.0231</span>
<span class="co">#&gt;  9      9 0.0145 0.0231</span>
<span class="co">#&gt; 10     10 0.0146 0.0232</span>
<span class="co">#&gt; # … with 90 more rows</span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open3_l</span> <span class="op">&lt;-</span> <span class="fu">to_long</span><span class="op">(</span><span class="va">open3</span><span class="op">)</span>

<span class="va">open3_l</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"r_N"</span>, <span class="st">"r_S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-45-1.png" width="700"></p>
<p>It is even difficult to find a steady state for this model. Play as much as you want to see by yourself.</p>
<p>Let’s try adding a buffer zone around the variation of the gold reserves that would trigger a interest rate increase:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open4_eqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">open_eqs</span>,
  <span class="va">r_N</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">(</span> <span class="op">(</span><span class="va">or_N</span> <span class="op">-</span> <span class="va">or_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">pg_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span><span class="va">r_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">phi_N</span> <span class="op">*</span> <span class="op">(</span> <span class="op">(</span><span class="va">or_N</span> <span class="op">-</span> <span class="va">or_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">pg_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="va">r_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">}</span>,
  <span class="va">r_S</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">(</span> <span class="op">(</span><span class="va">or_S</span> <span class="op">-</span> <span class="va">or_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">pg_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span><span class="va">r_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">phi_S</span> <span class="op">*</span> <span class="op">(</span> <span class="op">(</span><span class="va">or_S</span> <span class="op">-</span> <span class="va">or_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">pg_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="va">r_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">}</span>
<span class="op">)</span>

<span class="co"># Broyden and Newton fails to solve -- very unstable model</span>
<span class="va">open4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span><span class="va">open4_eqs</span>, <span class="va">open3_ext</span>, periods <span class="op">=</span> <span class="fl">50</span>, initial <span class="op">=</span> <span class="va">open3_initial</span>,
                  hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"deltaor_S"</span> <span class="op">=</span> <span class="st">"deltaor_N"</span><span class="op">)</span>, .hidden_tol <span class="op">=</span> <span class="fl">0.01</span>,
                  method <span class="op">=</span> <span class="st">"Gauss"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open4_l</span> <span class="op">&lt;-</span> <span class="fu">to_long</span><span class="op">(</span><span class="va">open4</span><span class="op">)</span>

<span class="va">open4_l</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"r_N"</span>, <span class="st">"r_S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">country</span><span class="op">)</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-47-1.png" width="700"> This is a steady state. However, its a very unstable model in which any shock blows it up. In the following experiment I include only 20 periods because the model does not run if I add much more than that.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">mu_S</span> <span class="op">~</span> <span class="fl">0.2</span><span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">20</span>
<span class="op">)</span>

<span class="va">open4_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">open4</span>, scenario <span class="op">=</span> <span class="va">shock1</span>, periods <span class="op">=</span> <span class="fl">20</span>, method <span class="op">=</span> <span class="st">"Gauss"</span><span class="op">)</span>
<span class="va">open4_1l</span> <span class="op">&lt;-</span> <span class="fu">to_long</span><span class="op">(</span><span class="va">open4_1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open4_1l</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"r_N"</span>, <span class="st">"r_S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-49-1.png" width="700"> This model obviously explode and I had to use the Gauss-Seidel solver and decrease the number of periods to find some solution to it (as they do in the book).</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open4_1l</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"TB_N"</span>, <span class="st">"TB_S"</span>, <span class="st">"GB_S"</span>, <span class="st">"GB_N"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-50-1.png" width="700"></p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_dag_blocks_plot.html">sfcr_dag_blocks_plot</a></span><span class="op">(</span><span class="va">open4_eqs</span><span class="op">)</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-51-1.png" width="700"></p>
<div id="scenario-making-aggregate-income-dependent-on-interest-rates" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-making-aggregate-income-dependent-on-interest-rates" class="anchor"></a>Scenario: Making aggregate income dependent on interest rates</h2>
<p>One possibility outlined in the book is to modify the propensity to consume out of disposable income to be a negative function on interest rates:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open4b_eqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">open3_eqs</span>,
  <span class="va">alpha1_S</span> <span class="op">~</span> <span class="va">alpha10_S</span> <span class="op">-</span> <span class="va">iota_S</span> <span class="op">*</span> <span class="va">r_S</span>,
  <span class="va">alpha1_N</span> <span class="op">~</span> <span class="va">alpha10_N</span> <span class="op">-</span> <span class="va">iota_N</span> <span class="op">*</span> <span class="va">r_S</span>
  <span class="op">)</span>

<span class="co"># Alpha1 becomes endogenous. We need to remove it from the external set</span>

<span class="fu"><a href="../../reference/sfcr_set_index.html">sfcr_set_index</a></span><span class="op">(</span><span class="va">open3_ext</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="fu">str_detect</span><span class="op">(</span><span class="va">lhs</span>, <span class="st">"alpha1"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 × 3</span>
<span class="co">#&gt;      id lhs      rhs  </span>
<span class="co">#&gt;   &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;</span>
<span class="co">#&gt; 1     7 alpha1_N 0.7  </span>
<span class="co">#&gt; 2     8 alpha1_S 0.8</span>

<span class="va">open4b_ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">open3_ext</span>,
  <span class="va">alpha10_N</span> <span class="op">~</span> <span class="fl">0.7</span>,
  <span class="va">alpha10_S</span> <span class="op">~</span> <span class="fl">0.8</span>,
  <span class="va">iota_S</span> <span class="op">~</span> <span class="fl">0.5</span>,
  <span class="va">iota_N</span> <span class="op">~</span> <span class="fl">0.35</span>,
  exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">open4b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span><span class="va">open4b_eqs</span>, <span class="va">open4b_ext</span>, <span class="fl">100</span>, initial <span class="op">=</span> <span class="va">open3_initial</span>, hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"deltaor_S"</span> <span class="op">=</span> <span class="st">"deltaor_N"</span><span class="op">)</span>, .hidden_tol <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>

<span class="va">open4b_l</span> <span class="op">&lt;-</span> <span class="fu">to_long</span><span class="op">(</span><span class="va">open4b</span><span class="op">)</span></code></pre></div>
<p>As we can see in the Figure below, this model struggles to find a stable stationary state. What is happening here is that there’s no stabilizing mechanism on the side of the North economy.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open4b_l</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"r_N"</span>, <span class="st">"r_S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"No stationary state"</span><span class="op">)</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-53-1.png" width="700"></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open4b_l</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"r_N"</span>, <span class="st">"r_S"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Model OPEN4B"</span>,
    subtitle <span class="op">=</span> <span class="st">"No stationary state"</span><span class="op">)</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-54-1.png" width="700"></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open4b_l</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="fu">str_detect</span><span class="op">(</span><span class="va">name</span>, <span class="st">"TB|GB"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">country</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Model OPEN4B"</span>,
    subtitle <span class="op">=</span> <span class="st">"No stationary state"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-55-1.png" width="700"></p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open4b_l</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="fu">str_detect</span><span class="op">(</span><span class="va">name</span>, <span class="st">"YD|V"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">country</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Model OPEN4B"</span>,
    subtitle <span class="op">=</span> <span class="st">"No stationary state"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-56-1.png" width="700"></p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open4b_l</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="fu">str_detect</span><span class="op">(</span><span class="va">name</span>, <span class="st">"Y_"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">country</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Model OPEN4B"</span>,
    subtitle <span class="op">=</span> <span class="st">"No stationary state"</span><span class="op">)</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-57-1.png" width="700"></p>
</div>
<div id="scenario-a-perverse-reaction-function-the-puzzling-effect-of-interest-rates-revisited" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-a-perverse-reaction-function-the-puzzling-effect-of-interest-rates-revisited" class="anchor"></a>Scenario: A perverse reaction function? The puzzling effect of interest rates revisited</h2>
<p>Now, let’s imagine a similar model, but where the central bank react to a trade deficit by <strong>decreasing</strong> interest rates:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open5_eqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">open_eqs</span>,
  <span class="va">r_N</span> <span class="op">~</span> <span class="va">r_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">phi_N</span> <span class="op">*</span> <span class="op">(</span> <span class="op">(</span><span class="va">or_N</span> <span class="op">-</span> <span class="va">or_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">pg_N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span>,
  <span class="va">r_S</span> <span class="op">~</span> <span class="va">r_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">phi_S</span> <span class="op">*</span> <span class="op">(</span> <span class="op">(</span><span class="va">or_S</span> <span class="op">-</span> <span class="va">or_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">pg_S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="../../reference/sfcr_set_index.html">sfcr_set_index</a></span><span class="op">(</span><span class="va">open_ext</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">lhs</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"r_N"</span>, <span class="st">"r_S"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 × 3</span>
<span class="co">#&gt;      id lhs   rhs  </span>
<span class="co">#&gt;   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1     3 r_N   0.025</span>
<span class="co">#&gt; 2     4 r_S   0.025</span>

<span class="va">open5_ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">open_ext</span>,
  <span class="va">phi_N</span> <span class="op">~</span> <span class="fl">0.002</span>,
  <span class="va">phi_S</span> <span class="op">~</span> <span class="fl">0.002</span>,
  exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># We have to initialize the interest rates now</span>
<span class="va">open5_initial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">r_N</span> <span class="op">~</span> <span class="fl">0.025</span>,
  <span class="va">r_S</span> <span class="op">~</span> <span class="fl">0.025</span>
<span class="op">)</span>

<span class="va">open5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span>
  equations <span class="op">=</span> <span class="va">open5_eqs</span>, 
  external <span class="op">=</span> <span class="va">open5_ext</span>,
  periods <span class="op">=</span> <span class="fl">100</span>, 
  initial <span class="op">=</span> <span class="va">open3_initial</span>,
  hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"deltaor_S"</span> <span class="op">=</span> <span class="st">"deltaor_N"</span><span class="op">)</span>, 
  .hidden_tol <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">mu_S</span> <span class="op">~</span> <span class="fl">0.2</span><span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">60</span>
<span class="op">)</span>

<span class="va">open5_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">open5</span>, scenario <span class="op">=</span> <span class="va">shock1</span>, periods <span class="op">=</span> <span class="fl">60</span><span class="op">)</span>
<span class="va">open5_1l</span> <span class="op">&lt;-</span> <span class="fu">to_long</span><span class="op">(</span><span class="va">open5_1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">open5_1l</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"TB_N"</span>, <span class="st">"TB_S"</span>, <span class="st">"GB_S"</span>, <span class="st">"GB_N"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">country</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Model OPEN5"</span>,
    subtitle <span class="op">=</span> <span class="st">"The puzzling effect of interest rates"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl4-open_files/figure-html/unnamed-chunk-60-1.png" width="700"></p>
<p>Voilà, we found that in model OPEN a reaction function that decreases interest rates brings the model back to a stable equilibrium.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-godley2007monetary">
<p>Godley, Wynne, and Marc Lavoie. 2007. <em>Monetary Economics: An Integrated Approach to Credit, Money, Income, Production and Wealth</em>. Palgrave Macmillan.</p>
</div>
</div>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>To understand the importance of the <code>hidden</code> argument, I invite the reader to change the first equation to <code>Y_N ~ C_N + G_N + X_N + IM_N</code>. That’s obviously a mistake as <code>IM_N</code> should be deducted from the model. However, it is a easy-to-make typo when copying the equations from the book. The model will run and converge to answers in each period but they will make little sense. Setting the hidden equation would throw an error instead, inviting the reader to re-check the equations.<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Also note that I wrote the balances in their standard form, i.e., I called the “trade balance” as exports minus imports, and “government balance” as taxes minus expenditures. The results are the same because they should converge to zero in a correctly specified model.<a href="#fnref2" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Joao Macalos.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
