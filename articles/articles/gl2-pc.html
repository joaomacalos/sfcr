<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 4: Model PC • sfcr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Chapter 4: Model PC">
<meta property="og:description" content="sfcr">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@jpmacalos">
<meta name="twitter:site" content="www.joaomacalos.com">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">sfcr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/gl1-sim.html">Chapter 3: Model SIM</a>
    </li>
    <li>
      <a href="../../articles/articles/gl2-pc.html">Chapter 4: Model PC</a>
    </li>
    <li>
      <a href="../../articles/articles/gl3-lp.html">Chapter 5: Model LP</a>
    </li>
    <li>
      <a href="../../articles/articles/gl4-open.html">Chapter 6: Models REG and OPEN</a>
    </li>
    <li>
      <a href="../../articles/articles/gl5-bmw.html">Chapter 7: Model BMW</a>
    </li>
    <li>
      <a href="../../articles/articles/gl6-dis.html">Chapter 9: Model DIS and DISINF</a>
    </li>
    <li>
      <a href="../../articles/articles/gl7-insout.html">Chapter 10: Model INSOUT</a>
    </li>
    <li>
      <a href="../../articles/articles/gl8-growth.html">Chapter 11: Model GROWTH</a>
    </li>
    <li>
      <a href="../../articles/articles/gl9-open12.html">Chapter 12: Model Advanced OPEN</a>
    </li>
    <li>
      <a href="../../articles/sfcr_multis.html">sfcr_multis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/joaomacalos/sfcr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="gl2-pc_files/kePrint-0.0.1/kePrint.js"></script><link href="gl2-pc_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="gl2-pc_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="gl2-pc_files/d3-4.5.0/d3.min.js"></script><script src="gl2-pc_files/sankey-1/sankey.js"></script><script src="gl2-pc_files/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Chapter 4: Model PC</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/joaomacalos/sfcr/blob/master/vignettes/articles/gl2-pc.Rmd"><code>vignettes/articles/gl2-pc.Rmd</code></a></small>
      <div class="hidden name"><code>gl2-pc.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="co">#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</span>
<span class="co">#&gt; ✔ ggplot2 3.3.5     ✔ purrr   0.3.4</span>
<span class="co">#&gt; ✔ tibble  3.1.5     ✔ dplyr   1.0.7</span>
<span class="co">#&gt; ✔ tidyr   1.1.4     ✔ stringr 1.4.0</span>
<span class="co">#&gt; ✔ readr   2.0.2     ✔ forcats 0.5.1</span>
<span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span>
<span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joaomacalos/sfcr">sfcr</a></span><span class="op">)</span></code></pre></div>
<div id="the-matrices-of-model-pc" class="section level1">
<h1 class="hasAnchor">
<a href="#the-matrices-of-model-pc" class="anchor"></a>The matrices of model PC</h1>
<p>We start the analysis by writing down the balance-sheet and transactions-flow matrices of the model:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bs_pc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_matrix.html">sfcr_matrix</a></span><span class="op">(</span>
  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Households"</span>, <span class="st">"Firms"</span>, <span class="st">"Government"</span>, <span class="st">"Central bank"</span>, <span class="st">"sum"</span><span class="op">)</span>,
  codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"h"</span>, <span class="st">"f"</span>, <span class="st">"g"</span>, <span class="st">"cb"</span>, <span class="st">"s"</span><span class="op">)</span>,
  r1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Money"</span>, h <span class="op">=</span> <span class="st">"+Hh"</span>, cb <span class="op">=</span> <span class="st">"-Hs"</span><span class="op">)</span>,
  r2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bills"</span>, h <span class="op">=</span> <span class="st">"+Bh"</span>, g <span class="op">=</span> <span class="st">"-Bs"</span>, cb <span class="op">=</span> <span class="st">"+Bcb"</span><span class="op">)</span>,
  r3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Balance"</span>, h <span class="op">=</span> <span class="st">"-V"</span>, g <span class="op">=</span> <span class="st">"+V"</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="../../reference/sfcr_matrix_display.html">sfcr_matrix_display</a></span><span class="op">(</span><span class="va">bs_pc</span>, <span class="st">"bs"</span><span class="op">)</span></code></pre></div>
<table class="table table table-striped table-hover">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Households
</th>
<th style="text-align:left;">
Firms
</th>
<th style="text-align:left;">
Government
</th>
<th style="text-align:left;">
Central bank
</th>
<th style="text-align:left;">
<span class="math inline">\(\sum\)</span>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Money
</td>
<td style="text-align:left;">
<span class="math inline">\(+Hh\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-Hs\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Bills
</td>
<td style="text-align:left;">
<span class="math inline">\(+Bh\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-Bs\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(+Bcb\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Balance
</td>
<td style="text-align:left;">
<span class="math inline">\(-V\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+V\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sum\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tfm_pc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_matrix.html">sfcr_matrix</a></span><span class="op">(</span>
  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Households"</span>, <span class="st">"Firms"</span>, <span class="st">"Government"</span>, <span class="st">"CB current"</span>, <span class="st">"CB capital"</span><span class="op">)</span>,
  codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"h"</span>, <span class="st">"f"</span>, <span class="st">"g"</span>, <span class="st">"cbc"</span>, <span class="st">"cbk"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Consumption"</span>, h <span class="op">=</span> <span class="st">"-C"</span>, f <span class="op">=</span> <span class="st">"+C"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Govt. Expenditures"</span>, f <span class="op">=</span> <span class="st">"+G"</span>, g <span class="op">=</span> <span class="st">"-G"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Income"</span>, h <span class="op">=</span> <span class="st">"+Y"</span>, f <span class="op">=</span> <span class="st">"-Y"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Int. payments"</span>, h <span class="op">=</span> <span class="st">"+r[-1] * Bh[-1]"</span>, g <span class="op">=</span> <span class="st">"-r[-1] * Bs[-1]"</span>, cbc <span class="op">=</span> <span class="st">"+r[-1] * Bcb[-1]"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CB profits"</span>, g <span class="op">=</span> <span class="st">"+r[-1] * Bcb[-1]"</span>, cbc <span class="op">=</span> <span class="st">"-r[-1] * Bcb[-1]"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxes"</span>, h <span class="op">=</span> <span class="st">"-TX"</span>, g <span class="op">=</span> <span class="st">"+TX"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. Money"</span>, h <span class="op">=</span> <span class="st">"-(Hh - Hh[-1])"</span>, cbk <span class="op">=</span> <span class="st">"+(Hs - Hs[-1])"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. Bills"</span>, h <span class="op">=</span> <span class="st">"-(Bh - Bh[-1])"</span>, g <span class="op">=</span> <span class="st">"+(Bs - Bs[-1])"</span>, cbk <span class="op">=</span> <span class="st">"-(Bcb - Bcb[-1])"</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="../../reference/sfcr_matrix_display.html">sfcr_matrix_display</a></span><span class="op">(</span><span class="va">tfm_pc</span><span class="op">)</span></code></pre></div>
<table class="table table table-striped table-hover">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Households
</th>
<th style="text-align:left;">
Firms
</th>
<th style="text-align:left;">
Government
</th>
<th style="text-align:left;">
CB current
</th>
<th style="text-align:left;">
CB capital
</th>
<th style="text-align:left;">
<span class="math inline">\(\sum\)</span>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Consumption
</td>
<td style="text-align:left;">
<span class="math inline">\(-C\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(+C\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Govt. Expenditures
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+G\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-G\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Income
</td>
<td style="text-align:left;">
<span class="math inline">\(+Y\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-Y\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Int. payments
</td>
<td style="text-align:left;">
<span class="math inline">\(+r_{-1}\cdot Bh_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-r_{-1}\cdot Bs_{-1}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(+r_{-1}\cdot Bcb_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
CB profits
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+r_{-1}\cdot Bcb_{-1}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-r_{-1}\cdot Bcb_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Taxes
</td>
<td style="text-align:left;">
<span class="math inline">\(-TX\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+TX\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ch. Money
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Hh\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta Hs\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ch. Bills
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Bh\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta Bs\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Bcb\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sum\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
</tbody>
</table>
<div id="the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#the-model" class="anchor"></a>The model</h2>
<p>To simulate the model, we first write down the equations and the external values:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pc_eqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">Y</span> <span class="op">~</span> <span class="va">C</span> <span class="op">+</span> <span class="va">G</span>,
  <span class="va">YD</span> <span class="op">~</span> <span class="va">Y</span> <span class="op">-</span> <span class="va">TX</span> <span class="op">+</span> <span class="va">r</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bh</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">TX</span> <span class="op">~</span> <span class="va">theta</span> <span class="op">*</span> <span class="op">(</span><span class="va">Y</span> <span class="op">+</span> <span class="va">r</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bh</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
  <span class="va">V</span> <span class="op">~</span> <span class="va">V</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">YD</span> <span class="op">-</span> <span class="va">C</span><span class="op">)</span>,
  <span class="va">C</span> <span class="op">~</span> <span class="va">alpha1</span> <span class="op">*</span> <span class="va">YD</span> <span class="op">+</span> <span class="va">alpha2</span> <span class="op">*</span> <span class="va">V</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">Hh</span> <span class="op">~</span> <span class="va">V</span> <span class="op">-</span> <span class="va">Bh</span>,
  <span class="va">Hh1</span> <span class="op">~</span> <span class="va">V</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">lambda0</span><span class="op">)</span> <span class="op">-</span> <span class="va">lambda1</span> <span class="op">*</span> <span class="va">r</span> <span class="op">+</span> <span class="va">lambda2</span> <span class="op">*</span> <span class="op">(</span> <span class="va">YD</span><span class="op">/</span><span class="va">V</span> <span class="op">)</span><span class="op">)</span>, <span class="co"># EQ 4.6A</span>
  <span class="va">Bh</span> <span class="op">~</span> <span class="va">V</span> <span class="op">*</span> <span class="op">(</span><span class="va">lambda0</span> <span class="op">+</span> <span class="va">lambda1</span> <span class="op">*</span> <span class="va">r</span> <span class="op">-</span> <span class="va">lambda2</span> <span class="op">*</span> <span class="op">(</span> <span class="va">YD</span><span class="op">/</span><span class="va">V</span> <span class="op">)</span><span class="op">)</span>,
  <span class="va">Bs</span> <span class="op">~</span> <span class="va">Bs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">G</span> <span class="op">+</span> <span class="va">r</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">TX</span> <span class="op">+</span> <span class="va">r</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bcb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
  <span class="va">Hs</span> <span class="op">~</span> <span class="va">Hs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">Bcb</span> <span class="op">-</span> <span class="va">Bcb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">Bcb</span> <span class="op">~</span> <span class="va">Bs</span> <span class="op">-</span> <span class="va">Bh</span>
<span class="op">)</span>

<span class="va">pc_ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="co"># Exogenous</span>
  
  <span class="va">r</span> <span class="op">~</span> <span class="fl">0.025</span>,
  <span class="va">G</span> <span class="op">~</span> <span class="fl">20</span>,
  
  <span class="co"># Parameters</span>
  
  <span class="va">alpha1</span> <span class="op">~</span> <span class="fl">0.6</span>,
  <span class="va">alpha2</span> <span class="op">~</span> <span class="fl">0.4</span>,
  <span class="va">theta</span> <span class="op">~</span> <span class="fl">0.2</span>,
  <span class="va">lambda0</span> <span class="op">~</span> <span class="fl">0.635</span>,
  <span class="va">lambda1</span> <span class="op">~</span> <span class="fl">0.05</span>,
  <span class="va">lambda2</span> <span class="op">~</span> <span class="fl">0.01</span>
<span class="op">)</span></code></pre></div>
<p>We then simulate the model to get the steady state values:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span>
  equations <span class="op">=</span> <span class="va">pc_eqs</span>, 
  external <span class="op">=</span> <span class="va">pc_ext</span>, 
  periods <span class="op">=</span> <span class="fl">70</span>, 
  hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hh"</span> <span class="op">=</span> <span class="st">"Hs"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>The fact that the hidden equation is fulfilled already indicates that the accounting part of the model is water tight. However, the <code>sfcr</code> package also allow the user to validate the model using the balance-sheet and transactions-flow matrices.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_validate.html">sfcr_validate</a></span><span class="op">(</span><span class="va">bs_pc</span>, <span class="va">pc</span>, <span class="st">"bs"</span><span class="op">)</span>
<span class="co">#&gt; Water tight! The balance-sheet matrix is consistent with the simulated model.</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_validate.html">sfcr_validate</a></span><span class="op">(</span><span class="va">tfm_pc</span>, <span class="va">pc</span>, <span class="st">"tfm"</span><span class="op">)</span>
<span class="co">#&gt; Water tight! The transactions-flow matrix is consistent with the simulated model.</span></code></pre></div>
<p>Given the portfolio choice equations, the model is well specified if equation 4.6A is equal to 4.6. We can use the base <code><a href="https://rdrr.io/r/base/all.equal.html">all.equal()</a></code> function to check it:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">pc</span><span class="op">$</span><span class="va">Hh</span>, <span class="va">pc</span><span class="op">$</span><span class="va">Hh1</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>We can safely conclude that the baseline model is well specified. The <code>sfcr</code> package also allows the user to plot the DAG representation of the model and a Sankey’s diagram of the transactions-flow matrix. Let’s check it out:</p>
</div>
<div id="dag" class="section level2">
<h2 class="hasAnchor">
<a href="#dag" class="anchor"></a>DAG</h2>
<p>Let’s use the <code><a href="../../reference/sfcr_dag_cycles_plot.html">sfcr_dag_cycles_plot()</a></code> function to see the structure of the model:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_dag_cycles_plot.html">sfcr_dag_cycles_plot</a></span><span class="op">(</span><span class="va">pc_eqs</span><span class="op">)</span></code></pre></div>
<p><img src="gl2-pc_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>As can be seen, there’s a cycle in this model. The <code>sfcr</code> package relies on the <code>igraph</code> package to identify the best ordering of the equations, reducing the the its computational burden. The blocks of independent equations and the iterations needed at each block to simulate the model can be retrieved by calling the <code><a href="../../reference/sfcr_get_matrix.html">sfcr_get_matrix()</a></code> and <code><a href="../../reference/sfcr_get_blocks.html">sfcr_get_blocks()</a></code> equations.</p>
<p>Alternatively, it is also possible to use the <code><a href="../../reference/sfcr_dag_blocks_plot.html">sfcr_dag_blocks_plot()</a></code> function to visualize this structure:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_dag_blocks_plot.html">sfcr_dag_blocks_plot</a></span><span class="op">(</span><span class="va">pc_eqs</span><span class="op">)</span></code></pre></div>
<p><img src="gl2-pc_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div id="sankeys-diagram" class="section level2">
<h2 class="hasAnchor">
<a href="#sankeys-diagram" class="anchor"></a>Sankey’s diagram</h2>
<p>Another functionality offered by the <code>sfcr</code> package is that it can generate a Sankey’s diagram representation of the transactions-flow matrix.</p>
<p>Here, it is crucial to have the matrix validated in order to assure that the diagram is correctly specified. Luckily, we already saw that it was the case earlier in this notebook:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_sankey.html">sfcr_sankey</a></span><span class="op">(</span><span class="va">tfm_pc</span>, <span class="va">pc</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-7811b0452ddb735e4b3f" style="width:700px;height:432.632880098888px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-7811b0452ddb735e4b3f">{"x":{"links":{"source":[8,10,9,10,11,8,8,8,12,0,1,2,3,3,4,5,6,7],"target":[0,1,2,3,4,5,6,7,7,14,14,13,13,16,15,15,17,15],"value":[43.418278,20,63.418278,0.796236,0.300973,12.782708,2.863079,4.849477,2.863079,43.418278,20,63.418278,0.495263,0.300973,0.300973,12.782708,2.863079,7.712555]},"nodes":{"name":["Consumption","Govt. Expenditures","Income","Int. payments","CB profits","Taxes","Ch. Money","Ch. Bills","Households","Firms","Government","CB current","CB capital","Households","Firms","Government","CB current","CB capital"],"group":["Consumption","Govt. Expenditures","Income","Int. payments","CB profits","Taxes","Ch. Money","Ch. Bills","Households","Firms","Government","CB current","CB capital","Households","Firms","Government","CB current","CB capital"]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":14,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"dollars","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><p>We can now move to simulation of different scenarios.</p>
</div>
</div>
<div id="scenario-1-increase-in-the-rate-of-interest-on-bills" class="section level1">
<h1 class="hasAnchor">
<a href="#scenario-1-increase-in-the-rate-of-interest-on-bills" class="anchor"></a>Scenario 1: Increase in the rate of interest on bills</h1>
<p>Let’s start by increasing the rate of interest on bills by 100 points:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
    <span class="va">r</span> <span class="op">~</span> <span class="fl">0.035</span>
  <span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">60</span>
<span class="op">)</span>

<span class="va">pc2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">pc</span>, scenario <span class="op">=</span> <span class="va">shock1</span>, periods <span class="op">=</span> <span class="fl">60</span><span class="op">)</span></code></pre></div>
<p>What happen in this scenario with the share of bills/money in household portfolios?</p>
<p>Since these ratios are not calculated when we simulate the scenario, we must calculate them now. We use the <code>dplyr</code> package from the <code>tidyverse</code> to manipulate the model:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pc2</span> <span class="op">&lt;-</span> <span class="va">pc2</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>BV <span class="op">=</span> <span class="va">Bh</span> <span class="op">/</span> <span class="va">V</span>,
         MV <span class="op">=</span> <span class="va">Hh</span> <span class="op">/</span> <span class="va">V</span><span class="op">)</span>

<span class="co"># If the read prefers to stick with base R functions, uncomment the following lines:</span>
<span class="co"># pc2$BV &lt;- pc2$B_h / pc2$V</span>
<span class="co"># pc2$MV &lt;- pc2$H_h / pc2$V</span></code></pre></div>
<p>We reshape the model into the long format, and then we plot.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pc2_long</span> <span class="op">&lt;-</span> <span class="va">pc2</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">period</span><span class="op">)</span>

<span class="va">pc2_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BV"</span>, <span class="st">"MV"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">name</span>, scales <span class="op">=</span> <span class="st">'free_y'</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Wealth alocation"</span><span class="op">)</span></code></pre></div>
<p><img src="gl2-pc_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pc2_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"YD"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Evolution of disposable income and household consumption"</span>,
       subtitle <span class="op">=</span> <span class="st">"Following an increase of 100 points in the rate of interest"</span><span class="op">)</span></code></pre></div>
<p><img src="gl2-pc_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div id="pcex1-random-shocks-to-expected-disposable-income" class="section level2">
<h2 class="hasAnchor">
<a href="#pcex1-random-shocks-to-expected-disposable-income" class="anchor"></a>PCEX1: Random shocks to expected disposable income</h2>
<p>To add a random shock to a variable with the <code>sfcr</code> package, one must create an auxiliary exogenous variable that will hold the exogenous shock, and add this exogenous variable to the endogenous variable of interest.</p>
<p>Let’s see how to add a shock to expected disposable income, following equation 4.16 of <span class="citation">Godley and Lavoie (2007)</span>.</p>
<p>First, we add the random shock, that we will call <code>Ra</code>, to the list of exogenous variables from the model <code>pc</code>.</p>
<p>To add a normal random shock in R, the common way is to use the <code><a href="https://rdrr.io/r/stats/Normal.html">rnorm()</a></code> function from the built-in <code>stats</code> package. This function accepts three arguments:</p>
<ol style="list-style-type: decimal">
<li>Number of observations;</li>
<li>Mean (default is 0);</li>
<li>Standard deviation (default is 1).</li>
</ol>
<p>The recommended way to use this function in the <code>sfcr</code> package is through the <code><a href="../../reference/sfcr_random.html">sfcr_random()</a></code> function, a wrapper that automatically detect the correct number of periods supplied to <code><a href="../../reference/sfcr_baseline.html">sfcr_baseline()</a></code> or <code><a href="../../reference/sfcr_scenario.html">sfcr_scenario()</a></code>. The <code><a href="../../reference/sfcr_random.html">sfcr_random()</a></code> function accepts as its first argument three string codes (<code>"rnorm"</code>, <code>"rbinom"</code>, and <code>"runif"</code>) that correspond to three random generator function from the <code>stats</code> built-in package. It also passes any extra argument to these functions.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pc_ext2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">pc_ext</span>, <span class="va">Ra</span> <span class="op">~</span> <span class="fu"><a href="../../reference/sfcr_random.html">sfcr_random</a></span><span class="op">(</span><span class="st">"rnorm"</span>, sd <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Next, we rewrite the equations, adding the expectations to the model:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pc_eqs2</span> <span class="op">&lt;-</span> <span class="va">pc_eqs</span>

<span class="va">pc_eqs2</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">C</span> <span class="op">~</span> <span class="va">alpha1</span> <span class="op">*</span> <span class="va">YDE</span> <span class="op">+</span> <span class="va">alpha2</span> <span class="op">*</span> <span class="va">V</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>
<span class="va">pc_eqs2</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Bh</span> <span class="op">~</span> <span class="va">Bd</span>
<span class="va">pc_eqs2</span><span class="op">[[</span><span class="fl">12</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Hd</span> <span class="op">~</span> <span class="va">VE</span> <span class="op">-</span> <span class="va">Bd</span>
<span class="va">pc_eqs2</span><span class="op">[[</span><span class="fl">13</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">VE</span> <span class="op">~</span> <span class="va">V</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">YDE</span> <span class="op">-</span> <span class="va">C</span><span class="op">)</span>
<span class="va">pc_eqs2</span><span class="op">[[</span><span class="fl">14</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Bd</span> <span class="op">~</span> <span class="va">VE</span> <span class="op">*</span> <span class="op">(</span><span class="va">lambda0</span> <span class="op">+</span> <span class="va">lambda1</span> <span class="op">*</span> <span class="va">r</span> <span class="op">-</span> <span class="va">lambda2</span> <span class="op">*</span> <span class="op">(</span> <span class="va">YDE</span><span class="op">/</span><span class="va">VE</span> <span class="op">)</span><span class="op">)</span>
<span class="va">pc_eqs2</span><span class="op">[[</span><span class="fl">15</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">YDE</span> <span class="op">~</span> <span class="va">YD</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">Ra</span><span class="op">)</span></code></pre></div>
<p>We use the same parameters as before:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pcex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span><span class="va">pc_eqs2</span>, <span class="va">pc_ext2</span>, <span class="fl">60</span>, hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hh"</span> <span class="op">=</span> <span class="st">"Hs"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The impact of adding these random noise to the expected disposable income can be seen by visualizing the money held balances vs the demand for money, and the changes in these variables:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pcex</span> <span class="op">&lt;-</span> <span class="va">pcex</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>delta_Hh <span class="op">=</span> <span class="va">Hh</span> <span class="op">-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">Hh</span><span class="op">)</span>,
         delta_Hd <span class="op">=</span> <span class="va">Hd</span> <span class="op">-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">Hd</span><span class="op">)</span><span class="op">)</span>

<span class="va">pcex_long</span> <span class="op">&lt;-</span> <span class="va">pcex</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">period</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pcex_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hh"</span>, <span class="st">"Hd"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Evolution of stocks"</span><span class="op">)</span></code></pre></div>
<p><img src="gl2-pc_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pcex_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"delta_Hh"</span>, <span class="st">"delta_Hd"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Variation"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl2-pc_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
</div>
<div id="pcex2-adaptive-expectations" class="section level2">
<h2 class="hasAnchor">
<a href="#pcex2-adaptive-expectations" class="anchor"></a>PCEX2: Adaptive expectations</h2>
<p>What would happen if, instead of random shocks to the expected disposable income, the households in our model followed a process of adaptive expectations?</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pc_eqs3</span> <span class="op">&lt;-</span> <span class="va">pc_eqs2</span>
<span class="va">pc_eqs3</span><span class="op">[[</span><span class="fl">15</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">YDE</span> <span class="op">~</span> <span class="va">YD</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>

<span class="va">pcex2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span><span class="va">pc_eqs3</span>, <span class="va">pc_ext2</span>, <span class="fl">60</span><span class="op">)</span>
<span class="co">#</span></code></pre></div>
<div id="paradox-of-thrift" class="section level3">
<h3 class="hasAnchor">
<a href="#paradox-of-thrift" class="anchor"></a>Paradox of thrift?</h3>
<p>One aspect of the model PCEX2 is that the paradox of thrift does not hold: an increase in the propensity to consume out of disposable income reduce the national income (Y) in the long run.</p>
<p>We can see this by adding a permanent increase to <code>alpha1</code> to model PCEX2:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
    <span class="va">alpha1</span> <span class="op">~</span> <span class="fl">0.7</span>
  <span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">60</span>
<span class="op">)</span>

<span class="va">pc3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">pcex2</span>, scenario <span class="op">=</span> <span class="va">shock2</span>, periods <span class="op">=</span> <span class="fl">60</span><span class="op">)</span>

<span class="va">pc3_long</span> <span class="op">&lt;-</span> <span class="va">pc3</span> <span class="op">%&gt;%</span>
  <span class="co">#mutate(LV = dplyr::lag(V, n = 2L)) %&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">period</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pc3_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">==</span> <span class="st">"Y"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Evolution of National income"</span><span class="op">)</span></code></pre></div>
<p><img src="gl2-pc_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pc3_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"YDE"</span>, <span class="st">"V"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"In the book it is written 'lagged' wealth but it is wealth actually."</span><span class="op">)</span></code></pre></div>
<p><img src="gl2-pc_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
</div>
<div id="the-puzzling-impact-of-interest-rates-reconsidered" class="section level3">
<h3 class="hasAnchor">
<a href="#the-puzzling-impact-of-interest-rates-reconsidered" class="anchor"></a>The puzzling impact of interest rates reconsidered</h3>
<p>What would happen with model PCEX2 if the propensity to consume (to save) becomes dependent on the rate of interest on bills?</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pc_eqs4</span> <span class="op">&lt;-</span> <span class="va">pc_eqs3</span>
<span class="va">pc_eqs4</span><span class="op">[[</span><span class="fl">16</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">alpha1</span> <span class="op">~</span> <span class="va">alpha10</span> <span class="op">-</span> <span class="va">iota</span> <span class="op">*</span> <span class="va">r</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>

<span class="va">pc_ext3</span> <span class="op">&lt;-</span> <span class="va">pc_ext</span>

<span class="va">pc_ext3</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">alpha10</span> <span class="op">~</span> <span class="fl">0.7</span>
<span class="va">pc_ext3</span><span class="op">[[</span><span class="fl">9</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">iota</span> <span class="op">~</span> <span class="fl">4</span>


<span class="va">pcex3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span><span class="va">pc_eqs4</span>, <span class="va">pc_ext3</span>, <span class="fl">60</span><span class="op">)</span></code></pre></div>
<p>We add <code>shock1</code> to this model:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pcex3_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">pcex3</span>, scenario <span class="op">=</span> <span class="va">shock1</span>, <span class="fl">60</span><span class="op">)</span>

<span class="va">pcex3_1_long</span> <span class="op">&lt;-</span> <span class="va">pcex3_1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>GExp <span class="op">=</span> <span class="va">G</span> <span class="op">+</span> <span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">Bs</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">*</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">Bcb</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">period</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pcex3_1_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="st">"V"</span>, <span class="st">"YD"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl2-pc_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pcex3_1_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GExp"</span>, <span class="st">"TX"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 1 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl2-pc_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
</div>
</div>
<div id="appendix-visualizing-the-sensitivity-to-parameters-values" class="section level2">
<h2 class="hasAnchor">
<a href="#appendix-visualizing-the-sensitivity-to-parameters-values" class="anchor"></a>Appendix: visualizing the sensitivity to parameters’ values</h2>
<p>This session requires a slightly more involved programming skills, and can be safely skipped by beginners.</p>
<p>When I was learning these models, I always wondered about the role of the parameters. For instance, in model PCEX2, one does only need a couple of trials to see that changing the parameters <code>alpha10</code> and <code>iota</code> will change the position of the lines. Let’s explore this issue.</p>
<p>The <code>sfcr</code> package provides a set of functions that makes this type of analysis very easy.</p>
<p>The most important function for this type of analysis is the <code><a href="../../reference/sfcr_multis.html">sfcr_multis()</a></code> function. This function generates multiple models from an expanded object and a fixed object. Currently, it accepts three possible combinations:</p>
<ol style="list-style-type: decimal">
<li><p>A <code>expanded</code> external set of parameters and exogenous values with a <code>fixed</code> set of model equations to generate multiple baseline models.</p></li>
<li><p>A <code>expanded</code> set of shocks that are applied to a <code>fixed</code> baseline model, generating multiple scenarios.</p></li>
<li><p>A <code>expanded</code> set of baseline models that are are applied to a <code>fixed</code> shock, generating multiple scenario models from multiple baseline models that receive the same shock.</p></li>
</ol>
<p>In this notebook, we are going to explore the impact of different values for the <code>alpha10</code> by generating many baseline models and applying the same shock to all of these models.</p>
<p>We start by creating a vector with 20 possible values spanning from 0.61 to 0.8 withe the built-in <code>seq</code> function. We use this vector to expand the external set with the <code><a href="../../reference/sfcr_expand.html">sfcr_expand()</a></code> function.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">values</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.61</span>, <span class="fl">0.8</span>, <span class="fl">0.01</span><span class="op">)</span>
<span class="va">alpha10Exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_expand.html">sfcr_expand</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pc_ext3</span>, variable <span class="op">=</span> <span class="va">alpha10</span>, values <span class="op">=</span> <span class="va">values</span><span class="op">)</span>
<span class="co">#</span></code></pre></div>
<p>We then use the <code><a href="../../reference/sfcr_multis.html">sfcr_multis()</a></code> function to generate multiple baseline models:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pc_multi_bl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_multis.html">sfcr_multis</a></span><span class="op">(</span><span class="va">alpha10Exp</span>, <span class="va">pc_eqs4</span>, periods <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></code></pre></div>
<p>Finally, apply the <code>shock1</code> shock to all the models in <code>pc_multi_bl</code>:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
    <span class="va">r</span> <span class="op">~</span> <span class="fl">0.035</span>
  <span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">50</span>
<span class="op">)</span>

<span class="va">pc_multi_scn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_multis.html">sfcr_multis</a></span><span class="op">(</span><span class="va">pc_multi_bl</span>, <span class="va">shock1</span>, periods <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># We also need to expand the color palettes</span>
<span class="va">colourCount</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># number of levels</span>
<span class="va">getPalette</span> <span class="op">&lt;-</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"GnBu"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">pc_multi_scn</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>simulation <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">simulation</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">period</span>, <span class="va">simulation</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="st">"YD"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">simulation</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_color_manual</span><span class="op">(</span><span class="st">"alpha10"</span>,
    values <span class="op">=</span> <span class="fu">getPalette</span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>,
    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">name</span>, scales <span class="op">=</span> <span class="st">'free_y'</span><span class="op">)</span></code></pre></div>
<p><img src="gl2-pc_files/figure-html/unnamed-chunk-33-1.png" width="864"></p>
<p>We can see that the changing the <code>alpha10</code> parameter affects the level of the variables but do not change its underlying dynamics.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-godley2007monetary">
<p>Godley, Wynne, and Marc Lavoie. 2007. <em>Monetary Economics: An Integrated Approach to Credit, Money, Income, Production and Wealth</em>. Palgrave Macmillan.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Joao Macalos.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
