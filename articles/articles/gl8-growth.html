<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 11: Model GROWTH • sfcr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Chapter 11: Model GROWTH">
<meta property="og:description" content="sfcr">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@jpmacalos">
<meta name="twitter:site" content="@jpmacalos">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">sfcr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/gl1-sim.html">Chapter 3: Model SIM</a>
    </li>
    <li>
      <a href="../../articles/articles/gl2-pc.html">Chapter 4: Model PC</a>
    </li>
    <li>
      <a href="../../articles/articles/gl3-lp.html">Chapter 5: Model LP</a>
    </li>
    <li>
      <a href="../../articles/articles/gl4-open.html">Chapter 6: Models REG and OPEN</a>
    </li>
    <li>
      <a href="../../articles/articles/gl5-bmw.html">Chapter 7: Model BMW</a>
    </li>
    <li>
      <a href="../../articles/articles/gl6-dis.html">Chapter 9: Model DIS and DISINF</a>
    </li>
    <li>
      <a href="../../articles/articles/gl7-insout.html">Chapter 10: Model INSOUT</a>
    </li>
    <li>
      <a href="../../articles/articles/gl8-growth.html">Chapter 11: Model GROWTH</a>
    </li>
    <li>
      <a href="../../articles/articles/gl9-open12.html">Chapter 12: Model Advanced OPEN</a>
    </li>
    <li>
      <a href="../../articles/sfcr_multis.html">sfcr_multis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/joaomacalos/sfcr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="gl8-growth_files/kePrint-0.0.1/kePrint.js"></script><link href="gl8-growth_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="gl8-growth_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="gl8-growth_files/d3-4.5.0/d3.min.js"></script><script src="gl8-growth_files/sankey-1/sankey.js"></script><script src="gl8-growth_files/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Chapter 11: Model GROWTH</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/joaomacalos/sfcr/blob/master/vignettes/articles/gl8-growth.Rmd"><code>vignettes/articles/gl8-growth.Rmd</code></a></small>
      <div class="hidden name"><code>gl8-growth.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joaomacalos/sfcr">sfcr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="co">#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</span>
<span class="co">#&gt; ✔ ggplot2 3.3.5     ✔ purrr   0.3.4</span>
<span class="co">#&gt; ✔ tibble  3.1.5     ✔ dplyr   1.0.7</span>
<span class="co">#&gt; ✔ tidyr   1.1.4     ✔ stringr 1.4.0</span>
<span class="co">#&gt; ✔ readr   2.0.2     ✔ forcats 0.5.1</span>
<span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span>
<span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></code></pre></div>
<p>In this notebook I present the implementation of the GROWTH model from <span class="citation">Godley and Lavoie (2007 ch. 11)</span>.</p>
<p>As a side note, I must say that this model is quite complicated to simulate, and I only could do it by using exactly the same equations as Zezza in his code, although some of the equations are different from the ones in the book. In this case, it means replicating exactly the same initial values in order to get a meaningful result.</p>
<div id="equations-parameters-and-initial-values" class="section level1">
<h1 class="hasAnchor">
<a href="#equations-parameters-and-initial-values" class="anchor"></a>Equations, parameters, and initial values</h1>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">growth_eqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">Yk</span> <span class="op">~</span> <span class="va">Ske</span> <span class="op">+</span> <span class="va">INke</span> <span class="op">-</span> <span class="va">INk</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,          <span class="co"># 11.1 : Real output</span>
  <span class="va">Ske</span> <span class="op">~</span> <span class="va">beta</span><span class="op">*</span><span class="va">Sk</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">beta</span><span class="op">)</span><span class="op">*</span><span class="va">Sk</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="va">GRpr</span> <span class="op">+</span> <span class="va">RA</span><span class="op">)</span><span class="op">)</span>, <span class="co"># 11.2 : Expected real sales</span>
  <span class="va">INke</span> <span class="op">~</span> <span class="va">INk</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">gamma</span><span class="op">*</span><span class="op">(</span><span class="va">INkt</span> <span class="op">-</span> <span class="va">INk</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,  <span class="co"># 11.3 : Long-run inventory target</span>
  <span class="va">INkt</span> <span class="op">~</span> <span class="va">sigmat</span><span class="op">*</span><span class="va">Ske</span>,                  <span class="co"># 11.4 : Short-run inventory target</span>
  <span class="va">INk</span> <span class="op">~</span> <span class="va">INk</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">Yk</span> <span class="op">-</span> <span class="va">Sk</span> <span class="op">-</span> <span class="va">NPL</span><span class="op">/</span><span class="va">UC</span>,   <span class="co"># 11.5 : Actual real inventories</span>
  <span class="va">Kk</span> <span class="op">~</span> <span class="va">Kk</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">GRk</span><span class="op">)</span>,              <span class="co"># 11.6 : Real capital stock</span>
  <span class="va">GRk</span> <span class="op">~</span> <span class="va">gamma0</span> <span class="op">+</span> <span class="va">gammau</span><span class="op">*</span><span class="va">U</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">gammar</span><span class="op">*</span><span class="va">RRl</span>,  <span class="co"># 11.7 : Growth of real capital stock</span>
  <span class="va">U</span> <span class="op">~</span> <span class="va">Yk</span><span class="op">/</span><span class="va">Kk</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,                      <span class="co"># 11.8 : Capital utilization proxy</span>
  <span class="va">RRl</span> <span class="op">~</span> <span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">Rl</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">PI</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,      <span class="co"># 11.9 : Real interest rate on loans</span>
  <span class="va">PI</span> <span class="op">~</span> <span class="op">(</span><span class="va">P</span> <span class="op">-</span> <span class="va">P</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="va">P</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,             <span class="co"># 11.10 : Rate of price inflation</span>
  <span class="co">#Ik ~ (Kk - Kk[-1]) + delta*Kk[-1],          # 11.11 : Real gross investment</span>
  <span class="va">Ik</span> <span class="op">~</span> <span class="op">(</span><span class="va">Kk</span> <span class="op">-</span> <span class="va">Kk</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="va">delta</span> <span class="op">*</span> <span class="va">Kk</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,

  <span class="co"># Box 11.2 : Firms equations</span>
  <span class="co"># ---------------------------</span>
  <span class="va">Sk</span> <span class="op">~</span> <span class="va">Ck</span> <span class="op">+</span> <span class="va">Gk</span> <span class="op">+</span> <span class="va">Ik</span>,                  <span class="co"># 11.12 : Actual real sales</span>
  <span class="va">S</span> <span class="op">~</span> <span class="va">Sk</span><span class="op">*</span><span class="va">P</span>,                           <span class="co"># 11.13 : Value of realized sales</span>
  <span class="va">IN</span> <span class="op">~</span> <span class="va">INk</span><span class="op">*</span><span class="va">UC</span>,                        <span class="co"># 11.14 : Inventories valued at current cost</span>
  <span class="va">INV</span> <span class="op">~</span> <span class="va">Ik</span><span class="op">*</span><span class="va">P</span>,                         <span class="co"># 11.15 : Nominal gross investment</span>
  <span class="va">K</span> <span class="op">~</span> <span class="va">Kk</span><span class="op">*</span><span class="va">P</span>,                           <span class="co"># 11.16 : Nomincal value of fixed capital</span>
  <span class="va">Y</span> <span class="op">~</span> <span class="va">Sk</span><span class="op">*</span><span class="va">P</span> <span class="op">+</span> <span class="op">(</span><span class="va">INk</span> <span class="op">-</span> <span class="va">INk</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">UC</span>,               <span class="co"># 11.17 : Nomincal GDP</span>

  <span class="co"># Box 11.3 : Firms equations</span>
  <span class="co"># ---------------------------</span>
  <span class="co"># 11.18 : Real wage aspirations</span>
  <span class="va">omegat</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">omega0</span> <span class="op">+</span> <span class="va">omega1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">PR</span><span class="op">)</span> <span class="op">+</span> <span class="va">omega2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">ER</span> <span class="op">+</span> <span class="va">z3</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">ER</span><span class="op">)</span> <span class="op">-</span> <span class="va">z4</span><span class="op">*</span><span class="va">BANDt</span> <span class="op">+</span> <span class="va">z5</span><span class="op">*</span><span class="va">BANDb</span><span class="op">)</span><span class="op">)</span>,
  <span class="va">ER</span> <span class="op">~</span> <span class="va">N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">Nfe</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,                 <span class="co"># 11.19 : Employment rate</span>
  <span class="co"># 11.20 : Switch variables</span>
  <span class="va">z3a</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="va">ER</span> <span class="op">&gt;</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">BANDb</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="fl">0</span><span class="op">}</span>,
  <span class="va">z3b</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="va">ER</span> <span class="op">&lt;=</span> <span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">BANDt</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="fl">0</span><span class="op">}</span>,
  <span class="va">z3</span> <span class="op">~</span>  <span class="va">z3a</span> <span class="op">*</span> <span class="va">z3b</span>,
  <span class="va">z4</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="va">ER</span> <span class="op">&gt;</span> <span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">BANDt</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="fl">0</span><span class="op">}</span>,
  <span class="va">z5</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="va">ER</span> <span class="op">&lt;</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">BANDb</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="fl">0</span><span class="op">}</span>,
  <span class="va">W</span> <span class="op">~</span> <span class="va">W</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">omega3</span><span class="op">*</span><span class="op">(</span><span class="va">omegat</span><span class="op">*</span><span class="va">P</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">W</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,  <span class="co"># 11.21 : Nominal wage</span>
  <span class="va">PR</span> <span class="op">~</span> <span class="va">PR</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">GRpr</span><span class="op">)</span>,             <span class="co"># 11.22 : Labor productivity</span>
  <span class="va">Nt</span> <span class="op">~</span> <span class="va">Yk</span><span class="op">/</span><span class="va">PR</span>,                         <span class="co"># 11.23 : Desired employment</span>
  <span class="va">N</span> <span class="op">~</span> <span class="va">N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">etan</span><span class="op">*</span><span class="op">(</span><span class="va">Nt</span> <span class="op">-</span> <span class="va">N</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,      <span class="co"># 11.24 : Actual employment --&gt; etan not in the book</span>
  <span class="va">WB</span> <span class="op">~</span> <span class="va">N</span><span class="op">*</span><span class="va">W</span>,                           <span class="co"># 11.25 : Nominal wage bill</span>
  <span class="va">UC</span> <span class="op">~</span> <span class="va">WB</span><span class="op">/</span><span class="va">Yk</span>,                         <span class="co"># 11.26 : Actual unit cost</span>
  <span class="va">NUC</span> <span class="op">~</span> <span class="va">W</span><span class="op">/</span><span class="va">PR</span>,                         <span class="co"># 11.27 : Normal unit cost</span>
  <span class="va">NHUC</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">sigman</span><span class="op">)</span><span class="op">*</span><span class="va">NUC</span> <span class="op">+</span> <span class="va">sigman</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">Rln</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">NUC</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,  <span class="co"># 11.28 : Normal historic unit cost</span>

  <span class="co"># Box 11.4 : Firms equations</span>
  <span class="co"># ---------------------------</span>
  <span class="va">P</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">phi</span><span class="op">)</span><span class="op">*</span><span class="va">NHUC</span>,                 <span class="co"># 11.29 : Normal-cost pricing</span>
  <span class="va">phi</span> <span class="op">~</span> <span class="va">phi</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">eps2</span><span class="op">*</span><span class="op">(</span><span class="va">phit</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">phi</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,  <span class="co"># 11.30 : Actual mark-up --&gt; eps2 not in the book</span>
  <span class="co"># 11.31 : Ideal mark-up</span>
  <span class="co">#phit ~ (FDf + FUft + Rl[-1]*(Lfd[-1] - IN[-1]))/((1 - sigmase)*Ske*UC + (1 + Rl[-1])*sigmase*Ske*UC[-1]),</span>
  <span class="va">phit</span> <span class="op">~</span> <span class="op">(</span><span class="va">FUft</span> <span class="op">+</span> <span class="va">FDf</span> <span class="op">+</span> <span class="va">Rl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="va">Lfd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">IN</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">sigmase</span><span class="op">)</span><span class="op">*</span><span class="va">Ske</span><span class="op">*</span><span class="va">UC</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">Rl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">sigmase</span><span class="op">*</span><span class="va">Ske</span><span class="op">*</span><span class="va">UC</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
  <span class="va">HCe</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">sigmase</span><span class="op">)</span><span class="op">*</span><span class="va">Ske</span><span class="op">*</span><span class="va">UC</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">Rl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">sigmase</span><span class="op">*</span><span class="va">Ske</span><span class="op">*</span><span class="va">UC</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,  <span class="co"># 11.32 : Expected historical costs</span>
  <span class="va">sigmase</span> <span class="op">~</span> <span class="va">INk</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">Ske</span>,              <span class="co"># 11.33 : Opening inventories to expected sales ratio</span>
  <span class="va">Fft</span> <span class="op">~</span> <span class="va">FUft</span> <span class="op">+</span> <span class="va">FDf</span> <span class="op">+</span> <span class="va">Rl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="va">Lfd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">IN</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,  <span class="co"># 11.34 : Planned entrepeneurial profits of firmss</span>
  <span class="va">FUft</span> <span class="op">~</span> <span class="va">psiu</span><span class="op">*</span><span class="va">INV</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,                <span class="co"># 11.35 : Planned retained earnings of firms</span>
  <span class="va">FDf</span> <span class="op">~</span> <span class="va">psid</span><span class="op">*</span><span class="va">Ff</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,                  <span class="co"># 11.36 : Dividends of firms</span>

  <span class="co"># Box 11.5 : Firms equations</span>
  <span class="co"># ---------------------------</span>
  <span class="va">Ff</span> <span class="op">~</span> <span class="va">S</span> <span class="op">-</span> <span class="va">WB</span> <span class="op">+</span> <span class="op">(</span><span class="va">IN</span> <span class="op">-</span> <span class="va">IN</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="va">Rl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">IN</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,  <span class="co"># 11.37 : Realized entrepeneurial profits</span>
  <span class="va">FUf</span> <span class="op">~</span> <span class="va">Ff</span> <span class="op">-</span> <span class="va">FDf</span> <span class="op">-</span> <span class="va">Rl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="va">Lfd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">IN</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="va">Rl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">NPL</span>,  <span class="co"># 11.38 : Retained earnings of firms</span>
  <span class="co"># 11.39 : Demand for loans by firms</span>
  <span class="va">Lfd</span> <span class="op">~</span> <span class="va">Lfd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">INV</span> <span class="op">+</span> <span class="op">(</span><span class="va">IN</span> <span class="op">-</span> <span class="va">IN</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="va">FUf</span> <span class="op">-</span> <span class="op">(</span><span class="va">Eks</span> <span class="op">-</span> <span class="va">Eks</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">Pe</span> <span class="op">-</span> <span class="va">NPL</span>,
  <span class="co"># NPL ~ NPLk*Lfs[-1],                 # 11.40 : Defaulted loans</span>
  <span class="va">NPL</span> <span class="op">~</span> <span class="va">NPLk</span> <span class="op">*</span> <span class="va">Lfs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">Eks</span> <span class="op">~</span> <span class="va">Eks</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">psiu</span><span class="op">)</span><span class="op">*</span><span class="va">INV</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="va">Pe</span>,  <span class="co"># 11.41 : Supply of equities issued by firms</span>
  <span class="co"># Rk ~ FDf/(Pe[-1]*Ekd[-1]),          # 11.42 : Dividend yield of firms</span>
  <span class="va">Rk</span> <span class="op">~</span> <span class="va">FDf</span><span class="op">/</span><span class="op">(</span><span class="va">Pe</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Ekd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
  <span class="va">PE</span> <span class="op">~</span> <span class="va">Pe</span><span class="op">/</span><span class="op">(</span><span class="va">Ff</span><span class="op">/</span><span class="va">Eks</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,               <span class="co"># 11.43 : Price earnings ratio</span>
  <span class="va">Q</span> <span class="op">~</span> <span class="op">(</span><span class="va">Eks</span><span class="op">*</span><span class="va">Pe</span> <span class="op">+</span> <span class="va">Lfd</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">K</span> <span class="op">+</span> <span class="va">IN</span><span class="op">)</span>,        <span class="co"># 11.44 : Tobins Q ratio</span>

  <span class="co"># Box 11.6 : Households equations</span>
  <span class="co"># --------------------------------</span>
  <span class="co"># YP ~ WB + FDf + FDb + Rm[-1]*Md[-1] + Rb[-1]*Bhd[-1] + BLs[-1],  # 11.45 : Personal income</span>
  <span class="va">YP</span> <span class="op">~</span> <span class="va">WB</span> <span class="op">+</span> <span class="va">FDf</span> <span class="op">+</span> <span class="va">FDb</span> <span class="op">+</span> <span class="va">Rm</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">Mh</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">Rb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">Bhd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">BLs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="co">#YP ~ WB + FDf + FDb + Rm[-1]*Mh[-1] + Rb[-1]*Bhd[-1] + BLs[-1] + NL,</span>
  <span class="va">TX</span> <span class="op">~</span> <span class="va">theta</span><span class="op">*</span><span class="va">YP</span>,                       <span class="co"># 11.46 : Income taxes</span>
  <span class="va">YDr</span> <span class="op">~</span> <span class="va">YP</span> <span class="op">-</span> <span class="va">TX</span> <span class="op">-</span> <span class="va">Rl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">Lhd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,      <span class="co"># 11.47 : Regular disposable income</span>
  <span class="va">YDhs</span> <span class="op">~</span> <span class="va">YDr</span> <span class="op">+</span> <span class="va">CG</span>,                    <span class="co"># 11.48 : Haig-Simons disposable income</span>
  <span class="co"># !1.49 : Capital gains</span>
  <span class="va">CG</span> <span class="op">~</span> <span class="op">(</span><span class="va">Pbl</span> <span class="op">-</span> <span class="va">Pbl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">BLd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">Pe</span> <span class="op">-</span> <span class="va">Pe</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">Ekd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">OFb</span> <span class="op">-</span> <span class="va">OFb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
  <span class="co"># 11.50 : Wealth</span>
  <span class="va">V</span> <span class="op">~</span> <span class="va">V</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">YDr</span> <span class="op">-</span> <span class="va">CONS</span> <span class="op">+</span> <span class="op">(</span><span class="va">Pbl</span> <span class="op">-</span> <span class="va">Pbl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">BLd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">Pe</span> <span class="op">-</span> <span class="va">Pe</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">Ekd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">OFb</span> <span class="op">-</span> <span class="va">OFb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
  <span class="va">Vk</span> <span class="op">~</span> <span class="va">V</span><span class="op">/</span><span class="va">P</span>,                           <span class="co"># 11.51 : Real staock of wealth</span>
  <span class="va">CONS</span> <span class="op">~</span> <span class="va">Ck</span><span class="op">*</span><span class="va">P</span>,                        <span class="co"># 11.52 : Consumption</span>
  <span class="va">Ck</span> <span class="op">~</span> <span class="va">alpha1</span><span class="op">*</span><span class="op">(</span><span class="va">YDkre</span> <span class="op">+</span> <span class="va">NLk</span><span class="op">)</span> <span class="op">+</span> <span class="va">alpha2</span><span class="op">*</span><span class="va">Vk</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,  <span class="co"># 11.53 : Real consumption</span>
  <span class="va">YDkre</span> <span class="op">~</span> <span class="va">eps</span><span class="op">*</span><span class="va">YDkr</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">eps</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">YDkr</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">GRpr</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># 11.54 : Expected real regular disposable income</span>
  <span class="co"># YDkr ~ YDr/P - (P - P[-1])*Vk[-1]/P,  # 11.55 : Real regular disposable income</span>
  <span class="va">YDkr</span> <span class="op">~</span> <span class="va">YDr</span><span class="op">/</span><span class="va">P</span> <span class="op">-</span> <span class="op">(</span><span class="op">(</span><span class="va">P</span> <span class="op">-</span> <span class="va">P</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">Vk</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="va">P</span>,

  <span class="co"># Box 11.7 : Households equations</span>
  <span class="co"># --------------------------------</span>
  <span class="va">GL</span> <span class="op">~</span> <span class="va">eta</span><span class="op">*</span><span class="va">YDr</span>,                       <span class="co"># 11.56 : Gross amount of new personal loans ---&gt; new eta here</span>
  <span class="va">eta</span> <span class="op">~</span> <span class="va">eta0</span> <span class="op">-</span> <span class="va">etar</span><span class="op">*</span><span class="va">RRl</span>,              <span class="co"># 11.57 : New loans to personal income ratio</span>
  <span class="va">NL</span> <span class="op">~</span> <span class="va">GL</span> <span class="op">-</span> <span class="va">REP</span>,                      <span class="co"># 11.58 : Net amount of new personal loans</span>
  <span class="va">REP</span> <span class="op">~</span> <span class="va">deltarep</span><span class="op">*</span><span class="va">Lhd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,             <span class="co"># 11.59 : Personal loans repayments</span>
  <span class="va">Lhd</span> <span class="op">~</span> <span class="va">Lhd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">GL</span> <span class="op">-</span> <span class="va">REP</span>,           <span class="co"># 11.60 : Demand for personal loans</span>
  <span class="va">NLk</span> <span class="op">~</span> <span class="va">NL</span><span class="op">/</span><span class="va">P</span>,                         <span class="co"># 11.61 : Real amount of new personal loans</span>
  <span class="co"># BUR ~ (REP + Rl[-1]*Lhd[-1])/YDr[-1],  # 11.62 : Burden of personal debt</span>
  <span class="va">BUR</span> <span class="op">~</span> <span class="op">(</span><span class="va">REP</span> <span class="op">+</span> <span class="va">Rl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Lhd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="va">YDr</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,

  <span class="co"># Box 11.8 : Households equations - portfolio decisions</span>
  <span class="co"># -----------------------------------------------------</span>

  <span class="co"># 11.64 : Demand for bills</span>
  
  <span class="co"># YDr/V</span>
  
  <span class="co">#Md ~ Vfma[-1] * (lambda10 + lambda11*Rm[-1] - lambda12 * Rb[-1] - lambda13 * Rbl[-1] - lambda14 * Rk[-1] + lambda25 * (YP/V)),</span>
  <span class="va">Bhd</span> <span class="op">~</span> <span class="va">Vfma</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="va">lambda20</span> <span class="op">+</span> <span class="va">lambda22</span><span class="op">*</span><span class="va">Rb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">lambda21</span><span class="op">*</span><span class="va">Rm</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">lambda24</span><span class="op">*</span><span class="va">Rk</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">lambda23</span><span class="op">*</span><span class="va">Rbl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">lambda25</span><span class="op">*</span><span class="op">(</span><span class="va">YDr</span><span class="op">/</span><span class="va">V</span><span class="op">)</span><span class="op">)</span>,
  <span class="co"># 11.65 : Demand for bonds</span>
  <span class="va">BLd</span> <span class="op">~</span> <span class="va">Vfma</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="va">lambda30</span> <span class="op">-</span> <span class="va">lambda32</span><span class="op">*</span><span class="va">Rb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">lambda31</span><span class="op">*</span><span class="va">Rm</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">lambda34</span><span class="op">*</span><span class="va">Rk</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">lambda33</span><span class="op">*</span><span class="va">Rbl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">lambda35</span><span class="op">*</span><span class="op">(</span><span class="va">YDr</span><span class="op">/</span><span class="va">V</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">Pbl</span>,
  <span class="co"># 11.66 : Demand for equities - normalized to get the price of equitities</span>
  <span class="va">Pe</span> <span class="op">~</span> <span class="va">Vfma</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="va">lambda40</span> <span class="op">-</span> <span class="va">lambda42</span><span class="op">*</span><span class="va">Rb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">lambda41</span><span class="op">*</span><span class="va">Rm</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">lambda44</span><span class="op">*</span><span class="va">Rk</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">lambda43</span><span class="op">*</span><span class="va">Rbl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">lambda45</span><span class="op">*</span><span class="op">(</span><span class="va">YDr</span><span class="op">/</span><span class="va">V</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">Ekd</span>,
  <span class="va">Mh</span> <span class="op">~</span> <span class="va">Vfma</span> <span class="op">-</span> <span class="va">Bhd</span> <span class="op">-</span> <span class="va">Pe</span><span class="op">*</span><span class="va">Ekd</span> <span class="op">-</span> <span class="va">Pbl</span><span class="op">*</span><span class="va">BLd</span> <span class="op">+</span> <span class="va">Lhd</span>,  <span class="co"># 11.67 : Money deposits - as a residual</span>
  <span class="va">Vfma</span> <span class="op">~</span> <span class="va">V</span> <span class="op">-</span> <span class="va">Hhd</span> <span class="op">-</span> <span class="va">OFb</span>,               <span class="co"># 11.68 : Investible wealth</span>
  <span class="va">VfmaA</span> <span class="op">~</span> <span class="va">Mh</span> <span class="op">+</span> <span class="va">Bhd</span> <span class="op">+</span> <span class="va">Pbl</span> <span class="op">*</span> <span class="va">BLd</span> <span class="op">+</span> <span class="va">Pe</span> <span class="op">*</span> <span class="va">Ekd</span>,
  <span class="va">Hhd</span> <span class="op">~</span> <span class="va">lambdac</span><span class="op">*</span><span class="va">CONS</span>,                 <span class="co"># 11.69 : Households demand for cash</span>
  <span class="va">Ekd</span> <span class="op">~</span> <span class="va">Eks</span>,                          <span class="co"># 11.70 : Stock market equilibrium</span>

  <span class="co"># Box 11.9 : Governments equations</span>
  <span class="co"># ---------------------------------</span>
  <span class="va">G</span> <span class="op">~</span> <span class="va">Gk</span><span class="op">*</span><span class="va">P</span>,                           <span class="co"># 11.71 : Pure government expenditures</span>
  <span class="va">Gk</span> <span class="op">~</span> <span class="va">Gk</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">GRg</span><span class="op">)</span>,              <span class="co"># 11.72 : Real government expenditures</span>
  <span class="va">PSBR</span> <span class="op">~</span> <span class="va">G</span> <span class="op">+</span> <span class="va">BLs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">Rb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="va">Bbs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">Bhs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="va">TX</span>,  <span class="co"># 11.73 : Government deficit --&gt; BLs[-1] missing in the book</span>
  <span class="co"># 11.74 : New issues of bills</span>
  <span class="va">Bs</span> <span class="op">~</span> <span class="va">Bs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">G</span> <span class="op">-</span> <span class="va">TX</span> <span class="op">-</span> <span class="op">(</span><span class="va">BLs</span> <span class="op">-</span> <span class="va">BLs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="va">Pbl</span> <span class="op">+</span> <span class="va">Rb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="va">Bhs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">Bbs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="va">BLs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">GD</span> <span class="op">~</span> <span class="va">Bbs</span> <span class="op">+</span> <span class="va">Bhs</span> <span class="op">+</span> <span class="va">BLs</span><span class="op">*</span><span class="va">Pbl</span> <span class="op">+</span> <span class="va">Hs</span>, <span class="co"># 11.75 : Government debt </span>

  <span class="co"># Box 11.10 : The Central banks equations</span>
  <span class="co"># ----------------------------------------</span>
  <span class="va">Fcb</span> <span class="op">~</span> <span class="va">Rb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">Bcbd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,              <span class="co"># 11.76 : Central bank profits</span>
  <span class="va">BLs</span> <span class="op">~</span> <span class="va">BLd</span>,                          <span class="co"># 11.77 : Bonds are supplied on demand</span>
  <span class="va">Bhs</span> <span class="op">~</span> <span class="va">Bhd</span>,                          <span class="co"># 11.78 : Household bills supplied on demand</span>
  <span class="va">Hhs</span> <span class="op">~</span> <span class="va">Hhd</span>,                          <span class="co"># 11.79 : Cash supplied on demand --&gt; Mistake on the book</span>
  <span class="va">Hbs</span> <span class="op">~</span> <span class="va">Hbd</span>,                          <span class="co"># 11.80 : Reserves supplied on demand</span>
  <span class="va">Hs</span> <span class="op">~</span> <span class="va">Hbs</span> <span class="op">+</span> <span class="va">Hhs</span>,                     <span class="co"># 11.81 : Total supply of cash</span>
  <span class="va">Bcbd</span> <span class="op">~</span> <span class="va">Hs</span>,                          <span class="co"># 11.82 : Central bankd </span>
  <span class="va">Bcbs</span> <span class="op">~</span> <span class="va">Bcbd</span>,                        <span class="co"># 11.83 : Supply of bills to Central bank</span>
  <span class="va">Rb</span> <span class="op">~</span> <span class="va">Rbbar</span>,                         <span class="co"># 11.84 : Interest rate on bills set exogenously</span>
  <span class="va">Rbl</span> <span class="op">~</span> <span class="va">Rb</span> <span class="op">+</span> <span class="va">ADDbl</span>,                   <span class="co"># 11.85 : Long term interest rate</span>
  <span class="va">Pbl</span> <span class="op">~</span> <span class="fl">1</span><span class="op">/</span><span class="va">Rbl</span>,                        <span class="co"># 11.86 : Price of long-term bonds</span>

  <span class="co"># Box 11.11 : Commercial Banks equations</span>
  <span class="co"># ---------------------------------------</span>
  <span class="va">Ms</span> <span class="op">~</span> <span class="va">Mh</span>,                            <span class="co"># 11.87 : Bank deposits supplied on demand</span>
  <span class="va">Lfs</span> <span class="op">~</span> <span class="va">Lfd</span>,                          <span class="co"># 11.88 : Loans to firms supplied on demand</span>
  <span class="va">Lhs</span> <span class="op">~</span> <span class="va">Lhd</span>,                          <span class="co"># 11.89 : Personal loans supplied on demand</span>
  <span class="va">Hbd</span> <span class="op">~</span> <span class="va">ro</span><span class="op">*</span><span class="va">Ms</span>,                        <span class="co"># 11.90 Reserve requirements of banks</span>
  <span class="co"># 11.91 : Bills supplied to banks</span>
  <span class="va">Bbs</span> <span class="op">~</span> <span class="va">Bbs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">Bs</span> <span class="op">-</span> <span class="va">Bs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">Bhs</span> <span class="op">-</span> <span class="va">Bhs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">Bcbs</span> <span class="op">-</span> <span class="va">Bcbs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
  <span class="co"># 11.92 : Balance sheet constraint of banks</span>
  <span class="va">Bbd</span> <span class="op">~</span> <span class="va">Ms</span> <span class="op">+</span> <span class="va">OFb</span> <span class="op">-</span> <span class="va">Lfs</span> <span class="op">-</span> <span class="va">Lhs</span> <span class="op">-</span> <span class="va">Hbd</span>, 
  <span class="va">BLR</span> <span class="op">~</span> <span class="va">Bbd</span><span class="op">/</span><span class="va">Ms</span>,                       <span class="co"># 11.93 : Bank liquidity ratio</span>
  <span class="co"># 11.94 : Deposit interest rate</span>
  <span class="va">Rm</span> <span class="op">~</span> <span class="va">Rm</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">z1a</span><span class="op">*</span><span class="va">xim1</span> <span class="op">+</span> <span class="va">z1b</span><span class="op">*</span><span class="va">xim2</span> <span class="op">-</span> <span class="va">z2a</span><span class="op">*</span><span class="va">xim1</span> <span class="op">-</span> <span class="va">z2b</span><span class="op">*</span><span class="va">xim2</span>,
  <span class="co"># 11.95-97 : Mechanism for determining changes to the interest rate on deposits</span>
  <span class="va">z2a</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="va">BLR</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">&gt;</span> <span class="op">(</span><span class="va">top</span> <span class="op">+</span> <span class="fl">.05</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="fl">0</span><span class="op">}</span>,
  <span class="va">z2b</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="va">BLR</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">&gt;</span> <span class="va">top</span><span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="fl">0</span><span class="op">}</span>,
  <span class="va">z1a</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="va">BLR</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">bot</span><span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="fl">0</span><span class="op">}</span>,
  <span class="va">z1b</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="va">BLR</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="op">(</span><span class="va">bot</span> <span class="op">-</span><span class="fl">.05</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="fl">0</span><span class="op">}</span>,

  <span class="co"># Box 11.12 : Commercial banks equations</span>
  <span class="co"># ---------------------------------------</span>
  <span class="va">Rl</span> <span class="op">~</span> <span class="va">Rm</span> <span class="op">+</span> <span class="va">ADDl</span>,                     <span class="co"># 11.98 : Loan interest rate</span>
  <span class="va">OFbt</span> <span class="op">~</span> <span class="va">NCAR</span><span class="op">*</span><span class="op">(</span><span class="va">Lfs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">Lhs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,    <span class="co"># 11.99 : Long-run own funds target</span>
  <span class="va">OFbe</span> <span class="op">~</span> <span class="va">OFb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">betab</span><span class="op">*</span><span class="op">(</span><span class="va">OFbt</span> <span class="op">-</span> <span class="va">OFb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,  <span class="co"># 11.100 : Short-run own funds target</span>
  <span class="va">FUbt</span> <span class="op">~</span> <span class="va">OFbe</span> <span class="op">-</span> <span class="va">OFb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">NPLke</span><span class="op">*</span><span class="va">Lfs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,  <span class="co"># 11.101 : Target retained earnings of banks</span>
  <span class="va">NPLke</span> <span class="op">~</span> <span class="va">epsb</span><span class="op">*</span><span class="va">NPLke</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">epsb</span><span class="op">)</span><span class="op">*</span><span class="va">NPLk</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,  <span class="co"># 11.102 : Expected proportion of non-performaing loans</span>
  <span class="co"># FDb ~ Fb - FUb,                     # 11.103 : Dividends of banks</span>
  <span class="va">FDb</span> <span class="op">~</span> <span class="va">Fb</span> <span class="op">-</span> <span class="va">FUb</span>,
  <span class="va">Fbt</span> <span class="op">~</span> <span class="va">lambdab</span><span class="op">*</span><span class="va">Y</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">OFbe</span> <span class="op">-</span> <span class="va">OFb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">NPLke</span><span class="op">*</span><span class="va">Lfs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,  <span class="co"># 11.104 : Target profits of banks</span>
  <span class="co"># 11.105 : Actual profits of banks</span>
  <span class="va">Fb</span> <span class="op">~</span> <span class="va">Rl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="va">Lfs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">Lhs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">NPL</span><span class="op">)</span> <span class="op">+</span> <span class="va">Rb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">Bbd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">Rm</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">Ms</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="co"># 11.106 : Lending mark-up over deposit rate</span>
  <span class="va">ADDl</span> <span class="op">~</span> <span class="op">(</span><span class="va">Fbt</span> <span class="op">-</span> <span class="va">Rb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">Bbd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">Rm</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="va">Ms</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">NPLke</span><span class="op">)</span><span class="op">*</span><span class="va">Lfs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">Lhs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">NPLke</span><span class="op">)</span><span class="op">*</span><span class="va">Lfs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">Lhs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="co"># --&gt; I added the lag term to Rm</span>
  <span class="va">FUb</span> <span class="op">~</span> <span class="va">Fb</span> <span class="op">-</span> <span class="va">lambdab</span><span class="op">*</span><span class="va">Y</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,           <span class="co"># 11.107 : Actual retained earnings</span>
  <span class="va">OFb</span> <span class="op">~</span> <span class="va">OFb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">FUb</span> <span class="op">-</span> <span class="va">NPL</span>,          <span class="co"># 11.108 : Own funds of banks</span>
  <span class="va">CAR</span> <span class="op">~</span> <span class="va">OFb</span><span class="op">/</span><span class="op">(</span><span class="va">Lfs</span> <span class="op">+</span> <span class="va">Lhs</span><span class="op">)</span>,
  
  <span class="va">Vf</span> <span class="op">~</span> <span class="va">IN</span> <span class="op">+</span> <span class="va">K</span> <span class="op">-</span> <span class="va">Lfd</span> <span class="op">-</span> <span class="va">Ekd</span> <span class="op">*</span> <span class="va">Pe</span>,       <span class="co"># Firm's wealth (memo for matrices)</span>
  <span class="co">#Vg ~ -Bs - BLs * Pbl,\</span>
  <span class="va">Ls</span> <span class="op">~</span> <span class="va">Lfs</span> <span class="op">+</span> <span class="va">Lhs</span>,                     <span class="co"># Loans supply (memo for matrices)</span>
  
  <span class="op">)</span>

<span class="va">growth_parameters</span> <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">alpha1</span> <span class="op">~</span> <span class="fl">0.75</span>,
  <span class="va">alpha2</span> <span class="op">~</span> <span class="fl">0.064</span>,
  <span class="va">beta</span> <span class="op">~</span> <span class="fl">0.5</span>,
  <span class="va">betab</span> <span class="op">~</span> <span class="fl">0.4</span>,
  <span class="va">gamma</span> <span class="op">~</span> <span class="fl">0.15</span>,
  <span class="va">gamma0</span> <span class="op">~</span> <span class="fl">0.00122</span>,
  <span class="va">gammar</span> <span class="op">~</span> <span class="fl">0.1</span>,
  <span class="va">gammau</span> <span class="op">~</span> <span class="fl">0.05</span>,
  <span class="va">delta</span> <span class="op">~</span> <span class="fl">0.10667</span>,
  <span class="va">deltarep</span> <span class="op">~</span> <span class="fl">0.1</span>,
  <span class="va">eps</span> <span class="op">~</span> <span class="fl">0.5</span>,
  <span class="va">eps2</span> <span class="op">~</span> <span class="fl">0.8</span>,
  <span class="va">epsb</span> <span class="op">~</span> <span class="fl">0.25</span>,
  <span class="va">epsrb</span> <span class="op">~</span> <span class="fl">0.9</span>,
  <span class="va">eta0</span> <span class="op">~</span> <span class="fl">0.07416</span>,
  <span class="va">etan</span> <span class="op">~</span> <span class="fl">0.6</span>,
  <span class="va">etar</span> <span class="op">~</span> <span class="fl">0.4</span>,
  <span class="va">theta</span> <span class="op">~</span> <span class="fl">0.22844</span>,
  <span class="co"># lambda10 ~ -0.17071,</span>
  <span class="co"># lambda11 ~ 0,</span>
  <span class="co"># lambda12 ~ 0,</span>
  <span class="co"># lambda13 ~ 0,</span>
  <span class="co"># lambda14 ~ 0,</span>
  <span class="co"># lambda15 ~ 0.18,</span>
  <span class="va">lambda20</span> <span class="op">~</span> <span class="fl">0.25</span>,
  <span class="va">lambda21</span> <span class="op">~</span> <span class="fl">2.2</span>,
  <span class="va">lambda22</span> <span class="op">~</span> <span class="fl">6.6</span>,
  <span class="va">lambda23</span> <span class="op">~</span> <span class="fl">2.2</span>,
  <span class="va">lambda24</span> <span class="op">~</span> <span class="fl">2.2</span>,
  <span class="va">lambda25</span> <span class="op">~</span> <span class="fl">0.1</span>,
  <span class="va">lambda30</span> <span class="op">~</span> <span class="op">-</span><span class="fl">0.04341</span>,
  <span class="va">lambda31</span> <span class="op">~</span> <span class="fl">2.2</span>,
  <span class="va">lambda32</span> <span class="op">~</span> <span class="fl">2.2</span>,
  <span class="va">lambda33</span> <span class="op">~</span> <span class="fl">6.6</span>,
  <span class="va">lambda34</span> <span class="op">~</span> <span class="fl">2.2</span>,
  <span class="va">lambda35</span> <span class="op">~</span> <span class="fl">0.1</span>,
  <span class="va">lambda40</span> <span class="op">~</span> <span class="fl">0.67132</span>,
  <span class="va">lambda41</span> <span class="op">~</span> <span class="fl">2.2</span>,
  <span class="va">lambda42</span> <span class="op">~</span> <span class="fl">2.2</span>,
  <span class="va">lambda43</span> <span class="op">~</span> <span class="fl">2.2</span>,
  <span class="va">lambda44</span> <span class="op">~</span> <span class="fl">6.6</span>,
  <span class="va">lambda45</span> <span class="op">~</span> <span class="fl">0.1</span>,
  <span class="va">lambdab</span> <span class="op">~</span> <span class="fl">0.0153</span>,
  <span class="va">lambdac</span> <span class="op">~</span> <span class="fl">0.05</span>,
  <span class="va">xim1</span> <span class="op">~</span> <span class="fl">0.0008</span>,
  <span class="va">xim2</span> <span class="op">~</span> <span class="fl">0.0007</span>,
  <span class="va">ro</span> <span class="op">~</span> <span class="fl">0.05</span>,
  <span class="va">sigman</span> <span class="op">~</span> <span class="fl">0.1666</span>,
  <span class="va">sigmat</span> <span class="op">~</span> <span class="fl">0.2</span>,
  <span class="va">psid</span> <span class="op">~</span> <span class="fl">0.15255</span>,
  <span class="va">psiu</span> <span class="op">~</span> <span class="fl">0.92</span>,
  <span class="va">omega0</span> <span class="op">~</span> <span class="op">-</span><span class="fl">0.20594</span>,
  <span class="va">omega1</span> <span class="op">~</span> <span class="fl">1</span>,
  <span class="va">omega2</span> <span class="op">~</span> <span class="fl">2</span>,
  <span class="va">omega3</span> <span class="op">~</span> <span class="fl">0.45621</span>,
  
  <span class="co"># Exogenous</span>
  
  <span class="va">ADDbl</span> <span class="op">~</span> <span class="fl">0.02</span>,
  <span class="va">BANDt</span> <span class="op">~</span> <span class="fl">0.01</span>,
  <span class="va">BANDb</span> <span class="op">~</span> <span class="fl">0.01</span>,
  <span class="va">bot</span> <span class="op">~</span> <span class="fl">0.05</span>,
  <span class="va">GRg</span> <span class="op">~</span> <span class="fl">0.03</span>,
  <span class="va">GRpr</span> <span class="op">~</span> <span class="fl">0.03</span>,
  <span class="va">Nfe</span> <span class="op">~</span> <span class="fl">87.181</span>,
  <span class="va">NCAR</span> <span class="op">~</span> <span class="fl">0.1</span>,
  <span class="va">NPLk</span> <span class="op">~</span> <span class="fl">0.02</span>,
  <span class="va">Rbbar</span> <span class="op">~</span> <span class="fl">0.035</span>,
  <span class="va">Rln</span> <span class="op">~</span> <span class="fl">0.07</span>,
  <span class="va">RA</span> <span class="op">~</span> <span class="fl">0</span>,
  <span class="va">top</span> <span class="op">~</span> <span class="fl">0.12</span>,
  
  <span class="co"># sigmase ~ 0.16667,</span>
  <span class="co"># eta ~ 0.04918,</span>
  <span class="co"># phi ~ 0.26417,</span>
  <span class="co"># phit ~ 0.26417,</span>
  
  <span class="op">)</span>


<span class="va">growth_initial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">sigmase</span> <span class="op">~</span> <span class="fl">0.16667</span>,
  <span class="va">eta</span> <span class="op">~</span> <span class="fl">0.04918</span>,
  <span class="va">phi</span> <span class="op">~</span> <span class="fl">0.26417</span>,
  <span class="va">phit</span> <span class="op">~</span> <span class="fl">0.26417</span>,
  
  <span class="va">ADDbl</span> <span class="op">~</span> <span class="fl">0.02</span>,
  <span class="va">BANDt</span> <span class="op">~</span> <span class="fl">0.01</span>,
  <span class="va">BANDb</span> <span class="op">~</span> <span class="fl">0.01</span>,
  <span class="va">bot</span> <span class="op">~</span> <span class="fl">0.05</span>,
  <span class="va">GRg</span> <span class="op">~</span> <span class="fl">0.03</span>,
  <span class="va">GRpr</span> <span class="op">~</span> <span class="fl">0.03</span>,
  <span class="va">Nfe</span> <span class="op">~</span> <span class="fl">87.181</span>,
  <span class="va">NCAR</span> <span class="op">~</span> <span class="fl">0.1</span>,
  <span class="va">NPLk</span> <span class="op">~</span> <span class="fl">0.02</span>,
  <span class="va">Rbbar</span> <span class="op">~</span> <span class="fl">0.035</span>,
  <span class="va">Rln</span> <span class="op">~</span> <span class="fl">0.07</span>,
  <span class="va">RA</span> <span class="op">~</span> <span class="fl">0</span>,
  <span class="va">top</span> <span class="op">~</span> <span class="fl">0.12</span>,
  
  
  <span class="va">ADDl</span> <span class="op">~</span> <span class="fl">0.04592</span>,
  <span class="va">BLR</span> <span class="op">~</span> <span class="fl">0.1091</span>,
  <span class="va">BUR</span> <span class="op">~</span> <span class="fl">0.06324</span>,
  <span class="va">Ck</span> <span class="op">~</span> <span class="fl">7334240</span>,
  <span class="va">CAR</span> <span class="op">~</span> <span class="fl">0.09245</span>,
  <span class="va">CONS</span> <span class="op">~</span> <span class="fl">52603100</span>,
  <span class="va">ER</span> <span class="op">~</span> <span class="fl">1</span>,
  <span class="va">Fb</span> <span class="op">~</span> <span class="fl">1744130</span>,
  <span class="va">Fbt</span> <span class="op">~</span> <span class="fl">1744140</span>,
  <span class="va">Ff</span> <span class="op">~</span> <span class="fl">18081100</span>,
  <span class="va">Fft</span> <span class="op">~</span> <span class="fl">18013600</span>,
  <span class="va">FDb</span> <span class="op">~</span> <span class="fl">1325090</span>,
  <span class="va">FDf</span> <span class="op">~</span> <span class="fl">2670970</span>,
  <span class="va">FUb</span> <span class="op">~</span> <span class="fl">419039</span>,
  <span class="va">FUf</span> <span class="op">~</span> <span class="fl">15153800</span>,
  <span class="va">FUft</span> <span class="op">~</span> <span class="fl">15066200</span>,
  <span class="va">G</span> <span class="op">~</span> <span class="fl">16755600</span>,
  <span class="va">Gk</span> <span class="op">~</span> <span class="fl">2336160</span>,
  <span class="va">GL</span> <span class="op">~</span> <span class="fl">2775900</span>,
  <span class="va">GRk</span> <span class="op">~</span> <span class="fl">0.03001</span>,
  <span class="va">INV</span> <span class="op">~</span> <span class="fl">16911600</span>,
  <span class="va">Ik</span> <span class="op">~</span> <span class="fl">2357910</span>,
  <span class="va">N</span> <span class="op">~</span> <span class="fl">87.181</span>,
  <span class="va">Nt</span> <span class="op">~</span> <span class="fl">87.181</span>,
  <span class="va">NHUC</span> <span class="op">~</span> <span class="fl">5.6735</span>,
  <span class="va">NL</span> <span class="op">~</span> <span class="fl">683593</span>,
  <span class="va">NLk</span> <span class="op">~</span> <span class="fl">95311</span>,
  <span class="va">NPL</span> <span class="op">~</span> <span class="fl">309158</span>,
  <span class="va">NPLke</span> <span class="op">~</span> <span class="fl">0.02</span>,
  <span class="va">NUC</span> <span class="op">~</span> <span class="fl">5.6106</span>,
  <span class="va">omegat</span> <span class="op">~</span> <span class="fl">112852</span>,
  <span class="va">P</span> <span class="op">~</span> <span class="fl">7.1723</span>,
  <span class="va">Pbl</span> <span class="op">~</span> <span class="fl">18.182</span>,
  <span class="va">Pe</span> <span class="op">~</span> <span class="fl">17937</span>,
  <span class="va">PE</span> <span class="op">~</span> <span class="fl">5.07185</span>,
  <span class="va">PI</span> <span class="op">~</span> <span class="fl">0.0026</span>,
  <span class="va">PR</span> <span class="op">~</span> <span class="fl">138659</span>,
  <span class="va">PSBR</span> <span class="op">~</span> <span class="fl">1894780</span>,
  <span class="va">Q</span> <span class="op">~</span> <span class="fl">0.77443</span>,
  <span class="va">Rb</span> <span class="op">~</span> <span class="fl">0.035</span>,
  <span class="va">Rbl</span> <span class="op">~</span> <span class="fl">0.055</span>,
  <span class="va">Rk</span> <span class="op">~</span> <span class="fl">0.03008</span>,
  <span class="va">Rl</span> <span class="op">~</span> <span class="fl">0.06522</span>,
  <span class="va">Rm</span> <span class="op">~</span> <span class="fl">0.0193</span>,
  <span class="va">REP</span> <span class="op">~</span> <span class="fl">2092310</span>,
  <span class="co">#RRb ~ 0.03232,</span>
  <span class="va">RRl</span> <span class="op">~</span> <span class="fl">0.06246</span>,
  <span class="va">S</span> <span class="op">~</span> <span class="fl">86270300</span>,
  <span class="va">Sk</span> <span class="op">~</span> <span class="fl">12028300</span>,
  <span class="va">Ske</span> <span class="op">~</span> <span class="fl">12028300</span>,
  <span class="va">TX</span> <span class="op">~</span> <span class="fl">17024100</span>,
  <span class="va">U</span> <span class="op">~</span> <span class="fl">0.70073</span>,
  <span class="va">UC</span> <span class="op">~</span> <span class="fl">5.6106</span>,
  <span class="va">W</span> <span class="op">~</span> <span class="fl">777968</span>,
  <span class="va">WB</span> <span class="op">~</span> <span class="fl">67824000</span>,
  <span class="va">Y</span> <span class="op">~</span> <span class="fl">86607700</span>,
  <span class="va">Yk</span> <span class="op">~</span> <span class="fl">12088400</span>,
  <span class="va">YDr</span> <span class="op">~</span> <span class="fl">56446400</span>,
  <span class="va">YDkr</span> <span class="op">~</span> <span class="fl">7813270</span>,
  <span class="va">YDkre</span> <span class="op">~</span> <span class="fl">7813290</span>,
  <span class="va">YP</span> <span class="op">~</span> <span class="fl">73158700</span>,
  <span class="va">z1a</span> <span class="op">~</span> <span class="fl">0</span>,
  <span class="va">z1b</span> <span class="op">~</span> <span class="fl">0</span>,
  <span class="va">z2a</span> <span class="op">~</span> <span class="fl">0</span>,
  <span class="va">z2b</span> <span class="op">~</span> <span class="fl">0</span>,
  
  <span class="co">##</span>
  
  <span class="co">#Bbd ~ 4388930,</span>
  <span class="co">#Bbs ~ 4388930,</span>
  <span class="va">Bbd</span> <span class="op">~</span> <span class="fl">4389790</span>,
  <span class="va">Bbs</span> <span class="op">~</span> <span class="fl">4389790</span>,
  <span class="va">Bcbd</span> <span class="op">~</span> <span class="fl">4655690</span>,
  <span class="va">Bcbs</span> <span class="op">~</span> <span class="fl">4655690</span>,
  <span class="va">Bhd</span> <span class="op">~</span> <span class="fl">33439320</span>,
  <span class="va">Bhs</span> <span class="op">~</span> <span class="fl">33439320</span>,
  <span class="co">#Bhd ~ 33396900,</span>
  <span class="co">#Bhs ~ 33396900,</span>
  <span class="va">Bs</span> <span class="op">~</span> <span class="fl">42484800</span>,
  <span class="co">#Bs ~ 42441520,</span>
  <span class="va">BLd</span> <span class="op">~</span> <span class="fl">840742</span>,
  <span class="va">BLs</span> <span class="op">~</span> <span class="fl">840742</span>,
  <span class="va">GD</span> <span class="op">~</span> <span class="fl">57728700</span>,
  <span class="va">Ekd</span> <span class="op">~</span> <span class="fl">5112.6001</span>,
  <span class="va">Eks</span> <span class="op">~</span> <span class="fl">5112.6001</span>,
  <span class="va">Hbd</span> <span class="op">~</span> <span class="fl">2025540</span>,
  <span class="va">Hbs</span> <span class="op">~</span> <span class="fl">2025540</span>,
  <span class="va">Hhd</span> <span class="op">~</span> <span class="fl">2630150</span>,
  <span class="va">Hhs</span> <span class="op">~</span> <span class="fl">2630150</span>,
  <span class="va">Hs</span> <span class="op">~</span> <span class="fl">4655690</span>,
  <span class="va">IN</span> <span class="op">~</span> <span class="fl">11585400</span>,
  <span class="va">INk</span> <span class="op">~</span> <span class="fl">2064890</span>,
  <span class="va">INke</span> <span class="op">~</span> <span class="fl">2405660</span>,
  <span class="va">INkt</span> <span class="op">~</span> <span class="fl">2064890</span>,
  <span class="co">#K ~ 127444000,</span>
  <span class="va">K</span> <span class="op">~</span> <span class="fl">127486471</span>,
  <span class="co">#Kk ~ 17768900,</span>
  <span class="va">Kk</span> <span class="op">~</span> <span class="fl">17774838</span>,
  <span class="va">Lfd</span> <span class="op">~</span> <span class="fl">15962900</span>,
  <span class="va">Lfs</span> <span class="op">~</span> <span class="fl">15962900</span>,
  <span class="va">Lhd</span> <span class="op">~</span> <span class="fl">21606600</span>,
  <span class="va">Lhs</span> <span class="op">~</span> <span class="fl">21606600</span>,
  <span class="va">Ls</span> <span class="op">~</span> <span class="fl">37569500</span>,
  <span class="co">#Md ~ 40510800,</span>
  <span class="va">Mh</span> <span class="op">~</span> <span class="fl">40510800</span>,
  <span class="va">Ms</span> <span class="op">~</span> <span class="fl">40510800</span>,
  <span class="va">OFb</span> <span class="op">~</span> <span class="fl">3474030</span>,
  <span class="va">OFbe</span> <span class="op">~</span> <span class="fl">3474030</span>,
  <span class="co">#OFb ~ 3473280,</span>
  <span class="co">#OFbe ~ 3782430,</span>
  <span class="va">OFbt</span> <span class="op">~</span> <span class="fl">3638100</span>,
  <span class="co">#V ~ 165395000,</span>
  <span class="va">V</span> <span class="op">~</span> <span class="fl">165438779</span>,
  <span class="co">#Vfma ~ 159291000,</span>
  <span class="va">Vfma</span> <span class="op">~</span> <span class="fl">159334599</span>,
  <span class="va">Vk</span> <span class="op">~</span> <span class="fl">23066350</span>,
  <span class="va">Vf</span> <span class="op">~</span> <span class="fl">31361792</span>
  
  <span class="op">)</span></code></pre></div>
</div>
<div id="model-growth-baseline" class="section level1">
<h1 class="hasAnchor">
<a href="#model-growth-baseline" class="anchor"></a>Model GROWTH: Baseline</h1>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">growth</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span>
  equations <span class="op">=</span> <span class="va">growth_eqs</span>,
  external <span class="op">=</span> <span class="va">growth_parameters</span>,
  initial <span class="op">=</span> <span class="va">growth_initial</span>,
  periods <span class="op">=</span> <span class="fl">350</span>,
  method <span class="op">=</span> <span class="st">"Broyden"</span>,
  hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bbs"</span> <span class="op">=</span> <span class="st">"Bbd"</span><span class="op">)</span>,
  tol <span class="op">=</span> <span class="fl">1e-15</span>,
  max_iter <span class="op">=</span> <span class="fl">350</span>,
  rhtol <span class="op">=</span> <span class="cn">TRUE</span>,
  .hidden_tol <span class="op">=</span> <span class="fl">1e-6</span>
<span class="op">)</span></code></pre></div>
<div id="the-hidden-equation-is-it-fulfilled" class="section level2">
<h2 class="hasAnchor">
<a href="#the-hidden-equation-is-it-fulfilled" class="anchor"></a>The hidden equation: is it fulfilled?</h2>
<p>In this model we can observe an interesting development: the hidden equation <em>is not</em> exactly fulfilled. In fact, the discrepancy between <code>Bbs</code> and <code>Bbd</code> is quite insignificant in the first period, but this discrepancy increases together with the stocks of the model. Therefore, we must set <code>rhtol</code> to <code>TRUE</code> in order to check that discrepancy between the two series as a share of the first series is always smaller than the <code>.hidden_tol</code> value.</p>
<p>To see if the model arrived to a stable steady state, let’s plot some key ratios and variables. As always, we first create a helper function to simplify the plotting procedure:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">do_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span>, <span class="va">variables</span>, <span class="va">plot</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">m1</span> <span class="op">&lt;-</span> <span class="va">model</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>
      uk <span class="op">=</span> <span class="va">Y</span> <span class="op">/</span> <span class="va">K</span>,
      Bsk <span class="op">=</span> <span class="va">Bs</span> <span class="op">/</span> <span class="va">K</span>,
      VK <span class="op">=</span> <span class="va">V</span> <span class="op">/</span> <span class="va">K</span>,
      wi <span class="op">=</span> <span class="op">(</span><span class="va">W</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">W</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">W</span><span class="op">)</span>,
      DefY <span class="op">=</span> <span class="va">PSBR</span><span class="op">/</span><span class="va">Y</span>,
      GDY <span class="op">=</span> <span class="va">GD</span><span class="op">/</span><span class="va">Y</span>,
      LIN <span class="op">=</span> <span class="va">Lfd</span> <span class="op">/</span> <span class="va">IN</span>,
      GRy <span class="op">=</span> <span class="op">(</span><span class="va">Yk</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">Yk</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,
      LhYDr <span class="op">=</span> <span class="va">Lhd</span> <span class="op">/</span> <span class="va">YDr</span>,
      FUfInv <span class="op">=</span> <span class="va">FUf</span> <span class="op">/</span> <span class="va">INV</span>,
      EqFMA <span class="op">=</span> <span class="op">(</span><span class="va">Pe</span> <span class="op">*</span> <span class="va">Ekd</span><span class="op">)</span> <span class="op">/</span> <span class="va">Vfma</span>,
      GRFfk <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="va">Ff</span> <span class="op">/</span> <span class="va">P</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">Ff</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span><span class="op">)</span>,
      GRPek <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="va">Pe</span> <span class="op">/</span> <span class="va">P</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">Pe</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">P</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">period</span><span class="op">)</span><span class="op">)</span>
  
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">m1</span>, <span class="va">name</span> <span class="op">%in%</span> <span class="va">variables</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="kw">else</span> <span class="op">{</span>
    <span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">m1</span>, <span class="va">name</span> <span class="op">%in%</span> <span class="va">plot</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="va">m2</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="steady-state" class="section level2">
<h2 class="hasAnchor">
<a href="#steady-state" class="anchor"></a>Steady state</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">growth</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Uk"</span>, <span class="st">"Bsk"</span>, <span class="st">"VK"</span>, <span class="st">'GRk'</span>, <span class="st">"PI"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>As we can see, the hidden equation is fulfilled (up to certain amount of computational error), key ratios and growth rations are stable. We can now check the balance-sheet and the transactions-flow matrices:</p>
</div>
<div id="matrices-of-model-growth" class="section level2">
<h2 class="hasAnchor">
<a href="#matrices-of-model-growth" class="anchor"></a>Matrices of model GROWTH</h2>
<div id="balance-sheet-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#balance-sheet-matrix" class="anchor"></a>Balance-sheet matrix</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bs_growth</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_matrix.html">sfcr_matrix</a></span><span class="op">(</span>
  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Households"</span>, <span class="st">"Firms"</span>, <span class="st">"Govt"</span>, <span class="st">"Central Bank"</span>, <span class="st">"Banks"</span>, <span class="st">"Sum"</span><span class="op">)</span>,
  codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"h"</span>, <span class="st">"f"</span>, <span class="st">"g"</span>, <span class="st">"cb"</span>, <span class="st">"b"</span>, <span class="st">"s"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Inventories"</span>, f <span class="op">=</span> <span class="st">"+IN"</span>, s <span class="op">=</span> <span class="st">"+IN"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Fixed Capital"</span>, f <span class="op">=</span> <span class="st">"+K"</span>, s <span class="op">=</span> <span class="st">"+K"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HPM"</span>, h <span class="op">=</span> <span class="st">"+Hhd"</span>, cb <span class="op">=</span> <span class="st">"-Hs"</span>, b <span class="op">=</span> <span class="st">"+Hbd"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Money"</span>, h <span class="op">=</span> <span class="st">"+Mh"</span>, b <span class="op">=</span> <span class="st">"-Ms"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bills"</span>, h <span class="op">=</span> <span class="st">"+Bhd"</span>, g <span class="op">=</span> <span class="st">"-Bs"</span>, cb <span class="op">=</span> <span class="st">"+Bcbd"</span>, b <span class="op">=</span> <span class="st">"+Bbd"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bonds"</span>, h <span class="op">=</span> <span class="st">"+BLd * Pbl"</span>, g <span class="op">=</span> <span class="st">"-BLs * Pbl"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Loans"</span>, h <span class="op">=</span> <span class="st">"-Lhd"</span>, f <span class="op">=</span> <span class="st">"-Lfd"</span>, b <span class="op">=</span> <span class="st">"+Ls"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Equities"</span>, h <span class="op">=</span> <span class="st">"+Ekd * Pe"</span>, f <span class="op">=</span> <span class="st">"-Eks * Pe"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bank capital"</span>, h <span class="op">=</span> <span class="st">"+OFb"</span>, b <span class="op">=</span> <span class="st">"-OFb"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Balance"</span>, h <span class="op">=</span> <span class="st">"-V"</span>, f <span class="op">=</span> <span class="st">"-Vf"</span>, g <span class="op">=</span> <span class="st">"GD"</span>, s <span class="op">=</span> <span class="st">"-(IN + K)"</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="../../reference/sfcr_matrix_display.html">sfcr_matrix_display</a></span><span class="op">(</span><span class="va">bs_growth</span>, which <span class="op">=</span> <span class="st">"bs"</span><span class="op">)</span></code></pre></div>
<table class="table table table-striped table-hover">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Households
</th>
<th style="text-align:left;">
Firms
</th>
<th style="text-align:left;">
Govt
</th>
<th style="text-align:left;">
Central Bank
</th>
<th style="text-align:left;">
Banks
</th>
<th style="text-align:left;">
<span class="math inline">\(\sum\)</span>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Inventories
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+IN\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+IN\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Fixed Capital
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+K\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+K\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
HPM
</td>
<td style="text-align:left;">
<span class="math inline">\(+Hhd\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-Hs\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(+Hbd\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Money
</td>
<td style="text-align:left;">
<span class="math inline">\(+Mh\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-Ms\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Bills
</td>
<td style="text-align:left;">
<span class="math inline">\(+Bhd\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-Bs\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(+Bcbd\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(+Bbd\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Bonds
</td>
<td style="text-align:left;">
<span class="math inline">\(+BLd\cdot Pbl\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-BLs\cdot Pbl\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Loans
</td>
<td style="text-align:left;">
<span class="math inline">\(-Lhd\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-Lfd\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+Ls\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Equities
</td>
<td style="text-align:left;">
<span class="math inline">\(+Ekd\cdot Pe\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-Eks\cdot Pe\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Bank capital
</td>
<td style="text-align:left;">
<span class="math inline">\(+OFb\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-OFb\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Balance
</td>
<td style="text-align:left;">
<span class="math inline">\(-V\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-Vf\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(GD\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-(IN+K)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sum\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
</tbody>
</table>
<p>Next we validate the model with the data:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_validate.html">sfcr_validate</a></span><span class="op">(</span><span class="va">bs_growth</span>, <span class="va">growth</span>, <span class="st">"bs"</span>, rtol <span class="op">=</span> <span class="cn">TRUE</span>, tol <span class="op">=</span> <span class="fl">1e-8</span><span class="op">)</span>
<span class="co">#&gt; Water tight! The balance-sheet matrix is consistent with the simulated model.</span></code></pre></div>
</div>
<div id="transactions-flow-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#transactions-flow-matrix" class="anchor"></a>Transactions-flow matrix</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tfm_growth</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_matrix.html">sfcr_matrix</a></span><span class="op">(</span>
  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Households"</span>, <span class="st">"Firms curr."</span>, <span class="st">"Firms cap."</span>, <span class="st">"Govt."</span>, <span class="st">"CB curr."</span>, <span class="st">"CB cap."</span>, <span class="st">"Banks curr."</span>, <span class="st">"Banks cap."</span><span class="op">)</span>,
  code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"h"</span>, <span class="st">"fc"</span>, <span class="st">"fk"</span>, <span class="st">"g"</span>, <span class="st">"cbc"</span>, <span class="st">"cbk"</span>, <span class="st">"bc"</span>, <span class="st">"bk"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Consumption"</span>, h <span class="op">=</span> <span class="st">'-CONS'</span>, fc <span class="op">=</span> <span class="st">"+CONS"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Govt. Exp."</span>, fc <span class="op">=</span> <span class="st">"+G"</span>, g <span class="op">=</span> <span class="st">"-G"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Investment"</span>, fc <span class="op">=</span> <span class="st">"+INV"</span>, fk <span class="op">=</span> <span class="st">"-INV"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Inventories"</span>, fc <span class="op">=</span> <span class="st">"+(IN - IN[-1])"</span>, fk <span class="op">=</span> <span class="st">"-(IN - IN[-1])"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxes"</span>, h <span class="op">=</span> <span class="st">"-TX"</span>, g <span class="op">=</span> <span class="st">"+TX"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Wages"</span>, h <span class="op">=</span> <span class="st">"+WB"</span>, fc <span class="op">=</span> <span class="st">"-WB"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Inventory financing cost"</span>, fc <span class="op">=</span> <span class="st">"-Rl[-1] * IN[-1]"</span>, bc <span class="op">=</span> <span class="st">"+Rl[-1] * (IN[-1])"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Entr. Profits"</span>, h <span class="op">=</span> <span class="st">"+FDf"</span>, fc <span class="op">=</span> <span class="st">"-Ff"</span>, fk <span class="op">=</span> <span class="st">"+FUf"</span>, bc <span class="op">=</span> <span class="st">"+Rl[-1] * (Lfs[-1] - IN[-1] - NPL)"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Banks Profits"</span>, h <span class="op">=</span> <span class="st">"+FDb"</span>, bc <span class="op">=</span> <span class="st">"-Fb"</span>, bk <span class="op">=</span> <span class="st">"+FUb"</span><span class="op">)</span>,
  <span class="co"># Interests</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Int. hh loans"</span>, h <span class="op">=</span> <span class="st">"-Rl[-1] * Lhd[-1]"</span>, bc <span class="op">=</span> <span class="st">"+Rl[-1] * Lhs[-1]"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Int. deposits"</span>, h <span class="op">=</span> <span class="st">"+Rm[-1] * Mh[-1]"</span>, bc <span class="op">=</span> <span class="st">"-Rm[-1] * Ms[-1]"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Int. bills"</span>, h <span class="op">=</span> <span class="st">"+Rb[-1] * Bhd[-1]"</span>, g <span class="op">=</span> <span class="st">"-Rb[-1] * Bs[-1]"</span>, cbc <span class="op">=</span> <span class="st">"+Rb[-1] * Bcbd[-1]"</span>, bc <span class="op">=</span> <span class="st">"+Rb[-1] * Bbd[-1]"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Int. bonds"</span>, h <span class="op">=</span> <span class="st">"+BLd[-1]"</span>, g <span class="op">=</span> <span class="st">"-BLd[-1]"</span><span class="op">)</span>,
  <span class="co"># Change in stocks</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. loans"</span>, h <span class="op">=</span> <span class="st">"+(Lhd - Lhd[-1])"</span>, fk <span class="op">=</span> <span class="st">"+(Lfd - Lfd[-1])"</span>, bk <span class="op">=</span> <span class="st">"-(Ls - Ls[-1])"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. cash"</span>, h <span class="op">=</span> <span class="st">"-(Hhd - Hhd[-1])"</span>, cbk <span class="op">=</span> <span class="st">"+(Hs - Hs[-1])"</span>, bk <span class="op">=</span> <span class="st">"-(Hbd - Hbd[-1])"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. deposits"</span>, h <span class="op">=</span> <span class="st">"-(Mh - Mh[-1])"</span>, bk <span class="op">=</span> <span class="st">"+(Ms - Ms[-1])"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. bills"</span>, h <span class="op">=</span> <span class="st">"-(Bhd - Bhd[-1])"</span>, g <span class="op">=</span> <span class="st">"+(Bs - Bs[-1])"</span>, cbk <span class="op">=</span> <span class="st">"-(Bcbd - Bcbd[-1])"</span>, bk <span class="op">=</span> <span class="st">"-(Bbd - Bbd[-1])"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. bonds"</span>, h <span class="op">=</span> <span class="st">"-(BLd - BLd[-1]) * Pbl"</span>, g <span class="op">=</span> <span class="st">"+(BLs - BLs[-1]) * Pbl"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. equities"</span>, h <span class="op">=</span> <span class="st">"-(Ekd - Ekd[-1]) * Pe"</span>, fk <span class="op">=</span> <span class="st">"+(Eks - Eks[-1]) * Pe"</span><span class="op">)</span>,
  <span class="co"># Loan defaults</span>
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Loan defaults"</span>, fk <span class="op">=</span> <span class="st">"+NPL"</span>, bk <span class="op">=</span> <span class="st">"-NPL"</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="../../reference/sfcr_matrix_display.html">sfcr_matrix_display</a></span><span class="op">(</span><span class="va">tfm_growth</span>, <span class="st">"tfm"</span><span class="op">)</span></code></pre></div>
<table class="table table table-striped table-hover">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Households
</th>
<th style="text-align:left;">
Firms curr.
</th>
<th style="text-align:left;">
Firms cap.
</th>
<th style="text-align:left;">
Govt.
</th>
<th style="text-align:left;">
CB curr.
</th>
<th style="text-align:left;">
CB cap.
</th>
<th style="text-align:left;">
Banks curr.
</th>
<th style="text-align:left;">
Banks cap.
</th>
<th style="text-align:left;">
<span class="math inline">\(\sum\)</span>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Consumption
</td>
<td style="text-align:left;">
<span class="math inline">\(-CONS\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(+CONS\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Govt. Exp.
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+G\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-G\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Investment
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+INV\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-INV\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Inventories
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta IN\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta IN\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Taxes
</td>
<td style="text-align:left;">
<span class="math inline">\(-TX\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+TX\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Wages
</td>
<td style="text-align:left;">
<span class="math inline">\(+WB\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-WB\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Inventory financing cost
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-Rl_{-1}\cdot IN_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+Rl_{-1}\cdot (IN_{-1})\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Entr. Profits
</td>
<td style="text-align:left;">
<span class="math inline">\(+FDf\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-Ff\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(+FUf\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+Rl_{-1}\cdot (Lfs_{-1}-IN_{-1}-NPL)\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Banks Profits
</td>
<td style="text-align:left;">
<span class="math inline">\(+FDb\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-Fb\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(+FUb\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Int. hh loans
</td>
<td style="text-align:left;">
<span class="math inline">\(-Rl_{-1}\cdot Lhd_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+Rl_{-1}\cdot Lhs_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Int. deposits
</td>
<td style="text-align:left;">
<span class="math inline">\(+Rm_{-1}\cdot Mh_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-Rm_{-1}\cdot Ms_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Int. bills
</td>
<td style="text-align:left;">
<span class="math inline">\(+Rb_{-1}\cdot Bhd_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-Rb_{-1}\cdot Bs_{-1}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(+Rb_{-1}\cdot Bcbd_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+Rb_{-1}\cdot Bbd_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Int. bonds
</td>
<td style="text-align:left;">
<span class="math inline">\(+BLd_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-BLd_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ch. loans
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta Lhd\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta Lfd\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Ls\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ch. cash
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Hhd\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta Hs\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Hbd\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ch. deposits
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Mh\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta Ms\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ch. bills
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Bhd\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta Bs\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Bcbd\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Bbd\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ch. bonds
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta BLd\cdot Pbl\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta BLs\cdot Pbl\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ch. equities
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Ekd\cdot Pe\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta Eks\cdot Pe\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Loan defaults
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+NPL\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-NPL\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sum\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
</tbody>
</table>
<p>And we validate the model with the data:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_validate.html">sfcr_validate</a></span><span class="op">(</span><span class="va">tfm_growth</span>, <span class="va">growth</span>, <span class="st">"tfm"</span>, tol <span class="op">=</span> <span class="fl">1e-7</span>, rtol <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Water tight! The transactions-flow matrix is consistent with the simulated model.</span></code></pre></div>
</div>
</div>
<div id="sankeys-diagram" class="section level2">
<h2 class="hasAnchor">
<a href="#sankeys-diagram" class="anchor"></a>Sankey’s diagram:</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_sankey.html">sfcr_sankey</a></span><span class="op">(</span><span class="va">tfm_growth</span>, <span class="va">growth</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-d1494ab241246c925a2f" style="width:700px;height:432.632880098888px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-d1494ab241246c925a2f">{"x":{"links":{"source":[20,23,22,22,20,21,21,21,26,20,26,23,23,27,20,27,20,20,25,27,20,20,27,0,1,2,3,4,5,6,7,7,7,8,8,9,10,11,11,11,12,13,13,14,15,16,17,18,19],"target":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,14,15,16,16,16,17,18,19,29,29,29,29,31,28,34,28,30,34,28,35,34,28,28,32,34,28,28,30,33,35,31,31,30,30],"value":[59851849.038083,19057477.702335,19279193.609916,207514.874837,19382156.979446,77296668.009386,755614.973263,20343752.242522,1908097.077895,1516611.532135,847822.501516,1625411.64271,944660.275135,1434734.593609,93774.520918,87574.86714,1751497.3428,1072863.50073,181349.388058,330310.689862,482535.335798,1492924.517489,350485.344161,59851849.038083,19057477.702335,19279193.609916,207514.874837,19382156.979446,77296668.009386,755614.973263,3000219.652606,17007053.721049,336478.868867,1456488.925923,451608.151972,1516611.532135,847822.501516,1299863.711279,178333.724872,147214.205146,944660.275135,798489.691555,636244.902054,181349.388058,1751497.3428,1584523.580064,482535.335798,1492924.517489,350485.344161]},"nodes":{"name":["Consumption","Govt. Exp.","Investment","Inventories","Taxes","Wages","Inventory financing cost","Entr. Profits","Banks Profits","Int. hh loans","Int. deposits","Int. bills","Int. bonds","Ch. loans","Ch. cash","Ch. deposits","Ch. bills","Ch. bonds","Ch. equities","Loan defaults","Households","Firms curr.","Firms cap.","Govt.","CB curr.","CB cap.","Banks curr.","Banks cap.","Households","Firms curr.","Firms cap.","Govt.","CB curr.","CB cap.","Banks curr.","Banks cap."],"group":["Consumption","Govt. Exp.","Investment","Inventories","Taxes","Wages","Inventory financing cost","Entr. Profits","Banks Profits","Int. hh loans","Int. deposits","Int. bills","Int. bonds","Ch. loans","Ch. cash","Ch. deposits","Ch. bills","Ch. bonds","Ch. equities","Loan defaults","Households","Firms curr.","Firms cap.","Govt.","CB curr.","CB cap.","Banks curr.","Banks cap.","Households","Firms curr.","Firms cap.","Govt.","CB curr.","CB cap.","Banks curr.","Banks cap."]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":14,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"dollars","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="structure-of-the-model-dag" class="section level2">
<h2 class="hasAnchor">
<a href="#structure-of-the-model-dag" class="anchor"></a>Structure of the model (DAG)</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_dag_cycles_plot.html">sfcr_dag_cycles_plot</a></span><span class="op">(</span><span class="va">growth_eqs</span>, size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-11-1.png" width="1056"></p>
</div>
<div id="scenario-benchmark-a-continuation-of-baseline-model" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-benchmark-a-continuation-of-baseline-model" class="anchor"></a>Scenario BENCHMARK: A continuation of baseline model</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">growthbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span>
  baseline <span class="op">=</span> <span class="va">growth</span>,
  scenario <span class="op">=</span> <span class="cn">NULL</span>,
  periods <span class="op">=</span> <span class="fl">150</span>,
  method <span class="op">=</span> <span class="st">"Broyden"</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="scenario-1-autonomous-increase-in-the-target-real-wage" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-1-autonomous-increase-in-the-target-real-wage" class="anchor"></a>Scenario 1: Autonomous increase in the target real wage</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
    <span class="va">omega0</span> <span class="op">~</span> <span class="op">-</span><span class="fl">0.1</span>
  <span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">150</span>
<span class="op">)</span>

<span class="va">growtha</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span>
  baseline <span class="op">=</span> <span class="va">growth</span>,
  scenario <span class="op">=</span> <span class="va">shock1</span>,
  periods <span class="op">=</span> <span class="fl">150</span>,
  method <span class="op">=</span> <span class="st">"Broyden"</span>
<span class="op">)</span></code></pre></div>
<div id="figure-11-2a" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-2a" class="anchor"></a>Figure 11.2A</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">growtha</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PI"</span>, <span class="st">"wi"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/scales/man/label_percent.html">percent</a></span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 1 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>To generate the comparison of Figure 11.2A, we need to compare model <code>growth1</code> against the counterfactual baseline evolution <code>growthbl</code>. The code below creates two helper functions that will divide the selected variables by their counterparts in the <code>growthbl</code> model and then apply the <code>do_plot</code> function to it.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">do_cbind</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">m1</span>, <span class="va">m2</span>, <span class="va">variables</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/bind.html">bind_cols</a></span><span class="op">(</span>
    <span class="va">m1</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">m2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="va">variables</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">set_names</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, <span class="st">"_bl"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="va">do_cplot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">m1</span>, <span class="va">variables</span>, <span class="va">plot</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">m2</span> <span class="op">=</span> <span class="va">growthbl</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">vars</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">variables</span>, <span class="st">"_bl"</span><span class="op">)</span>
  <span class="va">ntbl</span> <span class="op">&lt;-</span> <span class="fu">do_cbind</span><span class="op">(</span><span class="va">m1</span>, <span class="va">m2</span>, <span class="va">variables</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">.v</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">variables</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">ntbl</span><span class="op">[</span>, <span class="va">variables</span><span class="op">[[</span><span class="va">.v</span><span class="op">]</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ntbl</span><span class="op">[</span>, <span class="va">variables</span><span class="op">[[</span><span class="va">.v</span><span class="op">]</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span> <span class="va">ntbl</span><span class="op">[</span>, <span class="va">vars</span><span class="op">[[</span><span class="va">.v</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>
  <span class="op">}</span>
  <span class="va">ntbl</span> <span class="op">%&gt;%</span>
    <span class="fu">do_plot</span><span class="op">(</span><span class="va">variables</span>, <span class="va">plot</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="figure-11-2b" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-2b" class="anchor"></a>Figure 11.2B</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growtha</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ik"</span>, <span class="st">"Ck"</span>, <span class="st">"Yk"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
</div>
<div id="scenario-1-second-experiment" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-1-second-experiment" class="anchor"></a>Scenario 1, second experiment</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
    <span class="va">Rbbar</span> <span class="op">~</span> <span class="fl">0.055</span>
  <span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">150</span>
<span class="op">)</span>

<span class="va">growthab</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span>
  baseline <span class="op">=</span> <span class="va">growth</span>,
  scenario <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">shock1</span>, <span class="va">shock2</span><span class="op">)</span>,
  periods <span class="op">=</span> <span class="fl">150</span>,
  method <span class="op">=</span> <span class="st">"Broyden"</span>
<span class="op">)</span></code></pre></div>
<div id="figure-11-2c" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-2c" class="anchor"></a>Figure 11.2C</h3>
<p>This figure required some trial and error to find a value of <code>Rbbar</code> that makes the real interest on bills to end more or less where it started. Is there a way to automate this procedure?</p>
<p>Also note that the real interest rate in <span class="citation">Godley and Lavoie (2007, 407)</span> first increases and then it decreases. The only way to make something similar to that is to set the shock on interest rates to happens before the shock on inflation, which contradicts the book.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">growthab</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>Rrb <span class="op">=</span> <span class="va">Rb</span> <span class="op">-</span> <span class="va">PI</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="st">"Rrb"</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div id="figure-11-2d" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-2d" class="anchor"></a>Figure 11.2D</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthab</span>, variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Yk"</span><span class="op">)</span>, plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Yk"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
</div>
<div id="scenario-2-one-period-only-increase-in-the-growth-rate-of-pure-government-expenditures" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-2-one-period-only-increase-in-the-growth-rate-of-pure-government-expenditures" class="anchor"></a>Scenario 2: One-period only increase in the growth rate of pure government expenditures</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
    <span class="va">GRg</span> <span class="op">~</span> <span class="fl">0.035</span>
  <span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">10</span>,
  end <span class="op">=</span> <span class="fl">11</span>
<span class="op">)</span>

<span class="va">growthb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span>
  baseline <span class="op">=</span> <span class="va">growth</span>,
  scenario <span class="op">=</span> <span class="va">shock3</span>,
  periods <span class="op">=</span> <span class="fl">150</span>,
  method <span class="op">=</span> <span class="st">"Broyden"</span>
<span class="op">)</span></code></pre></div>
<div id="figure-11-3a" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-3a" class="anchor"></a>Figure 11.3A</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthb</span>, variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Yk"</span>, <span class="st">"Gk"</span><span class="op">)</span>, plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Yk"</span>, <span class="st">"Gk"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
</div>
<div id="figure-11-3b" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-3b" class="anchor"></a>Figure 11.3B</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthb</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ER"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">map</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.02</span>, <span class="fl">0.98</span><span class="op">)</span>, <span class="op">~</span><span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">.x</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
</div>
<div id="figure-11-3c" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-3c" class="anchor"></a>Figure 11.3C</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthb</span>, variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PSBR"</span>, <span class="st">"Y"</span>, <span class="st">"GD"</span><span class="op">)</span>, plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"DefY"</span>, <span class="st">"GDY"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
</div>
<div id="figure-11-3d" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-3d" class="anchor"></a>Figure 11.3D</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthb</span>, variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Lfd"</span>, <span class="st">"IN"</span>, <span class="st">"BLR"</span><span class="op">)</span>, plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LIN"</span>, <span class="st">"BLR"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
</div>
</div>
<div id="scenario-2-b-one-shot-decrease-in-the-income-tax" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-2-b-one-shot-decrease-in-the-income-tax" class="anchor"></a>Scenario 2.B: One-shot decrease in the income tax</h2>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
    <span class="va">theta</span> <span class="op">~</span> <span class="fl">0.22</span>
  <span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">10</span>,
  end <span class="op">=</span> <span class="fl">150</span>
<span class="op">)</span>

<span class="va">growthbb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span>
  baseline <span class="op">=</span> <span class="va">growth</span>,
  scenario <span class="op">=</span> <span class="va">shock4</span>,
  periods <span class="op">=</span> <span class="fl">150</span>,
  method <span class="op">=</span> <span class="st">"Broyden"</span>
<span class="op">)</span></code></pre></div>
<div id="figure-11-3e" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-3e" class="anchor"></a>Figure 11.3E</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthbb</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ck"</span>, <span class="st">"Yk"</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ck"</span>, <span class="st">"Yk"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
</div>
</div>
<div id="scenario-3-a-permanent-increase-in-the-growth-rate-of-pure-government-expenditures" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-3-a-permanent-increase-in-the-growth-rate-of-pure-government-expenditures" class="anchor"></a>Scenario 3: A permanent increase in the growth rate of pure government expenditures</h2>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
    <span class="va">GRg</span> <span class="op">~</span> <span class="fl">0.035</span>
  <span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">10</span>,
  end <span class="op">=</span> <span class="fl">150</span>
<span class="op">)</span>

<span class="va">growthc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span>
  baseline <span class="op">=</span> <span class="va">growth</span>,
  scenario <span class="op">=</span> <span class="va">shock5</span>,
  periods <span class="op">=</span> <span class="fl">150</span>,
  method <span class="op">=</span> <span class="st">"Broyden"</span>
<span class="op">)</span></code></pre></div>
<div id="figure-11-4a" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-4a" class="anchor"></a>Figure 11.4A</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_plot</span><span class="op">(</span><span class="va">growthc</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ER"</span>, <span class="st">"PI"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
</div>
<div id="figure-11-4b" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-4b" class="anchor"></a>Figure 11.4B</h3>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_plot</span><span class="op">(</span><span class="va">growthc</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GRg"</span>, <span class="st">"GRk"</span>, <span class="st">"GRy"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 1 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
</div>
<div id="figure-11-4c" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-4c" class="anchor"></a>Figure 11.4C</h3>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_plot</span><span class="op">(</span><span class="va">growthc</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"DefY"</span>, <span class="st">"GDY"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
</div>
</div>
<div id="scenario-4-a-permanent-increase-in-the-bill-rate-of-interest" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-4-a-permanent-increase-in-the-bill-rate-of-interest" class="anchor"></a>Scenario 4: A permanent increase in the bill rate of interest</h2>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock6a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">Rbbar</span> <span class="op">~</span> <span class="fl">0.038</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">10</span>, e <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>
<span class="va">shock6b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">Rbbar</span> <span class="op">~</span> <span class="fl">0.041</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">11</span>, e <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>
<span class="va">shock6c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">Rbbar</span> <span class="op">~</span> <span class="fl">0.044</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">13</span>, e <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>
<span class="va">shock6d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">Rbbar</span> <span class="op">~</span> <span class="fl">0.047</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">15</span>, e <span class="op">=</span> <span class="fl">150</span><span class="op">)</span>

<span class="va">growthd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span>
  baseline <span class="op">=</span> <span class="va">growth</span>,
  scenario <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">shock6a</span>, <span class="va">shock6b</span>, <span class="va">shock6c</span>, <span class="va">shock6d</span><span class="op">)</span>,
  periods <span class="op">=</span> <span class="fl">150</span>,
  method <span class="op">=</span> <span class="st">"Broyden"</span>
<span class="op">)</span></code></pre></div>
<div id="figure-11-5a" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-5a" class="anchor"></a>Figure 11.5A</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">growthd</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">period</span> <span class="op">&lt;</span> <span class="fl">80</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Rl"</span>, <span class="st">"Rbl"</span>, <span class="st">"Rb"</span>, <span class="st">"Rm"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
</div>
<div id="figure-11-5b" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-5b" class="anchor"></a>Figure 11.5B</h3>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthd</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ck"</span>, <span class="st">"Yk"</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ck"</span>, <span class="st">"Yk"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
</div>
<div id="figure-11-5c" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-5c" class="anchor"></a>Figure 11.5C</h3>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthd</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GD"</span>, <span class="st">"Y"</span><span class="op">)</span>, p <span class="op">=</span> <span class="st">"GDY"</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
</div>
<div id="figure-11-5d" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-5d" class="anchor"></a>Figure 11.5D</h3>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_plot</span><span class="op">(</span><span class="va">growthd</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LhYDr"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-35-1.png" width="700"></p>
</div>
<div id="figure-11-5e" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-5e" class="anchor"></a>Figure 11.5E</h3>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_plot</span><span class="op">(</span><span class="va">growthd</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BUR"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-36-1.png" width="700"></p>
</div>
</div>
<div id="scenario-5-increase-in-the-propensity-to-consume-out-of-regular-income" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-5-increase-in-the-propensity-to-consume-out-of-regular-income" class="anchor"></a>Scenario 5: Increase in the propensity to consume out of regular income</h2>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">alpha1</span> <span class="op">~</span> <span class="fl">0.80</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">10</span>, e <span class="op">=</span> <span class="fl">150</span><span class="op">)</span>

<span class="va">growthe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">growth</span>, <span class="va">shock7</span>, <span class="fl">150</span>, method <span class="op">=</span> <span class="st">"Broyden"</span><span class="op">)</span></code></pre></div>
<div id="figure-11-7a" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-7a" class="anchor"></a>Figure 11.7A</h3>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthe</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ck"</span>, <span class="st">"Yk"</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ck"</span>, <span class="st">"Yk"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-38-1.png" width="700"></p>
</div>
<div id="figure-11-7b" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-7b" class="anchor"></a>Figure 11.7B</h3>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthe</span>, v <span class="op">=</span> <span class="st">"Vk"</span>, p <span class="op">=</span> <span class="st">"Vk"</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-39-1.png" width="700"></p>
</div>
<div id="figure-11-7c" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-7c" class="anchor"></a>Figure 11.7C</h3>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthe</span>, v <span class="op">=</span> <span class="st">'PI'</span>, p <span class="op">=</span> <span class="st">"PI"</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-40-1.png" width="700"></p>
</div>
<div id="figure-11-7d" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-7d" class="anchor"></a>Figure 11.7D</h3>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthe</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NHUC"</span>, <span class="st">"phi"</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NHUC"</span>, <span class="st">"phi"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-41-1.png" width="700"></p>
<p>I invite the reader to make a smaller shock above and see what happens. Instead of making <code>alpha1</code> equal to 0.80, make it equal to 0.77. This might come as a surprise…</p>
</div>
<div id="figure-11-7e" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-7e" class="anchor"></a>Figure 11.7E</h3>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthe</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FUf"</span>, <span class="st">"INV"</span>, <span class="st">"INk"</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"FUfInv"</span>, <span class="st">"INk"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-42-1.png" width="700"></p>
</div>
<div id="figure-11-7f" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-7f" class="anchor"></a>Figure 11.7F</h3>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthe</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="st">"GD"</span>, <span class="st">"PSBR"</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"DefY"</span>, <span class="st">"GDY"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-43-1.png" width="700"></p>
</div>
<div id="figure-11-7g" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-7g" class="anchor"></a>Figure 11.7G</h3>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthe</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Q"</span>, <span class="st">'PE'</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Q"</span>, <span class="st">"PE"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-44-1.png" width="700"></p>
</div>
</div>
<div id="scenario-7-an-increase-in-the-gross-new-loans-to-personal-income-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-7-an-increase-in-the-gross-new-loans-to-personal-income-ratio" class="anchor"></a>Scenario 7: An increase in the gross new loans to personal income ratio</h2>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock8</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">eta0</span> <span class="op">~</span> <span class="fl">0.08416</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">10</span>, e <span class="op">=</span> <span class="fl">150</span><span class="op">)</span>
<span class="va">growthf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">growth</span>, <span class="va">shock8</span>, <span class="fl">150</span>, method <span class="op">=</span> <span class="st">"Broyden"</span><span class="op">)</span></code></pre></div>
<div id="figure-11-8a" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-8a" class="anchor"></a>Figure 11.8A</h3>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">growthf</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LhYDr"</span>, <span class="st">"BUR"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-46-1.png" width="700"></p>
</div>
<div id="figure-11-8b" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-8b" class="anchor"></a>Figure 11.8B</h3>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthf</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Yk"</span>, <span class="st">"Ck"</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Yk"</span>, <span class="st">"Ck"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-47-1.png" width="700"></p>
</div>
<div id="figure-11-8c" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-8c" class="anchor"></a>Figure 11.8C</h3>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthf</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BLR"</span>, <span class="st">"CAR"</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BLR"</span>, <span class="st">"CAR"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-48-1.png" width="700"></p>
</div>
<div id="figure-11-8d" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-8d" class="anchor"></a>Figure 11.8D</h3>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_plot</span><span class="op">(</span><span class="va">growthf</span>, <span class="st">"Rl"</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-49-1.png" width="700"></p>
</div>
<div id="figure-11-8e" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-8e" class="anchor"></a>Figure 11.8E</h3>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthf</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="st">"PSBR"</span>, <span class="st">"GD"</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"DefY"</span>, <span class="st">"GDY"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-50-1.png" width="700"></p>
</div>
</div>
<div id="scenario-8-an-increase-in-the-desire-to-hold-equities" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-8-an-increase-in-the-desire-to-hold-equities" class="anchor"></a>Scenario 8: An increase in the desire to hold equities</h2>
<p>This scenario changes one of the portfolio parameters. We can change only one parameter without affecting the consistency of the model since such changes are counterbalanced by changes in the hidden deposit parameters (that are not explicitly modelled).</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock9</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">lambda40</span> <span class="op">~</span> <span class="fl">0.77132</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">10</span>, e <span class="op">=</span> <span class="fl">150</span><span class="op">)</span>
<span class="va">growthg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">growth</span>, <span class="va">shock9</span>, <span class="fl">150</span>, method <span class="op">=</span> <span class="st">"Broyden"</span><span class="op">)</span></code></pre></div>
<div id="figure-11-9a" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-9a" class="anchor"></a>Figure 11.9A</h3>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthg</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Q"</span>, <span class="st">"PE"</span>, <span class="st">"Ekd"</span>, <span class="st">"Pe"</span>, <span class="st">"Vfma"</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Q"</span>, <span class="st">"PE"</span>, <span class="st">"EqFMA"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-52-1.png" width="700"></p>
</div>
<div id="figure-11-9b" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-9b" class="anchor"></a>Figure 11.9B</h3>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthg</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ck"</span>, <span class="st">"Vk"</span>, <span class="st">"Yk"</span>, <span class="st">"Ik"</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ck"</span>, <span class="st">"Vk"</span>, <span class="st">"Yk"</span>, <span class="st">"Ik"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-53-1.png" width="700"></p>
</div>
<div id="figure-11-9c" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-9c" class="anchor"></a>Figure 11.9C</h3>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_plot</span><span class="op">(</span><span class="va">growthg</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Rl"</span>, <span class="st">"Rm"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-54-1.png" width="700"></p>
</div>
</div>
<div id="scenario-8b-increase-in-the-desire-to-hold-equities-that-is-offset-by-a-decline-in-the-desire-to-hold-bills-and-bonds" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-8b-increase-in-the-desire-to-hold-equities-that-is-offset-by-a-decline-in-the-desire-to-hold-bills-and-bonds" class="anchor"></a>Scenario 8b: Increase in the desire to hold equities that is offset by a decline in the desire to hold bills and bonds</h2>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  v <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
    <span class="va">lambda20</span> <span class="op">~</span> <span class="fl">0.20</span>,
    <span class="va">lambda30</span> <span class="op">~</span> <span class="op">-</span><span class="fl">0.09341</span><span class="op">)</span>,
  s <span class="op">=</span> <span class="fl">10</span>,
  e <span class="op">=</span> <span class="fl">150</span><span class="op">)</span>

<span class="va">growthgb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">growth</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">shock9</span>, <span class="va">shock10</span><span class="op">)</span>, <span class="fl">150</span>, method <span class="op">=</span> <span class="st">"Broyden"</span><span class="op">)</span></code></pre></div>
<div id="figure-11-9d" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-9d" class="anchor"></a>Figure 11.9D</h3>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">growthgb</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Rl"</span>, <span class="st">"Rb"</span>, <span class="st">"Rm"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-56-1.png" width="700"></p>
</div>
</div>
<div id="scenario-9-an-increase-in-the-target-proportion-of-gross-investment-financed-by-retained-earnings" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-9-an-increase-in-the-target-proportion-of-gross-investment-financed-by-retained-earnings" class="anchor"></a>Scenario 9: An increase in the target proportion of gross investment financed by retained earnings</h2>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock11</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">psiu</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">10</span>, e <span class="op">=</span> <span class="fl">150</span><span class="op">)</span>
<span class="va">growthh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">growth</span>, <span class="va">shock11</span>, <span class="fl">150</span>, method <span class="op">=</span> <span class="st">"Broyden"</span><span class="op">)</span></code></pre></div>
<div id="figure-11-10a" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-10a" class="anchor"></a>Figure 11.10A</h3>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_plot</span><span class="op">(</span><span class="va">growthh</span>, <span class="st">"phi"</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-58-1.png" width="700"></p>
</div>
<div id="figure-11-10b" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-10b" class="anchor"></a>Figure 11.10B</h3>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">growthh</span> <span class="op">%&gt;%</span> <span class="fu">do_plot</span><span class="op">(</span><span class="st">"wi"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 1 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-59-1.png" width="700"></p>
</div>
<div id="figure-11-10c" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-10c" class="anchor"></a>Figure 11.10C</h3>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthh</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ER"</span>, <span class="st">"Ck"</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ER"</span>, <span class="st">"Ck"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-60-1.png" width="700"></p>
</div>
<div id="figure-11-10d" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-10d" class="anchor"></a>Figure 11.10D</h3>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthh</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Q"</span>, <span class="st">"PE"</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Q"</span>, <span class="st">"PE"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-61-1.png" width="700"></p>
</div>
<div id="figure-11-10e" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-10e" class="anchor"></a>Figure 11.10E</h3>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_plot</span><span class="op">(</span><span class="va">growthh</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GRFfk"</span>, <span class="st">"GRPek"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-62-1.png" width="700"></p>
</div>
</div>
<div id="scenario-10-an-increase-in-non-performing-loans" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-10-an-increase-in-non-performing-loans" class="anchor"></a>Scenario 10: An increase in non-performing loans</h2>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock12</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">NPLk</span> <span class="op">~</span> <span class="fl">0.05</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">10</span>, e <span class="op">=</span> <span class="fl">150</span><span class="op">)</span>
<span class="va">growthi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">growth</span>, <span class="va">shock12</span>, <span class="fl">150</span>, method <span class="op">=</span> <span class="st">"Broyden"</span><span class="op">)</span></code></pre></div>
<div id="figure-11-11a" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-11a" class="anchor"></a>Figure 11.11A</h3>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_plot</span><span class="op">(</span><span class="va">growthi</span>, <span class="st">"CAR"</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-64-1.png" width="700"></p>
</div>
<div id="figure-11-11b" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-11b" class="anchor"></a>Figure 11.11B</h3>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_cplot</span><span class="op">(</span><span class="va">growthi</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Rm"</span>, <span class="st">"Rl"</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Rm"</span>, <span class="st">"Rl"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-65-1.png" width="700"></p>
</div>
</div>
<div id="scenario-10b-an-increase-in-the-normal-adequacy-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-10b-an-increase-in-the-normal-adequacy-ratio" class="anchor"></a>Scenario 10B: An increase in the normal adequacy ratio</h2>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock13</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">NCAR</span> <span class="op">~</span> <span class="fl">0.11</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">10</span>, e <span class="op">=</span> <span class="fl">150</span><span class="op">)</span>
<span class="va">growthib</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">growth</span>, <span class="va">shock13</span>, <span class="fl">150</span>, method <span class="op">=</span> <span class="st">"Broyden"</span><span class="op">)</span></code></pre></div>
<div id="figure-11-11c" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-11c" class="anchor"></a>Figure 11.11C</h3>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_plot</span><span class="op">(</span><span class="va">growthib</span>, v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NCAR"</span>, <span class="st">"CAR"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-67-1.png" width="700"></p>
</div>
<div id="figure-11-11d" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-11d" class="anchor"></a>Figure 11.11D</h3>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_plot</span><span class="op">(</span><span class="va">growthib</span>, <span class="st">"Rl"</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-68-1.png" width="700"></p>
</div>
</div>
</div>
<div id="model-growth2-making-monetary-policy-endogenous" class="section level1">
<h1 class="hasAnchor">
<a href="#model-growth2-making-monetary-policy-endogenous" class="anchor"></a>Model GROWTH2: Making monetary policy endogenous</h1>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">growth_eqs2</span> <span class="op">&lt;-</span> <span class="va">growth_eqs</span>
<span class="va">growth_eqs2</span><span class="op">[[</span><span class="fl">88</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Rb</span> <span class="op">~</span>  <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">Rrb</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">PI</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>
<span class="va">growth_eqs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="va">growth_eqs2</span>,
  <span class="va">Rrbt</span> <span class="op">~</span>  <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">Rb</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">PI</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,
  <span class="va">Rrb</span> <span class="op">~</span> <span class="va">Rrb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">epsrb</span> <span class="op">*</span> <span class="op">(</span><span class="va">Rrbt</span> <span class="op">-</span> <span class="va">Rrb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">growth_parameters2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="va">growth_parameters</span>,
  <span class="va">epsrb</span> <span class="op">~</span> <span class="fl">0.9</span>
<span class="op">)</span>

<span class="va">growth_initial2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="va">growth_initial</span>,
  <span class="va">Rrbt</span> <span class="op">~</span> <span class="fl">0.03232</span>,
  <span class="va">epsrb</span> <span class="op">~</span> <span class="fl">0.9</span>,
  <span class="va">Rrb</span> <span class="op">~</span>  <span class="fl">0.03232</span>
<span class="op">)</span>

<span class="va">growth2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span>
  equations <span class="op">=</span> <span class="va">growth_eqs2</span>,
  external <span class="op">=</span> <span class="va">growth_parameters2</span>,
  periods <span class="op">=</span> <span class="fl">350</span>,
  initial <span class="op">=</span> <span class="va">growth_initial2</span>,
  hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bbs"</span> <span class="op">=</span> <span class="st">"Bbd"</span><span class="op">)</span>,
  .hidden_tol <span class="op">=</span> <span class="fl">1e-6</span>,
  method <span class="op">=</span> <span class="st">"Broyden"</span>,
  rhtol <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<div id="steady-state-1" class="section level2">
<h2 class="hasAnchor">
<a href="#steady-state-1" class="anchor"></a>Steady state</h2>
<p>We can see that this model arrives to a steady state:</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">growth2</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Uk"</span>, <span class="st">"Bsk"</span>, <span class="st">"VK"</span>, <span class="st">'GRk'</span>, <span class="st">"PI"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-70-1.png" width="700"></p>
<div id="scenario-benchmark" class="section level3">
<h3 class="hasAnchor">
<a href="#scenario-benchmark" class="anchor"></a>Scenario benchmark</h3>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">growthbl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span>
  <span class="va">growth2</span>,
  <span class="cn">NULL</span>,
  <span class="fl">100</span>,
  method <span class="op">=</span> <span class="st">"Broyden"</span>
<span class="op">)</span></code></pre></div>
</div>
</div>
<div id="scenario-1-permanent-increase-in-government-expenditures" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-1-permanent-increase-in-government-expenditures" class="anchor"></a>Scenario 1: Permanent increase in government expenditures</h2>
<p>This model is rather unstable and breaks the Broyden/Gauss algorithms if run for many periods (I couldn’t make it run with 150 periods). Sometimes it did run with Newton method and sometimes it didn’t.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">GRg</span> <span class="op">~</span> <span class="fl">0.033</span><span class="op">)</span>, s <span class="op">=</span> <span class="fl">10</span>, e <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>

<span class="va">growth2a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span>
  baseline <span class="op">=</span> <span class="va">growth2</span>,
  scenario <span class="op">=</span> <span class="va">shock1</span>,
  periods <span class="op">=</span> <span class="fl">100</span>,
  method <span class="op">=</span> <span class="st">"Broyden"</span>
<span class="op">)</span></code></pre></div>
<div id="figure-11-6a" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-6a" class="anchor"></a>Figure 11.6A</h3>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_plot</span><span class="op">(</span><span class="va">growth2a</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GRy"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 1 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-73-1.png" width="700"></p>
</div>
<div id="figure-11-6b" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-6b" class="anchor"></a>Figure 11.6B</h3>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">do_plot</span><span class="op">(</span><span class="va">growth2a</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Rb"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-74-1.png" width="700"></p>
</div>
<div id="figure-11-6c" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-6c" class="anchor"></a>Figure 11.6C</h3>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">growth2a</span> <span class="op">%&gt;%</span>
  <span class="fu">do_cplot</span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gk"</span>, <span class="st">"ER"</span><span class="op">)</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gk"</span>, <span class="st">"ER"</span><span class="op">)</span>, m2 <span class="op">=</span> <span class="va">growthbl2</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-75-1.png" width="700"></p>
</div>
<div id="figure-11-6d" class="section level3">
<h3 class="hasAnchor">
<a href="#figure-11-6d" class="anchor"></a>Figure 11.6D</h3>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">growth2a</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Rl"</span>, <span class="st">"Rb"</span>, <span class="st">"Rm"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl8-growth_files/figure-html/unnamed-chunk-76-1.png" width="700"></p>
</div>
</div>
</div>
<div id="session-information" class="section level1">
<h1 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session information</h1>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; R version 4.0.2 (2020-06-22)</span>
<span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">#&gt; Running under: Ubuntu 16.04.6 LTS</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS:   /usr/lib/openblas-base/libblas.so.3</span>
<span class="co">#&gt; LAPACK: /usr/lib/libopenblasp-r0.2.18.so</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span>
<span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span>
<span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span>
<span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span>
<span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
<span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt;  [1] forcats_0.5.1   stringr_1.4.0   dplyr_1.0.7     purrr_0.3.4    </span>
<span class="co">#&gt;  [5] readr_2.0.2     tidyr_1.1.4     tibble_3.1.5    ggplot2_3.3.5  </span>
<span class="co">#&gt;  [9] tidyverse_1.3.1 sfcr_0.2.1     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] fs_1.5.0           lubridate_1.8.0    webshot_0.5.2      httr_1.4.2        </span>
<span class="co">#&gt;  [5] rprojroot_2.0.2    tools_4.0.2        backports_1.2.1    utf8_1.2.2        </span>
<span class="co">#&gt;  [9] R6_2.5.1           DBI_1.1.1          colorspace_2.0-2   withr_2.4.2       </span>
<span class="co">#&gt; [13] gridExtra_2.3      tidyselect_1.1.1   compiler_4.0.2     textshaping_0.3.5 </span>
<span class="co">#&gt; [17] cli_3.0.1          rvest_1.0.1        expm_0.999-6       xml2_1.3.2        </span>
<span class="co">#&gt; [21] desc_1.4.0         labeling_0.4.2     scales_1.1.1       pkgdown_1.6.1     </span>
<span class="co">#&gt; [25] systemfonts_1.0.2  digest_0.6.28      rmarkdown_2.11     svglite_2.0.0     </span>
<span class="co">#&gt; [29] pkgconfig_2.0.3    htmltools_0.5.2    dbplyr_2.1.1       fastmap_1.1.0     </span>
<span class="co">#&gt; [33] highr_0.9          htmlwidgets_1.5.4  rlang_0.4.11       readxl_1.3.1      </span>
<span class="co">#&gt; [37] rstudioapi_0.13    jquerylib_0.1.4    farver_2.1.0       generics_0.1.0    </span>
<span class="co">#&gt; [41] jsonlite_1.7.2     magrittr_2.0.1     kableExtra_1.3.4   Matrix_1.2-18     </span>
<span class="co">#&gt; [45] Rcpp_1.0.7         munsell_0.5.0      fansi_0.5.0        viridis_0.6.1     </span>
<span class="co">#&gt; [49] lifecycle_1.0.1    stringi_1.7.5      yaml_2.2.1         ggraph_2.0.5      </span>
<span class="co">#&gt; [53] MASS_7.3-51.6      rootSolve_1.8.2.3  grid_4.0.2         ggrepel_0.9.1     </span>
<span class="co">#&gt; [57] crayon_1.4.1       lattice_0.20-41    graphlayouts_0.7.1 haven_2.4.3       </span>
<span class="co">#&gt; [61] hms_1.1.1          knitr_1.36         pillar_1.6.3       igraph_1.2.6      </span>
<span class="co">#&gt; [65] reprex_2.0.1       glue_1.4.2         evaluate_0.14      modelr_0.1.8      </span>
<span class="co">#&gt; [69] tweenr_1.0.2       vctrs_0.3.8        tzdb_0.1.2         Rdpack_2.1.2      </span>
<span class="co">#&gt; [73] networkD3_0.4      cellranger_1.1.0   polyclip_1.10-0    gtable_0.3.0      </span>
<span class="co">#&gt; [77] assertthat_0.2.1   cachem_1.0.6       ggforce_0.3.3      xfun_0.26         </span>
<span class="co">#&gt; [81] rbibutils_2.2.4    broom_0.7.9        tidygraph_1.2.0    ragg_1.1.3        </span>
<span class="co">#&gt; [85] viridisLite_0.4.0  memoise_2.0.0      ellipsis_0.3.2</span></code></pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-godley2007monetary">
<p>Godley, Wynne, and Marc Lavoie. 2007. <em>Monetary Economics: An Integrated Approach to Credit, Money, Income, Production and Wealth</em>. Palgrave Macmillan.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Joao Macalos.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
