<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 5: Model LP • sfcr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Chapter 5: Model LP">
<meta property="og:description" content="sfcr">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@jpmacalos">
<meta name="twitter:site" content="www.joaomacalos.com">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">sfcr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/gl1-sim.html">Chapter 3: Model SIM</a>
    </li>
    <li>
      <a href="../../articles/articles/gl2-pc.html">Chapter 4: Model PC</a>
    </li>
    <li>
      <a href="../../articles/articles/gl3-lp.html">Chapter 5: Model LP</a>
    </li>
    <li>
      <a href="../../articles/articles/gl4-open.html">Chapter 6: Models REG and OPEN</a>
    </li>
    <li>
      <a href="../../articles/articles/gl5-bmw.html">Chapter 7: Model BMW</a>
    </li>
    <li>
      <a href="../../articles/articles/gl6-dis.html">Chapter 9: Model DIS and DISINF</a>
    </li>
    <li>
      <a href="../../articles/articles/gl7-insout.html">Chapter 10: Model INSOUT</a>
    </li>
    <li>
      <a href="../../articles/articles/gl8-growth.html">Chapter 11: Model GROWTH</a>
    </li>
    <li>
      <a href="../../articles/articles/gl9-open12.html">Chapter 12: Model Advanced OPEN</a>
    </li>
    <li>
      <a href="../../articles/sfcr_multis.html">sfcr_multis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/joaomacalos/sfcr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="gl3-lp_files/kePrint-0.0.1/kePrint.js"></script><link href="gl3-lp_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="gl3-lp_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="gl3-lp_files/d3-4.5.0/d3.min.js"></script><script src="gl3-lp_files/sankey-1/sankey.js"></script><script src="gl3-lp_files/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Chapter 5: Model LP</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/joaomacalos/sfcr/blob/master/vignettes/articles/gl3-lp.Rmd"><code>vignettes/articles/gl3-lp.Rmd</code></a></small>
      <div class="hidden name"><code>gl3-lp.Rmd</code></div>

    </div>

    
    
<p>This notebook replicates the models in <span class="citation">Godley and Lavoie (2007 ch. 5)</span>.</p>
<p>Required packages for this analysis:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joaomacalos/sfcr">sfcr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="co">#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</span>
<span class="co">#&gt; ✔ ggplot2 3.3.5     ✔ purrr   0.3.4</span>
<span class="co">#&gt; ✔ tibble  3.1.5     ✔ dplyr   1.0.7</span>
<span class="co">#&gt; ✔ tidyr   1.1.4     ✔ stringr 1.4.0</span>
<span class="co">#&gt; ✔ readr   2.0.2     ✔ forcats 0.5.1</span>
<span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span>
<span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></code></pre></div>
<div id="model-lp" class="section level1">
<h1 class="hasAnchor">
<a href="#model-lp" class="anchor"></a>Model LP</h1>
<div id="equations" class="section level2">
<h2 class="hasAnchor">
<a href="#equations" class="anchor"></a>Equations</h2>
<p>The first step is to write down the equations that define the endogenous variables. I will name the equations as it will make it easier to change them later when we move to models “LP2” and “LP3”:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp_eqs</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
    eq1 <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">C</span> <span class="op">+</span> <span class="va">G</span>,
    
    eq2 <span class="op">=</span> <span class="va">YDr</span> <span class="op">~</span> <span class="va">Y</span> <span class="op">-</span> <span class="va">TX</span> <span class="op">+</span> <span class="va">rb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bh</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">BLh</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
    
    eq3 <span class="op">=</span> <span class="va">TX</span> <span class="op">~</span> <span class="va">theta</span> <span class="op">*</span> <span class="op">(</span><span class="va">Y</span> <span class="op">+</span> <span class="va">rb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bh</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">BLh</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
    
    eq4 <span class="op">=</span> <span class="va">V</span> <span class="op">~</span> <span class="va">V</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">YDr</span> <span class="op">-</span> <span class="va">C</span><span class="op">)</span> <span class="op">+</span> <span class="va">CG</span>,
    
    eq5 <span class="op">=</span> <span class="va">CG</span> <span class="op">~</span> <span class="op">(</span><span class="va">pbl</span> <span class="op">-</span> <span class="va">pbl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">BLh</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
    
    eq6 <span class="op">=</span> <span class="va">C</span> <span class="op">~</span> <span class="va">alpha1</span> <span class="op">*</span> <span class="va">YDEr</span> <span class="op">+</span> <span class="va">alpha2</span> <span class="op">*</span> <span class="va">V</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
    
    eq7 <span class="op">=</span> <span class="va">VE</span> <span class="op">~</span> <span class="va">V</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">YDEr</span> <span class="op">-</span> <span class="va">C</span><span class="op">)</span> <span class="op">+</span> <span class="va">CG</span>,
    
    eq8 <span class="op">=</span> <span class="va">Hh</span> <span class="op">~</span> <span class="va">V</span> <span class="op">-</span> <span class="va">Bh</span> <span class="op">-</span> <span class="va">pbl</span> <span class="op">*</span> <span class="va">BLh</span>,
    
    eq9 <span class="op">=</span> <span class="va">Hd</span> <span class="op">~</span> <span class="va">VE</span> <span class="op">-</span> <span class="va">Bd</span> <span class="op">-</span> <span class="va">pbl</span> <span class="op">*</span> <span class="va">BLd</span>,
    
    eq10 <span class="op">=</span> <span class="va">Bd</span> <span class="op">~</span> <span class="op">(</span><span class="va">VE</span> <span class="op">*</span> <span class="va">lambda20</span><span class="op">)</span> <span class="op">+</span> <span class="va">VE</span> <span class="op">*</span> <span class="op">(</span><span class="va">lambda22</span> <span class="op">*</span> <span class="va">rb</span> <span class="op">+</span> <span class="va">lambda23</span> <span class="op">*</span> <span class="va">ERrbl</span><span class="op">)</span> <span class="op">+</span> <span class="va">lambda24</span> <span class="op">*</span> <span class="op">(</span><span class="va">YDEr</span><span class="op">)</span>,
    
    eq11 <span class="op">=</span> <span class="va">BLd</span> <span class="op">~</span> <span class="va">VE</span> <span class="op">*</span> <span class="op">(</span><span class="va">lambda30</span> <span class="op">+</span> <span class="va">lambda32</span> <span class="op">*</span> <span class="va">rb</span> <span class="op">+</span> <span class="va">lambda33</span> <span class="op">*</span> <span class="va">ERrbl</span> <span class="op">+</span> <span class="va">lambda34</span> <span class="op">*</span> <span class="op">(</span><span class="va">YDEr</span><span class="op">/</span><span class="va">VE</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">pbl</span>,
    
    eq12 <span class="op">=</span> <span class="va">Bh</span> <span class="op">~</span> <span class="va">Bd</span>,
    
    eq13 <span class="op">=</span> <span class="va">BLh</span> <span class="op">~</span> <span class="va">BLd</span>,
    
    eq14 <span class="op">=</span> <span class="va">Bs</span> <span class="op">~</span> <span class="va">Bs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">G</span> <span class="op">+</span> <span class="va">rb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">BLs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">TX</span> <span class="op">+</span> <span class="va">rb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bcb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="fu">d</span><span class="op">(</span><span class="va">BLs</span><span class="op">)</span> <span class="op">*</span> <span class="va">pbl</span><span class="op">)</span>,
    
    eq15 <span class="op">=</span> <span class="va">Hs</span> <span class="op">~</span> <span class="va">Hs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu">d</span><span class="op">(</span><span class="va">Bcb</span><span class="op">)</span>,
    
    eq16 <span class="op">=</span> <span class="va">Bcb</span> <span class="op">~</span> <span class="va">Bs</span> <span class="op">-</span> <span class="va">Bh</span>,
    
    eq17 <span class="op">=</span> <span class="va">BLs</span> <span class="op">~</span> <span class="va">BLh</span>,
    
    eq18 <span class="op">=</span> <span class="va">ERrbl</span> <span class="op">~</span> <span class="va">rbl</span> <span class="op">+</span> <span class="va">chi</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="va">pebl</span> <span class="op">-</span> <span class="va">pbl</span><span class="op">)</span><span class="op">/</span><span class="va">pbl</span><span class="op">)</span>,
    
    eq19 <span class="op">=</span> <span class="va">rbl</span> <span class="op">~</span> <span class="fl">1</span><span class="op">/</span><span class="va">pbl</span>,
    
    eq20 <span class="op">=</span> <span class="va">pebl</span> <span class="op">~</span> <span class="va">pbl</span>,
    
    eq21 <span class="op">=</span> <span class="va">CGE</span> <span class="op">~</span> <span class="va">chi</span> <span class="op">*</span> <span class="op">(</span><span class="va">pebl</span> <span class="op">-</span> <span class="va">pbl</span><span class="op">)</span> <span class="op">*</span> <span class="va">BLh</span>,
    
    eq22 <span class="op">=</span> <span class="va">YDEr</span> <span class="op">~</span> <span class="va">YDr</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>
  <span class="op">)</span></code></pre></div>
<p>Next we define the parameters and the values for the exogenous variables:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp_external</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">G</span> <span class="op">~</span>  <span class="fl">20</span>,
  <span class="va">rb</span> <span class="op">~</span>  <span class="fl">0.03</span>,
  <span class="va">pbl</span> <span class="op">~</span>  <span class="fl">20</span>,
  <span class="va">theta</span> <span class="op">~</span>  <span class="fl">0.1938</span>,
  <span class="va">alpha1</span> <span class="op">~</span>  <span class="fl">0.8</span>, 
  <span class="va">alpha2</span> <span class="op">~</span>  <span class="fl">0.2</span>, 
  <span class="va">lambda20</span> <span class="op">~</span>  <span class="fl">0.44196</span>, 
  <span class="va">lambda22</span> <span class="op">~</span> <span class="fl">1.1</span>, 
  <span class="va">lambda23</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span>,
  <span class="va">lambda24</span> <span class="op">~</span> <span class="op">-</span><span class="fl">0.03</span>,
  <span class="va">lambda30</span> <span class="op">~</span> <span class="fl">.3997</span>,
  <span class="va">lambda32</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span>,
  <span class="va">lambda33</span> <span class="op">~</span> <span class="fl">1.1</span>,
  <span class="va">lambda34</span> <span class="op">~</span> <span class="op">-</span><span class="fl">0.03</span>,
  <span class="va">chi</span> <span class="op">~</span> <span class="fl">0.1</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="baseline-model" class="section level2">
<h2 class="hasAnchor">
<a href="#baseline-model" class="anchor"></a>Baseline model</h2>
<p>And simulate the steady state values:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span>
  equations <span class="op">=</span> <span class="va">lp_eqs</span>, 
  external <span class="op">=</span> <span class="va">lp_external</span>, 
  periods <span class="op">=</span> <span class="fl">100</span>,
  hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hs"</span> <span class="op">=</span> <span class="st">"Hh"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="dag-structure-of-the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#dag-structure-of-the-model" class="anchor"></a>DAG structure of the model</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_dag_cycles_plot.html">sfcr_dag_cycles_plot</a></span><span class="op">(</span><span class="va">lp_eqs</span><span class="op">)</span></code></pre></div>
<p><img src="gl3-lp_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>As we can see, there’s no cycle in this model.</p>
</div>
<div id="matrices-of-model-lp" class="section level2">
<h2 class="hasAnchor">
<a href="#matrices-of-model-lp" class="anchor"></a>Matrices of model LP</h2>
<div id="balance-sheet-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#balance-sheet-matrix" class="anchor"></a>Balance-sheet matrix</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bs_lp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_matrix.html">sfcr_matrix</a></span><span class="op">(</span>
  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Households"</span>, <span class="st">"Firms"</span>, <span class="st">"Government"</span>, <span class="st">"Central Bank"</span><span class="op">)</span>,
  codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"h"</span>, <span class="st">"f"</span>, <span class="st">"g"</span>, <span class="st">"cb"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Money"</span>, h <span class="op">=</span> <span class="st">"+Hh"</span>, cb <span class="op">=</span> <span class="st">"-Hs"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bills"</span>, h <span class="op">=</span> <span class="st">"+Bh"</span>, g <span class="op">=</span> <span class="st">"-Bs"</span>, cb <span class="op">=</span> <span class="st">"+Bcb"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bonds"</span>, h <span class="op">=</span> <span class="st">"+BLh * pbl"</span>, g <span class="op">=</span> <span class="st">"-BLs * pbl"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Balance"</span>, h <span class="op">=</span> <span class="st">"-V"</span>, g <span class="op">=</span> <span class="st">"+V"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Validate:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_validate.html">sfcr_validate</a></span><span class="op">(</span><span class="va">bs_lp</span>, <span class="va">lp</span>, which <span class="op">=</span> <span class="st">"bs"</span><span class="op">)</span>
<span class="co">#&gt; Water tight! The balance-sheet matrix is consistent with the simulated model.</span></code></pre></div>
<p>Display:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_matrix_display.html">sfcr_matrix_display</a></span><span class="op">(</span><span class="va">bs_lp</span>, which <span class="op">=</span> <span class="st">"bs"</span><span class="op">)</span></code></pre></div>
<table class="table table table-striped table-hover">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Households
</th>
<th style="text-align:left;">
Firms
</th>
<th style="text-align:left;">
Government
</th>
<th style="text-align:left;">
<span class="math inline">\(\sum\)</span>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Money
</td>
<td style="text-align:left;">
<span class="math inline">\(+Hh\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-Hs\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Bills
</td>
<td style="text-align:left;">
<span class="math inline">\(+Bh\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-Bs\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(+Bcb\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Bonds
</td>
<td style="text-align:left;">
<span class="math inline">\(+BLh\cdot pbl\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-BLs\cdot pbl\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Balance
</td>
<td style="text-align:left;">
<span class="math inline">\(-V\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+V\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sum\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="transactions-flow-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#transactions-flow-matrix" class="anchor"></a>Transactions-flow matrix</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tfm_lp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_matrix.html">sfcr_matrix</a></span><span class="op">(</span>
  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Households"</span>, <span class="st">"Firms"</span>, <span class="st">"Government"</span>, <span class="st">"CB_current"</span>, <span class="st">"CB_capital"</span><span class="op">)</span>,
  codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"h"</span>, <span class="st">"f"</span>, <span class="st">"g"</span>, <span class="st">"cbc"</span>, <span class="st">"cbk"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Consumption"</span>, h <span class="op">=</span> <span class="st">"-C"</span>, f <span class="op">=</span> <span class="st">"+C"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gov. Exp."</span>, f <span class="op">=</span> <span class="st">"+G"</span>, g <span class="op">=</span> <span class="st">"-G"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Income"</span>, h <span class="op">=</span> <span class="st">"+Y"</span>, f <span class="op">=</span> <span class="st">"-Y"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Int. bills"</span>, h <span class="op">=</span> <span class="st">"+rb[-1] * Bh[-1]"</span>, g <span class="op">=</span> <span class="st">"-rb[-1] * Bs[-1]"</span>, cbc <span class="op">=</span> <span class="st">"+rb[-1] * Bcb[-1]"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Int. bonds"</span>, h <span class="op">=</span> <span class="st">"+BLh[-1]"</span>, g <span class="op">=</span> <span class="st">"-BLs[-1]"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CB profits"</span>, g <span class="op">=</span> <span class="st">"+rb[-1] * Bcb[-1]"</span>, cbc <span class="op">=</span> <span class="st">"-rb[-1] * Bcb[-1]"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxes"</span>, h <span class="op">=</span> <span class="st">"-TX"</span>, g <span class="op">=</span> <span class="st">"+TX"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. money"</span>, h <span class="op">=</span> <span class="st">"-d(Hh)"</span>, cbk <span class="op">=</span> <span class="st">"+d(Hs)"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. bills"</span>, h <span class="op">=</span> <span class="st">"-d(Bh)"</span>, g <span class="op">=</span> <span class="st">"+d(Bs)"</span>, cbk <span class="op">=</span> <span class="st">"-d(Bcb)"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. bonds"</span>, h <span class="op">=</span> <span class="st">"-d(BLh) * pbl"</span>, g <span class="op">=</span> <span class="st">"+d(BLh) * pbl"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Display:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_matrix_display.html">sfcr_matrix_display</a></span><span class="op">(</span><span class="va">tfm_lp</span><span class="op">)</span></code></pre></div>
<table class="table table table-striped table-hover">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Households
</th>
<th style="text-align:left;">
Firms
</th>
<th style="text-align:left;">
Government
</th>
<th style="text-align:left;">
CB_current
</th>
<th style="text-align:left;">
CB_capital
</th>
<th style="text-align:left;">
<span class="math inline">\(\sum\)</span>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Consumption
</td>
<td style="text-align:left;">
<span class="math inline">\(-C\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(+C\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Gov. Exp.
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+G\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-G\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Income
</td>
<td style="text-align:left;">
<span class="math inline">\(+Y\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-Y\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Int. bills
</td>
<td style="text-align:left;">
<span class="math inline">\(+rb_{-1}\cdot Bh_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-rb_{-1}\cdot Bs_{-1}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(+rb_{-1}\cdot Bcb_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Int. bonds
</td>
<td style="text-align:left;">
<span class="math inline">\(+BLh_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-BLs_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
CB profits
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+rb_{-1}\cdot Bcb_{-1}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-rb_{-1}\cdot Bcb_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Taxes
</td>
<td style="text-align:left;">
<span class="math inline">\(-TX\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+TX\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ch. money
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Hh\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta Hs\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ch. bills
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Bh\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta Bs\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Bcb\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ch. bonds
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta BLh\cdot pbl\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta BLh\cdot pbl\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sum\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
</tbody>
</table>
<p>Validate:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_validate.html">sfcr_validate</a></span><span class="op">(</span><span class="va">tfm_lp</span>, <span class="va">lp</span>, which <span class="op">=</span> <span class="st">"tfm"</span><span class="op">)</span>
<span class="co">#&gt; Water tight! The transactions-flow matrix is consistent with the simulated model.</span></code></pre></div>
</div>
</div>
<div id="sankeys-representation-of-the-tfm-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#sankeys-representation-of-the-tfm-matrix" class="anchor"></a>Sankey’s representation of the TFM matrix</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_sankey.html">sfcr_sankey</a></span><span class="op">(</span><span class="va">tfm_lp</span>, <span class="va">lp</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-0af0e22b96c69a12b1d2" style="width:700px;height:432.632880098888px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-0af0e22b96c69a12b1d2">{"x":{"links":{"source":[10,12,11,12,12,13,10,10,10,14,10,0,1,2,3,3,4,5,6,7,8,9],"target":[0,1,2,3,4,5,6,7,8,8,9,16,16,15,15,18,15,17,17,19,17,17],"value":[40.013662,20,60.013662,0.855562,0.574746,0.510488,11.808909,0.511125,4.301309,0.511125,4.298478,40.013662,20,60.013662,0.345075,0.510488,0.574746,0.510488,11.808909,0.511125,4.812434,4.298478]},"nodes":{"name":["Consumption","Gov. Exp.","Income","Int. bills","Int. bonds","CB profits","Taxes","Ch. money","Ch. bills","Ch. bonds","Households","Firms","Government","CB_current","CB_capital","Households","Firms","Government","CB_current","CB_capital"],"group":["Consumption","Gov. Exp.","Income","Int. bills","Int. bonds","CB profits","Taxes","Ch. money","Ch. bills","Ch. bonds","Households","Firms","Government","CB_current","CB_capital","Households","Firms","Government","CB_current","CB_capital"]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":14,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"dollars","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="scenario-1" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-1" class="anchor"></a>Scenario 1</h2>
<p>With the steady state values at hand, we can start adding scenarios to analyze what would happen if we change one of the parameters or exogenous variables.</p>
<p>We start by increasing, at the same time, the short-term and long-term interest rates.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
    <span class="va">rb</span> <span class="op">~</span> <span class="fl">0.04</span>,
    <span class="va">pbl</span> <span class="op">~</span> <span class="fl">15</span>
    <span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>

<span class="va">lp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span>
  baseline <span class="op">=</span> <span class="va">lp</span>,
  scenario <span class="op">=</span> <span class="va">shock1</span>,
  periods <span class="op">=</span> <span class="fl">100</span>
<span class="op">)</span>

<span class="va">lp2</span> <span class="op">%&gt;%</span> <span class="va">tail</span>
<span class="co">#&gt; # A tibble: 6 × 38</span>
<span class="co">#&gt;   period     Y   YDr    TX     V    CG     C    VE    Hh    Hd    Bd   BLd    Bh</span>
<span class="co">#&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1     95  121.  101.  24.3  101.     0  101.  101.  21.0  21.0  39.3  2.71  39.3</span>
<span class="co">#&gt; 2     96  121.  101.  24.3  101.     0  101.  101.  21.0  21.0  39.3  2.71  39.3</span>
<span class="co">#&gt; 3     97  121.  101.  24.3  101.     0  101.  101.  21.0  21.0  39.3  2.71  39.3</span>
<span class="co">#&gt; 4     98  121.  101.  24.3  101.     0  101.  101.  21.0  21.0  39.3  2.71  39.3</span>
<span class="co">#&gt; 5     99  121.  101.  24.3  101.     0  101.  101.  21.0  21.0  39.3  2.71  39.3</span>
<span class="co">#&gt; 6    100  121.  101.  24.3  101.     0  101.  101.  21.0  21.0  39.3  2.71  39.3</span>
<span class="co">#&gt; # … with 25 more variables: BLh &lt;dbl&gt;, Bs &lt;dbl&gt;, Hs &lt;dbl&gt;, Bcb &lt;dbl&gt;,</span>
<span class="co">#&gt; #   BLs &lt;dbl&gt;, ERrbl &lt;dbl&gt;, rbl &lt;dbl&gt;, pebl &lt;dbl&gt;, CGE &lt;dbl&gt;, YDEr &lt;dbl&gt;,</span>
<span class="co">#&gt; #   G &lt;dbl&gt;, rb &lt;dbl&gt;, pbl &lt;dbl&gt;, theta &lt;dbl&gt;, alpha1 &lt;dbl&gt;, alpha2 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   lambda20 &lt;dbl&gt;, lambda22 &lt;dbl&gt;, lambda23 &lt;dbl&gt;, lambda24 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   lambda30 &lt;dbl&gt;, lambda32 &lt;dbl&gt;, lambda33 &lt;dbl&gt;, lambda34 &lt;dbl&gt;, chi &lt;dbl&gt;</span></code></pre></div>
<p>Before plotting the variables, we need to calculate three different ratios and the total value of bonds from the simulated model:</p>
<ul>
<li><p>Value of bonds <span class="math inline">\(=\)</span> Price of bonds * Bonds held</p></li>
<li><p>Wealth to disposable income ratio</p></li>
<li><p>Bonds to wealth ratio</p></li>
<li><p>Bills to wealth ratio</p></li>
</ul>
<p>Here we see how the <code>tibble</code> output provides a seamless integration with the <code>dplyr</code> tools that were loaded with the <code>tidyverse</code> packages:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp2</span> <span class="op">&lt;-</span>
  <span class="va">lp2</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>
    BL <span class="op">=</span> <span class="va">BLh</span> <span class="op">*</span> <span class="va">pbl</span>,
    VYDr_r <span class="op">=</span> <span class="va">V</span> <span class="op">/</span> <span class="va">YDr</span>,
    BhV_r <span class="op">=</span> <span class="va">Bh</span> <span class="op">/</span> <span class="va">V</span>,
    BLV_r <span class="op">=</span> <span class="va">BL</span> <span class="op">/</span> <span class="va">V</span>
  <span class="op">)</span>

<span class="co"># Check the newly created columns:</span>
<span class="va">lp2</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">BL</span>, <span class="va">VYDr_r</span>, <span class="va">BhV_r</span>, <span class="va">BLV_r</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 100 × 4</span>
<span class="co">#&gt;       BL VYDr_r BhV_r BLV_r</span>
<span class="co">#&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1  37.8  1     0.395 0.395</span>
<span class="co">#&gt;  2  37.8  1     0.395 0.395</span>
<span class="co">#&gt;  3  37.8  1     0.395 0.395</span>
<span class="co">#&gt;  4  37.8  1     0.395 0.395</span>
<span class="co">#&gt;  5  34.5  0.901 0.386 0.400</span>
<span class="co">#&gt;  6  35.3  0.920 0.391 0.405</span>
<span class="co">#&gt;  7  35.6  0.936 0.389 0.403</span>
<span class="co">#&gt;  8  35.9  0.949 0.388 0.402</span>
<span class="co">#&gt;  9  36.3  0.959 0.387 0.401</span>
<span class="co">#&gt; 10  36.7  0.967 0.387 0.401</span>
<span class="co">#&gt; # … with 90 more rows</span></code></pre></div>
<p>We are now ready to plot the output. We use the <code>ggplot2</code> package to do so.</p>
<p>The <code>ggplot2</code> package works better with data on the long format. Therefore, we must reshape the data before plotting the variables. We will do it with the <code><a href="https://rdrr.io/pkg/tidyr/man/pivot_longer.html">tidyr::pivot_longer()</a></code> function and save the <code>tibble</code> in the long format into a new object.</p>
<p>In the long format, we have one column that store the names of all variables, and only one column for the values. The column <code>period</code> records the periods. Note that each period is now represented in 41 rows.</p>
<p>(This is the last notebook that I will go through the details of the <code>tidyverse</code> syntax).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp2_long</span> <span class="op">&lt;-</span> <span class="va">lp2</span> <span class="op">%&gt;%</span>
  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tidyr/man/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">period</span><span class="op">)</span></code></pre></div>
<p>We are now ready to plot the variables! Let’s start with Wealth to disposable income ratio (Figure 5.2 in <span class="citation">Godley and Lavoie (2007)</span>)</p>
<p>The syntax is very simple:</p>
<ol style="list-style-type: decimal">
<li><p>We use <code><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter()</a></code> from <code>dplyr</code> (included in the <code>tidyverse</code> packages) to select only the variables we are interested into from the <code>name</code> column;</p></li>
<li><p>We plot using <code>ggplot2</code>. We map the x axis to <code>period</code> and the <code>y</code> axis to <code>value</code></p></li>
</ol>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp2_long</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">==</span> <span class="st">'VYDr_r'</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">'Periods'</span>, y <span class="op">=</span> <span class="st">'Wealth to disposable income ratio'</span><span class="op">)</span></code></pre></div>
<p><img src="gl3-lp_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>Next, we plot disposable income (YD_r) and consumption (C) (Figure 5.3):</p>
<p>Now, instead of using <code><a href="https://rdrr.io/r/base/Comparison.html">==</a></code>, we use <code><a href="https://rdrr.io/r/base/match.html">%in%</a></code> to select two variables. We map <code>linetype</code> to <code>variable</code> in the <code>geom_line()</code> aesthetics to have the multiple lines:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp2_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"YDr"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl3-lp_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>Finally, we plot the evolution of bonds to wealth ratio and the evolution of bills to wealth ratio:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp2_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BLV_r"</span>, <span class="st">"BhV_r"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl3-lp_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
</div>
<div id="model-lp2" class="section level1">
<h1 class="hasAnchor">
<a href="#model-lp2" class="anchor"></a>Model LP2</h1>
<div id="equations-1" class="section level2">
<h2 class="hasAnchor">
<a href="#equations-1" class="anchor"></a>Equations</h2>
<p>Let’s move to the model LP2. This model captures the effect of household liquidity preference on long-term interest rates by modifying/or adding equations to the LP model. The reader is invited to check <span class="citation">Godley and Lavoie (2007)</span> for further details on the models and equations.</p>
<p>We can use the <code><a href="../../reference/sfcr_set.html">sfcr_set()</a></code> function to modify a <code>sfcr_set</code>, saving these modifications to a new object. We use the <code><a href="../../reference/sfcr_set_index.html">sfcr_set_index()</a></code> function to find the id value of the <code>pebl</code> variable, so we can exclude it from the set after we wrote the new definition:</p>
<p>Also note how easily the <code>sfcr</code> package deals with if-else statements in the equations:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_set_index.html">sfcr_set_index</a></span><span class="op">(</span><span class="va">lp_eqs</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">lhs</span> <span class="op">==</span> <span class="st">"pebl"</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 × 3</span>
<span class="co">#&gt;      id lhs   rhs  </span>
<span class="co">#&gt;   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1    20 pebl  pbl</span>

<span class="va">lp2_eqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">lp_eqs</span>,
  <span class="va">pebl</span> <span class="op">~</span> <span class="va">pebl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">betae</span> <span class="op">*</span> <span class="op">(</span><span class="va">pebl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">pbl</span><span class="op">)</span> <span class="op">+</span> <span class="va">add</span>,
  <span class="va">pbl</span> <span class="op">~</span>  <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">zeta1</span> <span class="op">*</span><span class="va">beta</span> <span class="op">-</span> <span class="va">zeta2</span><span class="op">*</span><span class="va">beta</span><span class="op">)</span> <span class="op">*</span> <span class="va">pbl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">TP</span> <span class="op">~</span> <span class="op">(</span><span class="va">BLh</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">pbl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">BLh</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">pbl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">Bh</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
  <span class="va">zeta1</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="va">TP</span> <span class="op">&gt;</span> <span class="va">top</span><span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="fl">0</span><span class="op">}</span>,
  <span class="va">zeta2</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="va">TP</span> <span class="op">&lt;</span> <span class="va">bot</span><span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="fl">0</span><span class="op">}</span>,
  exclude <span class="op">=</span> <span class="fl">20</span>  <span class="co"># Exclude first definition of pebl</span>
<span class="op">)</span>

<span class="co"># lp2_eqs$eq20 = pe_bl ~ pe_bl[-1] - betae * (pe_bl[-1] - p_bl) + add</span>
<span class="co"># lp2_eqs$eq23 = p_bl ~  (1 + zeta1 *beta - zeta2*beta) * p_bl[-1]</span>
<span class="co"># lp2_eqs$eq24 = TP ~ (BL_h[-1] * p_bl[-1]) / (BL_h[-1] * p_bl[-1] + B_h[-1])</span>
<span class="co"># lp2_eqs$eq25 = zeta1 ~ if (TP &gt; top) {1} else {0}</span>
<span class="co"># lp2_eqs$eq26 = zeta2 ~ if (TP &lt; bot) {1} else {0}</span>
<span class="co">#</span></code></pre></div>
<p>We also need to add the parameters <span class="math inline">\(beta\_e\)</span>, <span class="math inline">\(beta\)</span>, <span class="math inline">\(top\)</span>, and <span class="math inline">\(bot\)</span> to the list of parameters and remove <span class="math inline">\(p\_bl\)</span> from the exogenous variables.</p>
<p>I also added a bunch of initial values – taken from Gennaro Zezza’s Eviews code – to get my values as close as possible from the ones presented in the book.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp2_external</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">lp_external</span>,
  <span class="va">betae</span> <span class="op">~</span> <span class="fl">0.5</span>,
  <span class="va">beta</span> <span class="op">~</span> <span class="fl">0.02</span>,
  <span class="va">top</span> <span class="op">~</span> <span class="fl">0.505</span>,
  <span class="va">bot</span> <span class="op">~</span> <span class="fl">0.495</span>,
  <span class="va">add</span> <span class="op">~</span> <span class="fl">0</span>,
  exclude <span class="op">=</span> <span class="fl">3</span>
  <span class="op">)</span>

<span class="co">#lp2_external[[3]] &lt;- NULL</span>


<span class="co"># lp2_external[[13]] &lt;- betae ~ 0.5</span>
<span class="co"># lp2_external[[14]] &lt;- beta ~ 0.02</span>
<span class="co"># lp2_external[[15]] &lt;- top ~ 0.505</span>
<span class="co"># lp2_external[[16]] &lt;- bot ~ 0.495</span>
<span class="co"># lp2_external[[17]] &lt;- add ~ 0</span>
<span class="co"># lp2_external[[3]] &lt;- NULL</span>

<span class="co"># lp2_exogenous = list(</span>
<span class="co">#   G ~ 20,</span>
<span class="co">#   r_b ~ 0.03,</span>
<span class="co">#   add ~ 0</span>
<span class="co">#   )</span>

<span class="va">lp2_initial</span> <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">YDr</span> <span class="op">~</span> <span class="fl">95.803</span>,
  <span class="va">V</span> <span class="op">~</span> <span class="fl">95.803</span>,
  <span class="va">Hh</span> <span class="op">~</span> <span class="fl">20.125</span>,
  <span class="va">BLd</span> <span class="op">~</span> <span class="fl">1.89</span>,
  <span class="va">Bh</span> <span class="op">~</span> <span class="fl">37.839</span>,
  <span class="va">BLh</span> <span class="op">~</span> <span class="fl">1.892</span>,
  <span class="va">Bs</span> <span class="op">~</span> <span class="fl">57.964</span>,
  <span class="va">Hs</span> <span class="op">~</span> <span class="fl">20.125</span>,
  <span class="va">Bcb</span> <span class="op">~</span> <span class="fl">20.125</span>,
  <span class="va">BLs</span> <span class="op">~</span> <span class="fl">1.89</span>,
  <span class="va">rbl</span> <span class="op">~</span> <span class="fl">0.05</span>,
  <span class="va">pebl</span> <span class="op">~</span> <span class="fl">20</span>,
  <span class="va">pbl</span> <span class="op">~</span> <span class="fl">20</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="baseline" class="section level2">
<h2 class="hasAnchor">
<a href="#baseline" class="anchor"></a>Baseline</h2>
<p>We can simulate the model:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span>
  <span class="va">lp2_eqs</span>,
  <span class="va">lp2_external</span>,
  periods <span class="op">=</span> <span class="fl">100</span>,
  initial <span class="op">=</span> <span class="va">lp2_initial</span>,
  hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hh"</span> <span class="op">=</span> <span class="st">"Hs"</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">lp2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 46</span>
<span class="co">#&gt;   period     Y   YDr    TX     V    CG     C    VE    Hh    Hd    Bd   BLd    Bh</span>
<span class="co">#&gt;    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1     95  116.  95.8  23.0  95.8     0  95.8  95.8  20.1  20.1  37.8  1.89  37.8</span>
<span class="co">#&gt; 2     96  116.  95.8  23.0  95.8     0  95.8  95.8  20.1  20.1  37.8  1.89  37.8</span>
<span class="co">#&gt; 3     97  116.  95.8  23.0  95.8     0  95.8  95.8  20.1  20.1  37.8  1.89  37.8</span>
<span class="co">#&gt; 4     98  116.  95.8  23.0  95.8     0  95.8  95.8  20.1  20.1  37.8  1.89  37.8</span>
<span class="co">#&gt; 5     99  116.  95.8  23.0  95.8     0  95.8  95.8  20.1  20.1  37.8  1.89  37.8</span>
<span class="co">#&gt; 6    100  116.  95.8  23.0  95.8     0  95.8  95.8  20.1  20.1  37.8  1.89  37.8</span>
<span class="co">#&gt; # … with 33 more variables: BLh &lt;dbl&gt;, Bs &lt;dbl&gt;, Hs &lt;dbl&gt;, Bcb &lt;dbl&gt;,</span>
<span class="co">#&gt; #   BLs &lt;dbl&gt;, ERrbl &lt;dbl&gt;, rbl &lt;dbl&gt;, CGE &lt;dbl&gt;, YDEr &lt;dbl&gt;, pebl &lt;dbl&gt;,</span>
<span class="co">#&gt; #   pbl &lt;dbl&gt;, TP &lt;dbl&gt;, zeta1 &lt;dbl&gt;, zeta2 &lt;dbl&gt;, G &lt;dbl&gt;, rb &lt;dbl&gt;,</span>
<span class="co">#&gt; #   theta &lt;dbl&gt;, alpha1 &lt;dbl&gt;, alpha2 &lt;dbl&gt;, lambda20 &lt;dbl&gt;, lambda22 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   lambda23 &lt;dbl&gt;, lambda24 &lt;dbl&gt;, lambda30 &lt;dbl&gt;, lambda32 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   lambda33 &lt;dbl&gt;, lambda34 &lt;dbl&gt;, chi &lt;dbl&gt;, betae &lt;dbl&gt;, beta &lt;dbl&gt;,</span>
<span class="co">#&gt; #   top &lt;dbl&gt;, bot &lt;dbl&gt;, add &lt;dbl&gt;</span></code></pre></div>
</div>
<div id="scenario-1-1" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-1-1" class="anchor"></a>Scenario 1</h2>
<p>And add a shock to the short interest-rate:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock_exg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">rb</span> <span class="op">~</span> <span class="fl">0.035</span><span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">60</span><span class="op">)</span>

<span class="va">lp2_s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span>
  <span class="va">lp2</span>,
  scenario <span class="op">=</span> <span class="va">shock_exg</span>,
  periods <span class="op">=</span> <span class="fl">60</span>
  <span class="op">)</span></code></pre></div>
<p>As before, we create a new <code>tibble</code> with the model in long format:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp2_s1_long</span> <span class="op">&lt;-</span> <span class="va">lp2_s1</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">period</span>, names_to <span class="op">=</span> <span class="st">"variable"</span><span class="op">)</span></code></pre></div>
<p>And plot the variables. We start by plotting the evolution of the share of bonds in government debt held by households (TP), as in Figure 5.6:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp2_s1_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">==</span> <span class="st">'TP'</span>,
         <span class="va">period</span> <span class="op">&lt;</span> <span class="fl">51</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.505</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.495</span><span class="op">)</span></code></pre></div>
<p><img src="gl3-lp_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<p>We also can visualize the evolution of interest rates (Figure 5.5):</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp2_s1_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rb"</span>, <span class="st">"rbl"</span><span class="op">)</span>,
         <span class="va">period</span> <span class="op">&lt;</span> <span class="fl">51</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></code></pre></div>
<p><img src="gl3-lp_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
</div>
<div id="scenario-2" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-2" class="anchor"></a>Scenario 2</h2>
<p>What would happen if households anticipated a fall in the price of bonds? To see it, we need to create a new scenario adding a one-time shock to the <span class="math inline">\(add\)</span> component of equation 20.</p>
<p>We do it by adding another shock that takes place on period 6 and end on period 6.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">add</span> <span class="op">~</span> <span class="op">-</span><span class="fl">2.8</span><span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">6</span>
<span class="op">)</span>

<span class="va">shock3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  v <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">alpha1</span> <span class="op">~</span> <span class="fl">0.6</span><span class="op">)</span>,
  s <span class="op">=</span> <span class="fl">5</span>,
  e <span class="op">=</span> <span class="fl">60</span>
<span class="op">)</span>

<span class="va">lp2_s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span>
  <span class="va">lp2</span>,
  scenario <span class="op">=</span> <span class="va">shock2</span>,
  periods <span class="op">=</span> <span class="fl">60</span>
  <span class="op">)</span></code></pre></div>
<p>We create a “long” <code>tibble</code>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp2_s2_long</span> <span class="op">&lt;-</span> <span class="va">lp2_s2</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">period</span>, names_to <span class="op">=</span> <span class="st">"variable"</span><span class="op">)</span></code></pre></div>
<p>In order to plot the variables.</p>
<p>We start by plotting the evolution of the price of bonds (<span class="math inline">\(p\_bl\)</span>) and the expected price of bonds (<span class="math inline">\(pe\_bl\)</span>), as in Figure 5.8:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp2_s2_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pbl"</span>, <span class="st">"pebl"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl3-lp_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<p>This shock to the expected price of bonds cause the long-term interest rate to rise, as a consequence of the target proportion of bonds in the total government debt aimed by the government:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp2_s2_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">==</span> <span class="st">"TP"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.505</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.495</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">15</span>, y <span class="op">=</span> <span class="fl">0.490</span>, label <span class="op">=</span> <span class="st">"Share of bonds in \ngovernemnt debt \nheld by households"</span><span class="op">)</span></code></pre></div>
<p><img src="gl3-lp_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp2_s2_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">==</span> <span class="st">"rbl"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">25</span>, y <span class="op">=</span> <span class="fl">0.05195</span>,
           label <span class="op">=</span> <span class="st">"Long-term interest rate"</span><span class="op">)</span></code></pre></div>
<p><img src="gl3-lp_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
</div>
</div>
<div id="model-lp3-making-government-expenditures-endogenous" class="section level1">
<h1 class="hasAnchor">
<a href="#model-lp3-making-government-expenditures-endogenous" class="anchor"></a>Model LP3: Making government expenditures endogenous</h1>
<p>To simulate the model LP3, we need to add four new equations to the model LP2.</p>
<p>Tip: here, it is easier to first simulate a model with <span class="math inline">\(G\)</span> as an exogenous variable, take note of the value it lands on the steady state, and set the <code>zeta3</code> and <code>zeta4</code> parameters afterwards.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp3_eqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">lp2_eqs</span>,
  <span class="va">PSBR</span> <span class="op">~</span> <span class="op">(</span><span class="va">G</span> <span class="op">+</span> <span class="va">rb</span> <span class="op">*</span> <span class="va">Bs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">BLs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">TX</span> <span class="op">+</span> <span class="va">rb</span> <span class="op">*</span> <span class="va">Bcb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
  <span class="va">zeta3</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span> <span class="op">(</span><span class="va">PSBR</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">Y</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.03</span> <span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="fl">0</span><span class="op">}</span>,
  <span class="va">zeta4</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span> <span class="op">(</span><span class="va">PSBR</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">Y</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">0.03</span> <span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="fl">0</span><span class="op">}</span>,
  <span class="va">G</span> <span class="op">~</span> <span class="va">G</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="op">(</span><span class="va">zeta3</span> <span class="op">+</span> <span class="va">zeta4</span><span class="op">)</span> <span class="op">*</span> <span class="va">betag</span> <span class="op">*</span> <span class="va">PSBR</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">add2</span>
<span class="op">)</span>

<span class="co"># lp3_eqs$eq27 &lt;- PSBR ~ (G + r_b * B_s[-1] + BL_s[-1]) - (TX + r_b * B_cb[-1])</span>
<span class="co"># lp3_eqs$eq28 &lt;- zeta3 ~ if ( (PSBR[-1]/Y[-1]) &gt; 0.03 ) {1} else {0}</span>
<span class="co"># lp3_eqs$eq29 &lt;- zeta4 ~ if ( (PSBR[-1]/Y[-1]) &lt; -0.03 ) {1} else {0}</span>
<span class="co"># lp3_eqs$eq30 &lt;- G ~ G[-1] - (zeta3 + zeta4) * beta_g * PSBR[-1] + add2</span></code></pre></div>
<p>We also have to add some new parameters and <code>exclude</code> “G” from the external set.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Find id of G</span>
<span class="fu"><a href="../../reference/sfcr_set_index.html">sfcr_set_index</a></span><span class="op">(</span><span class="va">lp2_external</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">lhs</span> <span class="op">==</span> <span class="st">"G"</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 × 3</span>
<span class="co">#&gt;      id lhs   rhs  </span>
<span class="co">#&gt;   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#&gt; 1     1 G     20</span>

<span class="co"># Define new external set</span>
<span class="va">lp3_external</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">lp2_external</span>,
  <span class="va">betag</span> <span class="op">~</span> <span class="fl">1</span>,
  <span class="va">add2</span> <span class="op">~</span> <span class="fl">0</span>,
  exclude <span class="op">=</span> <span class="fl">1</span>
<span class="op">)</span>

<span class="co"># lp2_external[[1]] &lt;- NULL</span>

<span class="co">#lp3_params[[17]] &lt;- beta_g ~ 1</span>

<span class="va">lp3_initial</span> <span class="op">&lt;-</span> <span class="va">lp2_initial</span></code></pre></div>
<div id="baseline-1" class="section level2">
<h2 class="hasAnchor">
<a href="#baseline-1" class="anchor"></a>Baseline</h2>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span>
  <span class="va">lp3_eqs</span>,
  external <span class="op">=</span> <span class="va">lp3_external</span>,
  periods <span class="op">=</span> <span class="fl">100</span>,
  initial <span class="op">=</span> <span class="va">lp3_initial</span>,
  hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hs"</span> <span class="op">=</span> <span class="st">"Hh"</span><span class="op">)</span><span class="op">)</span>

<span class="va">lp3</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html">select</a></span><span class="op">(</span><span class="va">period</span>, <span class="va">G</span>, <span class="va">PSBR</span>, <span class="fu"><a href="https://rdrr.io/pkg/tidyselect/man/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 100 × 51</span>
<span class="co">#&gt;    period        G      PSBR        Y   YDr       TX     V    CG        C</span>
<span class="co">#&gt;     &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt;  1      1 1   e-15  1   e-15 1   e-15  95.8 1   e-15  95.8 1e-15 1   e-15</span>
<span class="co">#&gt;  2      2 0        -1.59e+ 1 9.58e+ 1  78.8 1.89e+ 1  78.8 0     9.58e+ 1</span>
<span class="co">#&gt;  3      3 1.59e+ 1  5.26e- 4 9.47e+ 1  78.8 1.89e+ 1  78.8 0     7.88e+ 1</span>
<span class="co">#&gt;  4      4 1.59e+ 1 -4.33e- 1 9.47e+ 1  78.3 1.88e+ 1  78.3 0     7.88e+ 1</span>
<span class="co">#&gt;  5      5 1.59e+ 1 -3.49e- 1 9.42e+ 1  78.0 1.87e+ 1  78.0 0     7.83e+ 1</span>
<span class="co">#&gt;  6      6 1.59e+ 1 -2.93e- 1 9.39e+ 1  77.7 1.87e+ 1  77.7 0     7.80e+ 1</span>
<span class="co">#&gt;  7      7 1.59e+ 1 -2.45e- 1 9.36e+ 1  77.4 1.86e+ 1  77.4 0     7.77e+ 1</span>
<span class="co">#&gt;  8      8 1.59e+ 1 -2.05e- 1 9.33e+ 1  77.2 1.86e+ 1  77.2 0     7.74e+ 1</span>
<span class="co">#&gt;  9      9 1.59e+ 1 -1.71e- 1 9.31e+ 1  77.1 1.85e+ 1  77.1 0     7.72e+ 1</span>
<span class="co">#&gt; 10     10 1.59e+ 1 -1.43e- 1 9.30e+ 1  76.9 1.85e+ 1  76.9 0     7.71e+ 1</span>
<span class="co">#&gt; # … with 90 more rows, and 42 more variables: VE &lt;dbl&gt;, Hh &lt;dbl&gt;, Hd &lt;dbl&gt;,</span>
<span class="co">#&gt; #   Bd &lt;dbl&gt;, BLd &lt;dbl&gt;, Bh &lt;dbl&gt;, BLh &lt;dbl&gt;, Bs &lt;dbl&gt;, Hs &lt;dbl&gt;, Bcb &lt;dbl&gt;,</span>
<span class="co">#&gt; #   BLs &lt;dbl&gt;, ERrbl &lt;dbl&gt;, rbl &lt;dbl&gt;, CGE &lt;dbl&gt;, YDEr &lt;dbl&gt;, pebl &lt;dbl&gt;,</span>
<span class="co">#&gt; #   pbl &lt;dbl&gt;, TP &lt;dbl&gt;, zeta1 &lt;dbl&gt;, zeta2 &lt;dbl&gt;, zeta3 &lt;dbl&gt;, zeta4 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   rb &lt;dbl&gt;, theta &lt;dbl&gt;, alpha1 &lt;dbl&gt;, alpha2 &lt;dbl&gt;, lambda20 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   lambda22 &lt;dbl&gt;, lambda23 &lt;dbl&gt;, lambda24 &lt;dbl&gt;, lambda30 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   lambda32 &lt;dbl&gt;, lambda33 &lt;dbl&gt;, lambda34 &lt;dbl&gt;, chi &lt;dbl&gt;, betae &lt;dbl&gt;, …</span></code></pre></div>
</div>
<div id="scenario-1-reduction-in-the-propensity-to-consume" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario-1-reduction-in-the-propensity-to-consume" class="anchor"></a>Scenario 1: Reduction in the propensity to consume</h2>
<p>What would happen in this model if there was a sharp reduction in the propensity to consume? That’s the objective of this exercise with model LP3.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">alpha1</span> <span class="op">~</span> <span class="fl">0.7</span><span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">60</span>
<span class="op">)</span>


<span class="va">lp3_s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span>
  <span class="va">lp3</span>,
  scenario <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">shock3</span><span class="op">)</span>,
  period <span class="op">=</span> <span class="fl">60</span>
<span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>
  PSBR_Y <span class="op">=</span> <span class="va">PSBR</span> <span class="op">/</span> <span class="va">Y</span>
<span class="op">)</span>

<span class="va">lp3_s1_long</span> <span class="op">&lt;-</span> <span class="va">lp3_s1</span> <span class="op">%&gt;%</span> <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">period</span>, names_to <span class="op">=</span> <span class="st">"variable"</span><span class="op">)</span></code></pre></div>
<p>Here we can see that the fall in output is permanent:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp3_s1_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">==</span> <span class="st">"Y"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="gl3-lp_files/figure-html/unnamed-chunk-35-1.png" width="700"></p>
<p>This result contrasts with the long-run effect of a reduction in the propensity to consume arrived with the LP model:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp1_s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span>
  <span class="va">lp</span>,
  scenario <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">shock3</span><span class="op">)</span>,
  periods <span class="op">=</span> <span class="fl">60</span>
<span class="op">)</span>

<span class="va">lp1_s2_long</span> <span class="op">&lt;-</span> <span class="va">lp1_s2</span> <span class="op">%&gt;%</span> <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">period</span>, names_to <span class="op">=</span> <span class="st">"variable"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp1_s2_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">==</span> <span class="st">"Y"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="gl3-lp_files/figure-html/unnamed-chunk-37-1.png" width="700"></p>
<p>In the LP model, the steady-state output level is higher than before the shock because the consumption out of the wealth ends up more than compensating the initial fall in output.</p>
<p>In model LP3, however, the initial fall in output increases the government deficit, and this causes the government to reduce its expenditures:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lp3_s1_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html">filter</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"G"</span>, <span class="st">"PSBR_Y"</span><span class="op">)</span>,
         <span class="va">period</span> <span class="op">&lt;</span> <span class="fl">51</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">variable</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></code></pre></div>
<p><img src="gl3-lp_files/figure-html/unnamed-chunk-38-1.png" width="700"></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-godley2007monetary">
<p>Godley, Wynne, and Marc Lavoie. 2007. <em>Monetary Economics: An Integrated Approach to Credit, Money, Income, Production and Wealth</em>. Palgrave Macmillan.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Joao Macalos.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
