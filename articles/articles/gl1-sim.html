<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 3: Model SIM • sfcr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Chapter 3: Model SIM">
<meta property="og:description" content="sfcr">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@jpmacalos">
<meta name="twitter:site" content="www.joaomacalos.com">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">sfcr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/gl1-sim.html">Chapter 3: Model SIM</a>
    </li>
    <li>
      <a href="../../articles/articles/gl2-pc.html">Chapter 4: Model PC</a>
    </li>
    <li>
      <a href="../../articles/articles/gl3-lp.html">Chapter 5: Model LP</a>
    </li>
    <li>
      <a href="../../articles/articles/gl4-open.html">Chapter 6: Models REG and OPEN</a>
    </li>
    <li>
      <a href="../../articles/articles/gl5-bmw.html">Chapter 7: Model BMW</a>
    </li>
    <li>
      <a href="../../articles/articles/gl6-dis.html">Chapter 9: Model DIS and DISINF</a>
    </li>
    <li>
      <a href="../../articles/articles/gl7-insout.html">Chapter 10: Model INSOUT</a>
    </li>
    <li>
      <a href="../../articles/articles/gl8-growth.html">Chapter 11: Model GROWTH</a>
    </li>
    <li>
      <a href="../../articles/articles/gl9-open12.html">Chapter 12: Model Advanced OPEN</a>
    </li>
    <li>
      <a href="../../articles/sfcr_multis.html">sfcr_multis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/joaomacalos/sfcr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="gl1-sim_files/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="gl1-sim_files/d3-4.5.0/d3.min.js"></script><script src="gl1-sim_files/sankey-1/sankey.js"></script><script src="gl1-sim_files/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Chapter 3: Model SIM</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/joaomacalos/sfcr/blob/master/vignettes/articles/gl1-sim.Rmd"><code>vignettes/articles/gl1-sim.Rmd</code></a></small>
      <div class="hidden name"><code>gl1-sim.Rmd</code></div>

    </div>

    
    
<p>In this article we show how the <code>sfcr</code> package can be used to replicate the model SIM from <span class="citation">Godley and Lavoie (2007 ch. 3)</span>.</p>
<p>We start by loading the <code>sfcr</code> package and the <code>tidyverse</code> packages, that are going to be used to manipulate the data and generate the plots:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joaomacalos/sfcr">sfcr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="co">#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</span>
<span class="co">#&gt; ✔ ggplot2 3.3.2     ✔ purrr   0.3.4</span>
<span class="co">#&gt; ✔ tibble  3.0.4     ✔ dplyr   1.0.2</span>
<span class="co">#&gt; ✔ tidyr   1.1.2     ✔ stringr 1.4.0</span>
<span class="co">#&gt; ✔ readr   1.4.0     ✔ forcats 0.5.0</span>
<span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span>
<span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></code></pre></div>
<div id="sim-model" class="section level1">
<h1 class="hasAnchor">
<a href="#sim-model" class="anchor"></a>SIM Model</h1>
<div id="equations" class="section level2">
<h2 class="hasAnchor">
<a href="#equations" class="anchor"></a>Equations</h2>
<p>The first step is to write down the equations, exogenous variables, and parameters:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim_eqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">TXs</span> <span class="op">~</span> <span class="va">TXd</span>,
  <span class="va">YD</span> <span class="op">~</span> <span class="va">W</span> <span class="op">*</span> <span class="va">Ns</span> <span class="op">-</span> <span class="va">TXs</span>,
  <span class="va">Cd</span> <span class="op">~</span> <span class="va">alpha1</span> <span class="op">*</span> <span class="va">YD</span> <span class="op">+</span> <span class="va">alpha2</span> <span class="op">*</span> <span class="va">Hh</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">Hh</span> <span class="op">~</span> <span class="va">YD</span> <span class="op">-</span> <span class="va">Cd</span> <span class="op">+</span> <span class="va">Hh</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">Ns</span> <span class="op">~</span> <span class="va">Nd</span>,
  <span class="va">Nd</span> <span class="op">~</span> <span class="va">Y</span> <span class="op">/</span> <span class="va">W</span>,
  <span class="va">Cs</span> <span class="op">~</span> <span class="va">Cd</span>,
  <span class="va">Gs</span> <span class="op">~</span> <span class="va">Gd</span>,
  <span class="va">Y</span> <span class="op">~</span> <span class="va">Cs</span> <span class="op">+</span> <span class="va">Gs</span>,
  <span class="va">TXd</span> <span class="op">~</span> <span class="va">theta</span> <span class="op">*</span> <span class="va">W</span> <span class="op">*</span> <span class="va">Ns</span>,
  <span class="va">Hs</span> <span class="op">~</span> <span class="va">Gd</span> <span class="op">-</span> <span class="va">TXd</span> <span class="op">+</span> <span class="va">Hs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>
<span class="op">)</span>

<span class="va">sim_ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">Gd</span> <span class="op">~</span> <span class="fl">20</span>,
  <span class="va">W</span> <span class="op">~</span> <span class="fl">1</span>,
  <span class="va">alpha1</span> <span class="op">~</span> <span class="fl">0.6</span>,
  <span class="va">alpha2</span> <span class="op">~</span> <span class="fl">0.4</span>,
  <span class="va">theta</span> <span class="op">~</span> <span class="fl">0.2</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="baseline" class="section level2">
<h2 class="hasAnchor">
<a href="#baseline" class="anchor"></a>Baseline</h2>
<p>With these objects defined, we can simulate the SIM model. We will make it run for 100 periods. We will also define the hidden equation beforehand, ensuring that the model is written correctly:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span>
  equations <span class="op">=</span> <span class="va">sim_eqs</span>, 
  external <span class="op">=</span> <span class="va">sim_ext</span>, 
  periods <span class="op">=</span> <span class="fl">100</span>, 
  hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hh"</span> <span class="op">=</span> <span class="st">"Hs"</span><span class="op">)</span>,
  method <span class="op">=</span> <span class="st">"Broyden"</span><span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.211   0.020   0.230</span></code></pre></div>
<p>We can check that the model generates the same long-run results as the model presented in page 69 <span class="citation">Godley and Lavoie (2007)</span>..</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">period</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">period</span>, <span class="va">Gs</span>, <span class="va">Y</span>, <span class="va">TXd</span>, <span class="va">YD</span>, <span class="va">Hs</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt;        [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt; period    1    2    3   50</span>
<span class="co">#&gt; Gs        0   20   20   20</span>
<span class="co">#&gt; Y         0   38   48  100</span>
<span class="co">#&gt; TXd       0    8   10   20</span>
<span class="co">#&gt; YD        0   31   38   80</span>
<span class="co">#&gt; Hs        0   12   23   80</span></code></pre></div>
<div id="a-permanent-increase-in-government-expenditures" class="section level3">
<h3 class="hasAnchor">
<a href="#a-permanent-increase-in-government-expenditures" class="anchor"></a>A permanent increase in government expenditures</h3>
<p>What happens if there is a permanent increase in government expenditures? To check it, we need to use the <code><a href="../../reference/sfcr_shock.html">sfcr_shock()</a></code> and <code><a href="../../reference/sfcr_scenario.html">sfcr_scenario()</a></code> functions:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    <span class="va">Gd</span> <span class="op">~</span> <span class="fl">25</span>
  <span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">50</span>
<span class="op">)</span>

<span class="va">sim2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">sim</span>, <span class="va">shock1</span>, <span class="fl">50</span><span class="op">)</span></code></pre></div>
<p>To visualize the consequences of the shock with the <code>ggplot2</code> package, we need to first transform the model into long format. We can do it with <code>pivot_longer()</code> function from <code>dplyr</code>.</p>
<p>The syntax might look complicated but it is actually simple. With the <code>pivot_longer()</code> function we want to transform all columns from the <code>sim2</code> object into the long format, indexed by the <code>period</code> column. That’s why in cols we “remove” the period column.</p>
<p>To plot, we filter the <code>sim2_long</code> object to keep only <span class="math inline">\(Y\)</span>. As we can see, an increase in government leads to an increase in production in the long run.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim2_long</span> <span class="op">&lt;-</span> <span class="va">sim2</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">period</span><span class="op">)</span>

<span class="va">sim2_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">==</span> <span class="st">"Y"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="gl1-sim_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>To plot multiple variables in the same plot, we need to filter not for a specific variable, but for a group of variables. We do it by using the R operator <code><a href="https://rdrr.io/r/base/match.html">%in%</a></code> instead of <code><a href="https://rdrr.io/r/base/Comparison.html">==</a></code>.</p>
<p>Let’s see how to plot <span class="math inline">\(YD\)</span>, <span class="math inline">\(Cd\)</span>, and <span class="math inline">\(Hh\)</span>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim2_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"YD"</span>, <span class="st">"Cd"</span>, <span class="st">"Hh"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span>, color <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl1-sim_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
</div>
</div>
<div id="simex-model" class="section level1">
<h1 class="hasAnchor">
<a href="#simex-model" class="anchor"></a>SIMEX model</h1>
<p>The SIMEX model expands model SIM by introducing expectations into the model. Technically, it modifies one of the equations and add two new equations.</p>
<p>We use the <code><a href="../../reference/sfcr_set.html">sfcr_set()</a></code> function as well to modify a set of equations. To modify an existing equation, we must write its new version and exclude the old one from the set with the <code>exclude</code> argument. To find the correct id to exclude, we can use the <code><a href="../../reference/sfcr_set_index.html">sfcr_set_index()</a></code> function and then <code>filter</code> the <code>lhs</code> of the original set:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_set_index.html">sfcr_set_index</a></span><span class="op">(</span><span class="va">sim_eqs</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">lhs</span> <span class="op">==</span> <span class="st">"Cd"</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 x 3</span>
<span class="co">#&gt;      id lhs   rhs                          </span>
<span class="co">#&gt;   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;                        </span>
<span class="co">#&gt; 1     3 Cd    alpha1 * YD + alpha2 * Hh[-1]</span>

<span class="va">simex_eqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="va">sim_eqs</span>,
  <span class="va">Cd</span> <span class="op">~</span> <span class="va">alpha1</span> <span class="op">*</span> <span class="va">YDE</span> <span class="op">+</span> <span class="va">alpha2</span> <span class="op">*</span> <span class="va">Hh</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">Hd</span> <span class="op">~</span> <span class="va">Hd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">YDE</span> <span class="op">-</span> <span class="va">Cd</span>,
  <span class="va">YDE</span> <span class="op">~</span> <span class="va">YD</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  exclude <span class="op">=</span> <span class="fl">3</span>
<span class="op">)</span></code></pre></div>
<p>We use these new equations to simulate the SIMEX model:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span><span class="va">simex_eqs</span>, <span class="va">sim_ext</span>, <span class="fl">50</span>, hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hh"</span> <span class="op">=</span> <span class="st">"Hs"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>And immediately add a shock to propensity to consume in this model:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">alpha1</span> <span class="op">~</span> <span class="fl">0.7</span><span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">50</span>
<span class="op">)</span>

<span class="va">simex2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">simex</span>, <span class="va">shock2</span>, <span class="fl">50</span><span class="op">)</span></code></pre></div>
<p>We then wrap up this article by plotting the consequences of an increase in the propensity to consume on consumption, disposable income, and wealth:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simex2_long</span> <span class="op">&lt;-</span> <span class="va">simex2</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">period</span><span class="op">)</span>

<span class="va">simex2_long</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Cd"</span>, <span class="st">"YD"</span>, <span class="st">"Hh"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="gl1-sim_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>An attentive reader would notice that the Figure above is not the same as Figure 3.8 of <span class="citation">Godley and Lavoie (2007)</span>. That’s because Figure 3.8 shocks the SIM model and not the SIMEX model. I’ll leave as an exercise for the reader to generate Figure 3.8.</p>
</div>
<div id="extra-functionalities-of-the-sfcr-package" class="section level1">
<h1 class="hasAnchor">
<a href="#extra-functionalities-of-the-sfcr-package" class="anchor"></a>Extra functionalities of the <code>sfcr</code> package</h1>
<div id="matrices-of-model-sim" class="section level2">
<h2 class="hasAnchor">
<a href="#matrices-of-model-sim" class="anchor"></a>Matrices of model SIM</h2>
<p>The <code>sfcr</code> package also provides functions to write and validate the balance-sheet and transactions-flow matrices of any SFC model. It further ensures that the model is stock-flow consistent. Here, the main functions are <code><a href="../../reference/sfcr_matrix.html">sfcr_matrix()</a></code>, to write the matrices, and <code><a href="../../reference/sfcr_validate.html">sfcr_validate()</a></code>, to check whether the matrix is consistent with the simulated model.</p>
<p>The balance-sheet matrix of model SIM is too simple, however, and not worth presenting here as it would require us to create two extra variables that are missing variables: the wealth of households, and public debt. These entries are important because all columns in the balance-sheet matrix must sum to zero.</p>
<div id="transactions-flow-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#transactions-flow-matrix" class="anchor"></a>Transactions-flow matrix</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tfm_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_matrix.html">sfcr_matrix</a></span><span class="op">(</span>
  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Households"</span>, <span class="st">"Firms"</span>, <span class="st">"Government"</span><span class="op">)</span>,
  codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"h"</span>, <span class="st">"f"</span>, <span class="st">"g"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Consumption"</span>, h <span class="op">=</span> <span class="st">"-Cd"</span>, f <span class="op">=</span> <span class="st">"+Cs"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Govt. Exp."</span>, f <span class="op">=</span> <span class="st">"+Gs"</span>, g <span class="op">=</span> <span class="st">"-Gd"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Factor Income"</span>, h <span class="op">=</span> <span class="st">"W * Ns"</span>, f <span class="op">=</span> <span class="st">"-W * Ns"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxes"</span>, h <span class="op">=</span> <span class="st">"-TXs"</span>, g <span class="op">=</span> <span class="st">"+TXd"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. Money"</span>, h <span class="op">=</span> <span class="st">"-d(Hh)"</span>, g <span class="op">=</span> <span class="st">"d(Hs)"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_validate.html">sfcr_validate</a></span><span class="op">(</span><span class="va">tfm_sim</span>, <span class="va">sim</span>, which <span class="op">=</span> <span class="st">"tfm"</span><span class="op">)</span>
<span class="co">#&gt; Water tight! The transactions-flow matrix is consistent with the simulated model.</span></code></pre></div>
</div>
<div id="sankeys-diagram" class="section level3">
<h3 class="hasAnchor">
<a href="#sankeys-diagram" class="anchor"></a>Sankey’s diagram</h3>
<p>Another benefit of having a transactions-flow matrix that is validated in the model is that we can confidently construct a Sankey’s representation of this matrix with the <code><a href="../../reference/sfcr_sankey.html">sfcr_sankey()</a></code> function:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_sankey.html">sfcr_sankey</a></span><span class="op">(</span><span class="va">tfm_sim</span>, <span class="va">sim</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-da176afa7d8df98002e9" style="width:700px;height:432.632880098888px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-da176afa7d8df98002e9">{"x":{"links":{"source":[5,7,6,5,5,0,1,2,3,4],"target":[0,1,2,3,4,9,9,8,10,10],"value":[42.718392,20,62.718392,12.543678,7.456322,42.718392,20,62.718392,12.543678,7.456322]},"nodes":{"name":["Consumption","Govt. Exp.","Factor Income","Taxes","Ch. Money","Households","Firms","Government","Households","Firms","Government"],"group":["Consumption","Govt. Exp.","Factor Income","Taxes","Ch. Money","Households","Firms","Government","Households","Firms","Government"]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":14,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"dollars","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="dag-the-structure-of-the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#dag-the-structure-of-the-model" class="anchor"></a>DAG: The structure of the model</h2>
<p>The <code>sfcr</code> package also provides a built-in function to visualize the DAG representation of the equations in the model:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_dag_cycles_plot.html">sfcr_dag_cycles_plot</a></span><span class="op">(</span><span class="va">sim_eqs</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<p><img src="gl1-sim_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
<div id="blocks-of-independent-equations" class="section level2">
<h2 class="hasAnchor">
<a href="#blocks-of-independent-equations" class="anchor"></a>Blocks of independent equations</h2>
<p>If the user is interested, she or he can check how many iterations was necessary per block to converge to a result by calling the <code><a href="../../reference/sfcr_get_matrix.html">sfcr_get_matrix()</a></code> function on the <code>sim</code> object.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_get_matrix.html">sfcr_get_matrix</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sim_matrix</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt;     TXs    YD    Cd    Hh    Ns    Nd    Cs Gs     Y   TXd    Hs Gd W alpha1</span>
<span class="co">#&gt; 1  0.00  0.00  0.00  0.00  0.00  0.00  0.00  0  0.00  0.00  0.00  0 0    0.0</span>
<span class="co">#&gt; 2  7.69 30.77 18.46 12.31 38.46 38.46 18.46 20 38.46  7.69 12.31 20 1    0.6</span>
<span class="co">#&gt; 3  9.59 38.34 27.93 22.72 47.93 47.93 27.93 20 47.93  9.59 22.72 20 1    0.6</span>
<span class="co">#&gt; 4 11.19 44.75 35.94 31.53 55.94 55.94 35.94 20 55.94 11.19 31.53 20 1    0.6</span>
<span class="co">#&gt; 5 12.54 50.17 42.72 38.99 62.72 62.72 42.72 20 62.72 12.54 38.99 20 1    0.6</span>
<span class="co">#&gt; 6 13.69 54.76 48.45 45.30 68.45 68.45 48.45 20 68.45 13.69 45.30 20 1    0.6</span>
<span class="co">#&gt;   alpha2 theta block1 block2 block3 block4</span>
<span class="co">#&gt; 1    0.0   0.0      0      0      0      0</span>
<span class="co">#&gt; 2    0.4   0.2      0      3      0      0</span>
<span class="co">#&gt; 3    0.4   0.2      0      2      0      0</span>
<span class="co">#&gt; 4    0.4   0.2      0      3      0      0</span>
<span class="co">#&gt; 5    0.4   0.2      0      2      0      0</span>
<span class="co">#&gt; 6    0.4   0.2      0      2      0      0</span></code></pre></div>
<p>To check which variables are included in each block, the user should use the <code><a href="../../reference/sfcr_get_blocks.html">sfcr_get_blocks()</a></code> function:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_get_blocks.html">sfcr_get_blocks</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 11 x 2</span>
<span class="co">#&gt;    endogenous block</span>
<span class="co">#&gt;    &lt;chr&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt;  1 Gs             1</span>
<span class="co">#&gt;  2 TXs            2</span>
<span class="co">#&gt;  3 YD             2</span>
<span class="co">#&gt;  4 Cd             2</span>
<span class="co">#&gt;  5 Ns             2</span>
<span class="co">#&gt;  6 Nd             2</span>
<span class="co">#&gt;  7 Cs             2</span>
<span class="co">#&gt;  8 Y              2</span>
<span class="co">#&gt;  9 TXd            2</span>
<span class="co">#&gt; 10 Hs             3</span>
<span class="co">#&gt; 11 Hh             4</span></code></pre></div>
<p>It is also possible to visualize the block structure of the model with the <code><a href="../../reference/sfcr_dag_blocks_plot.html">sfcr_dag_blocks_plot()</a></code> function:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_dag_blocks_plot.html">sfcr_dag_blocks_plot</a></span><span class="op">(</span><span class="va">sim_eqs</span><span class="op">)</span></code></pre></div>
<p><img src="gl1-sim_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>All of the solvers included in the <code>sfcr</code> package first organize the model in blocks, using the two depth-first searches provided by the <code>igraph</code> package. The simultaneous equations solvers (“Gauss”, “Broyden”, or “Newton”) are only called to solve for the values of the cyclical variables in the model.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-godley2007monetary">
<p>Godley, Wynne, and Marc Lavoie. 2007. <em>Monetary Economics: An Integrated Approach to Credit, Money, Income, Production and Wealth</em>. Palgrave Macmillan.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Joao Macalos.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
