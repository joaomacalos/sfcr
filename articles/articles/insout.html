<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 10: Model INSOUT • sfcr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Chapter 10: Model INSOUT">
<meta property="og:description" content="sfcr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">sfcr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/articles/bmw.html">Chapter 7: Model BMW</a>
    </li>
    <li>
      <a href="../../articles/articles/dis.html">Chapter 9: Model DIS and DISINF</a>
    </li>
    <li>
      <a href="../../articles/articles/growth.html">Chapter 11: Model GROWTH</a>
    </li>
    <li>
      <a href="../../articles/articles/insout.html">Chapter 10: Model INSOUT</a>
    </li>
    <li>
      <a href="../../articles/articles/lp.html">Chapter 5: Model LP</a>
    </li>
    <li>
      <a href="../../articles/articles/open.html">Chapter 6: Models REG and OPEN</a>
    </li>
    <li>
      <a href="../../articles/articles/open12.html">Chapter 12: Model Advanced OPEN</a>
    </li>
    <li>
      <a href="../../articles/articles/pc.html">Chapter 4: Model PC</a>
    </li>
    <li>
      <a href="../../articles/articles/sim.html">Chapter 3: Model SIM</a>
    </li>
    <li>
      <a href="../../articles/sfcr_multis.html">sfcr_multis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/joaomacalos/sfcr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="insout_files/kePrint-0.0.1/kePrint.js"></script><link href="insout_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="insout_files/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="insout_files/d3-4.5.0/d3.min.js"></script><script src="insout_files/sankey-1/sankey.js"></script><script src="insout_files/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Chapter 10: Model INSOUT</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/joaomacalos/sfcr/blob/master/vignettes/articles/insout.Rmd"><code>vignettes/articles/insout.Rmd</code></a></small>
      <div class="hidden name"><code>insout.Rmd</code></div>

    </div>

    
    
<p>Load the required packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joaomacalos/sfcr">sfcr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="co">#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</span>
<span class="co">#&gt; ✔ ggplot2 3.3.2     ✔ purrr   0.3.4</span>
<span class="co">#&gt; ✔ tibble  3.0.4     ✔ dplyr   1.0.2</span>
<span class="co">#&gt; ✔ tidyr   1.1.2     ✔ stringr 1.4.0</span>
<span class="co">#&gt; ✔ readr   1.4.0     ✔ forcats 0.5.0</span>
<span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span>
<span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></code></pre></div>
<div id="model-insout" class="section level1">
<h1 class="hasAnchor">
<a href="#model-insout" class="anchor"></a>Model INSOUT</h1>
<p>We’ll start this model by writing down the balance sheet matrix:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bs_insout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_matrix.html">sfcr_matrix</a></span><span class="op">(</span>
  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Households"</span>, <span class="st">"Firms"</span>, <span class="st">"Government"</span>, <span class="st">"Central bank"</span>, <span class="st">"Banks"</span>, <span class="st">"Sum"</span><span class="op">)</span>,
  codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"h"</span>, <span class="st">"f"</span>, <span class="st">"g"</span>, <span class="st">"cb"</span>, <span class="st">"b"</span>, <span class="st">"s"</span><span class="op">)</span>,
  r1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Inventories"</span>, f <span class="op">=</span> <span class="st">"+INV"</span>, s <span class="op">=</span> <span class="st">"+INV"</span><span class="op">)</span>,
  r2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HPM"</span>, h <span class="op">=</span> <span class="st">"+Hhd"</span>, cb <span class="op">=</span> <span class="st">"-Hs"</span>, b <span class="op">=</span> <span class="st">"+Hbd"</span><span class="op">)</span>,
  r3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Advances"</span>, cb <span class="op">=</span> <span class="st">"+As"</span>, b <span class="op">=</span> <span class="st">"-Ad"</span><span class="op">)</span>,
  r4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Checking deposits"</span>, h <span class="op">=</span> <span class="st">"+M1h"</span>, b <span class="op">=</span> <span class="st">"-M1s"</span><span class="op">)</span>,
  r5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Time deposits"</span>, h <span class="op">=</span> <span class="st">"+M2h"</span>, b <span class="op">=</span> <span class="st">"-M2s"</span><span class="op">)</span>,
  r6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bills"</span>, h <span class="op">=</span> <span class="st">"+Bhh"</span>, g <span class="op">=</span> <span class="st">"-Bs"</span>, cb <span class="op">=</span> <span class="st">"+Bcb"</span>, b <span class="op">=</span> <span class="st">"+Bbd"</span><span class="op">)</span>,
  r7 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bonds"</span>, h <span class="op">=</span> <span class="st">"+BLh * pbl"</span>, g <span class="op">=</span> <span class="st">"-BLs * pbl"</span><span class="op">)</span>,
  r8 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Loans"</span>, f <span class="op">=</span> <span class="st">"-Ld"</span>, b <span class="op">=</span> <span class="st">"+Ls"</span><span class="op">)</span>,
  r9 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Balance"</span>, h <span class="op">=</span> <span class="st">"-V"</span>, f <span class="op">=</span> <span class="fl">0</span>, g <span class="op">=</span> <span class="st">"+GD"</span>, cb <span class="op">=</span> <span class="fl">0</span>, b <span class="op">=</span> <span class="fl">0</span>, s <span class="op">=</span> <span class="st">"-INV"</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="../../reference/sfcr_matrix_display.html">sfcr_matrix_display</a></span><span class="op">(</span><span class="va">bs_insout</span>, <span class="st">"bs"</span><span class="op">)</span></code></pre></div>
<table class="table table table-striped table-hover">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Households
</th>
<th style="text-align:left;">
Firms
</th>
<th style="text-align:left;">
Government
</th>
<th style="text-align:left;">
Central bank
</th>
<th style="text-align:left;">
Banks
</th>
<th style="text-align:left;">
<span class="math inline">\(\sum\)</span>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Inventories
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+INV\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+INV\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
HPM
</td>
<td style="text-align:left;">
<span class="math inline">\(+Hhd\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-Hs\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(+Hbd\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Advances
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+As\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-Ad\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Checking deposits
</td>
<td style="text-align:left;">
<span class="math inline">\(+M1h\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-M1s\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Time deposits
</td>
<td style="text-align:left;">
<span class="math inline">\(+M2h\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-M2s\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Bills
</td>
<td style="text-align:left;">
<span class="math inline">\(+Bhh\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-Bs\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(+Bcb\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(+Bbd\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Bonds
</td>
<td style="text-align:left;">
<span class="math inline">\(+BLh\cdot pbl\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-BLs\cdot pbl\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Loans
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-Ld\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+Ls\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Balance
</td>
<td style="text-align:left;">
<span class="math inline">\(-V\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(+GD\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-INV\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sum\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
</tbody>
</table>
<p>And the transactions-flow matrix:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tfm_insout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_matrix.html">sfcr_matrix</a></span><span class="op">(</span>
  columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Households"</span>, <span class="st">"Firms current"</span>, <span class="st">"Firms capital"</span>, <span class="st">"Govt."</span>, <span class="st">"CB current"</span>, <span class="st">"CB capital"</span>, <span class="st">"Banks current"</span>, <span class="st">"Banks capital"</span><span class="op">)</span>,
  codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"h"</span>, <span class="st">"fc"</span>, <span class="st">"fk"</span>, <span class="st">"g"</span>, <span class="st">"cbc"</span>, <span class="st">"cbk"</span>, <span class="st">"bc"</span>, <span class="st">"bk"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Consumption"</span>, h <span class="op">=</span> <span class="st">"-C"</span>, fc <span class="op">=</span> <span class="st">"+C"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Govt. Expenditures"</span>, fc <span class="op">=</span> <span class="st">"+G"</span>, g <span class="op">=</span> <span class="st">"-G"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. Inv"</span>, fc <span class="op">=</span> <span class="st">"+(INV - INV[-1])"</span>, fk <span class="op">=</span> <span class="st">"-(INV - INV[-1])"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Taxes"</span>, fc <span class="op">=</span> <span class="st">"-TX"</span>, g <span class="op">=</span> <span class="st">"+TX"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Wages"</span>, h <span class="op">=</span> <span class="st">"+WB"</span>, fc <span class="op">=</span> <span class="st">"-WB"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Entrepreneurial profits"</span>, h <span class="op">=</span> <span class="st">"+FXf"</span>, fc <span class="op">=</span> <span class="st">"-FXf"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bank profits"</span>, h <span class="op">=</span> <span class="st">"+FXb"</span>, bc <span class="op">=</span> <span class="st">"-FXb"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CB profits"</span>, g <span class="op">=</span> <span class="st">"+FXcb"</span>, cbc <span class="op">=</span> <span class="st">"-FXcb"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"int. advances"</span>, cbc <span class="op">=</span> <span class="st">"+ra[-1] * As[-1]"</span>, bc <span class="op">=</span> <span class="st">"-ra[-1] * Ad[-1]"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"int. loans"</span>, fc <span class="op">=</span> <span class="st">"-rl[-1] * Ld[-1]"</span>, bc <span class="op">=</span> <span class="st">"+rl[-1] * Ld[-1]"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"int. deposits"</span>, h <span class="op">=</span> <span class="st">"+rm[-1] * M2h[-1]"</span>, bc <span class="op">=</span> <span class="st">"-rm[-1] * M2h[-1]"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"int. bills"</span>, h <span class="op">=</span> <span class="st">"+rb[-1] * Bhh[-1]"</span>, g <span class="op">=</span> <span class="st">"-rb[-1] * Bs[-1]"</span>, cbc <span class="op">=</span> <span class="st">"+rb[-1] * Bcb[-1]"</span>, bc <span class="op">=</span> <span class="st">"+rb[-1] * Bbd[-1]"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"int. bonds"</span>, h <span class="op">=</span> <span class="st">"+BLh[-1]"</span>, g <span class="op">=</span> <span class="st">"-BLs[-1]"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. advances"</span>, cbk <span class="op">=</span> <span class="st">"-(As - As[-1])"</span>, bk <span class="op">=</span> <span class="st">"+(Ad - Ad[-1])"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. loans"</span>, fk <span class="op">=</span> <span class="st">"+(Ld - Ld[-1])"</span>, bk <span class="op">=</span> <span class="st">"-(Ls - Ls[-1])"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. cash"</span>, h <span class="op">=</span> <span class="st">"-(Hhh - Hhh[-1])"</span>, cbk <span class="op">=</span> <span class="st">"+(Hs - Hs[-1])"</span>, bk <span class="op">=</span> <span class="st">"-(Hbd - Hbd[-1])"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. M1"</span>, h <span class="op">=</span> <span class="st">"-(M1h - M1h[-1])"</span>, bk <span class="op">=</span> <span class="st">"+(M1s - M1s[-1])"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. M2"</span>, h <span class="op">=</span> <span class="st">"-(M2h - M2h[-1])"</span>, bk <span class="op">=</span> <span class="st">"+(M2s - M2s[-1])"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. bills"</span>, h <span class="op">=</span> <span class="st">"-(Bhh - Bhh[-1])"</span>, g <span class="op">=</span> <span class="st">"+(Bs - Bs[-1])"</span>, cbk <span class="op">=</span> <span class="st">"-(Bcb - Bcb[-1])"</span>, bk <span class="op">=</span> <span class="st">"-(Bbd - Bbd[-1])"</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Ch. bonds"</span>, h <span class="op">=</span> <span class="st">"-(BLh - BLh[-1]) * pbl"</span>, g <span class="op">=</span> <span class="st">"+(BLs - BLs[-1]) * pbl"</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="../../reference/sfcr_matrix_display.html">sfcr_matrix_display</a></span><span class="op">(</span><span class="va">tfm_insout</span>, <span class="st">"tfm"</span><span class="op">)</span></code></pre></div>
<table class="table table table-striped table-hover">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Households
</th>
<th style="text-align:left;">
Firms current
</th>
<th style="text-align:left;">
Firms capital
</th>
<th style="text-align:left;">
Govt.
</th>
<th style="text-align:left;">
CB current
</th>
<th style="text-align:left;">
CB capital
</th>
<th style="text-align:left;">
Banks current
</th>
<th style="text-align:left;">
Banks capital
</th>
<th style="text-align:left;">
<span class="math inline">\(\sum\)</span>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Consumption
</td>
<td style="text-align:left;">
<span class="math inline">\(-C\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(+C\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Govt. Expenditures
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+G\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-G\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ch. Inv
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta INV\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta INV\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Taxes
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-TX\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+TX\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Wages
</td>
<td style="text-align:left;">
<span class="math inline">\(+WB\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-WB\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Entrepreneurial profits
</td>
<td style="text-align:left;">
<span class="math inline">\(+FXf\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-FXf\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Bank profits
</td>
<td style="text-align:left;">
<span class="math inline">\(+FXb\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-FXb\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
CB profits
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+FXcb\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(-FXcb\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
int. advances
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+ra_{-1}\cdot As_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-ra_{-1}\cdot Ad_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
int. loans
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-rl_{-1}\cdot Ld_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+rl_{-1}\cdot Ld_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
int. deposits
</td>
<td style="text-align:left;">
<span class="math inline">\(+rm_{-1}\cdot M2h_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-rm_{-1}\cdot M2h_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
int. bills
</td>
<td style="text-align:left;">
<span class="math inline">\(+rb_{-1}\cdot Bhh_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-rb_{-1}\cdot Bs_{-1}\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(+rb_{-1}\cdot Bcb_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+rb_{-1}\cdot Bbd_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
int. bonds
</td>
<td style="text-align:left;">
<span class="math inline">\(+BLh_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-BLs_{-1}\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ch. advances
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta As\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta Ad\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ch. loans
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta Ld\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Ls\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ch. cash
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Hhh\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta Hs\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Hbd\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ch. M1
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta M1h\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta M1s\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ch. M2
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta M2h\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta M2s\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ch. bills
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Bhh\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta Bs\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Bcb\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta Bbd\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Ch. bonds
</td>
<td style="text-align:left;">
<span class="math inline">\(-\Delta BLh\cdot pbl\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(+\Delta BLs\cdot pbl\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sum\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(0\)</span>
</td>
</tr>
</tbody>
</table>
<p>Let’s start with the external variables of the model as they are crucial to solve the model.</p>
<p>First, it is important to calculate consistent values of the <code>lambda</code> parameters. I’ll start from <a href="http://gennaro.zezza.it/software/eviews/v6/gl10insout.prg">Zezza’s</a> parameters. However, his definition of <code>lambda21</code>, <code>lambda31</code>, and <code>lambda41</code> are not consistent with the horizontal constraints.</p>
<p>To remedy the problem, I erased these values and recalculate them with the explicit help of the constraints:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Note: there's a mistake in Zezza's parameters lambda11, lambda21, lambda31,</span>
<span class="co"># and lambda41.</span>

<span class="va">lambda20</span> <span class="op">=</span> <span class="fl">0.52245</span>
<span class="va">lambda22</span> <span class="op">=</span> <span class="fl">30</span>
<span class="va">lambda23</span> <span class="op">=</span> <span class="op">-</span><span class="fl">15</span>
<span class="va">lambda24</span> <span class="op">=</span> <span class="op">-</span><span class="fl">15</span>
<span class="va">lambda25</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.06</span>
<span class="va">lambda30</span> <span class="op">=</span> <span class="fl">0.47311</span>
<span class="va">lambda32</span> <span class="op">=</span> <span class="op">-</span><span class="fl">15</span>
<span class="va">lambda33</span> <span class="op">=</span> <span class="fl">30</span>
<span class="va">lambda34</span> <span class="op">=</span> <span class="op">-</span><span class="fl">15</span>
<span class="va">lambda35</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.06</span>
<span class="va">lambda40</span> <span class="op">=</span> <span class="fl">0.17515</span>
<span class="va">lambda42</span> <span class="op">=</span> <span class="op">-</span><span class="fl">15</span>
<span class="va">lambda43</span> <span class="op">=</span> <span class="op">-</span><span class="fl">15</span>
<span class="va">lambda44</span> <span class="op">=</span> <span class="fl">30</span>
<span class="va">lambda45</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.06</span>

<span class="va">lambda10</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="va">lambda20</span> <span class="op">+</span> <span class="va">lambda30</span> <span class="op">+</span> <span class="va">lambda40</span><span class="op">)</span>
<span class="co">#lambda10</span>

<span class="va">lambda15</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="op">(</span><span class="va">lambda25</span> <span class="op">+</span> <span class="va">lambda35</span> <span class="op">+</span> <span class="va">lambda45</span><span class="op">)</span>
<span class="co">#lambda15</span>

<span class="co"># lambda31 = - (lambda33 + lambda32 + lambda34)</span>
<span class="va">lambda31</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="op">(</span><span class="va">lambda33</span> <span class="op">+</span> <span class="va">lambda32</span> <span class="op">+</span> <span class="va">lambda34</span><span class="op">)</span>

<span class="co"># lambda41 = - (lambda44 + lambda42 + lambda43)</span>
<span class="va">lambda41</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="op">(</span><span class="va">lambda44</span> <span class="op">+</span> <span class="va">lambda42</span> <span class="op">+</span> <span class="va">lambda43</span><span class="op">)</span>

<span class="co"># lambda21 = - (lambda22 + lambda23 + lambda24)</span>
<span class="va">lambda21</span> <span class="op">=</span> <span class="op">-</span><span class="op">(</span><span class="va">lambda22</span> <span class="op">+</span> <span class="va">lambda23</span> <span class="op">+</span> <span class="va">lambda24</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"lambda21: "</span>, <span class="va">lambda21</span><span class="op">)</span>
<span class="co">#&gt; lambda21:  0</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"lambda31: "</span>, <span class="va">lambda31</span><span class="op">)</span>
<span class="co">#&gt; lambda31:  0</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"lambda41: "</span>, <span class="va">lambda41</span><span class="op">)</span>
<span class="co">#&gt; lambda41:  0</span>

<span class="va">lambda12</span> <span class="op">=</span> <span class="va">lambda21</span>
<span class="va">lambda13</span> <span class="op">=</span> <span class="va">lambda31</span>
<span class="va">lambda14</span> <span class="op">=</span> <span class="va">lambda41</span>

<span class="va">lambda11</span> <span class="op">=</span> <span class="op">-</span><span class="op">(</span><span class="va">lambda12</span> <span class="op">+</span> <span class="va">lambda13</span> <span class="op">+</span> <span class="va">lambda14</span><span class="op">)</span>

<span class="co"># Print their values to screen:</span>
<span class="va">new_lambdas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>lambda10 <span class="op">=</span> <span class="va">lambda10</span>, 
                 lambda11 <span class="op">=</span> <span class="va">lambda11</span>, 
                 lambda12 <span class="op">=</span> <span class="va">lambda12</span>, 
                 lambda13 <span class="op">=</span> <span class="va">lambda13</span>, 
                 lambda14 <span class="op">=</span> <span class="va">lambda14</span>, 
                 lambda15 <span class="op">=</span> <span class="va">lambda15</span><span class="op">)</span>

<span class="fu">iwalk</span><span class="op">(</span><span class="va">new_lambdas</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">.y</span>, <span class="st">" = "</span>, <span class="va">.x</span>, <span class="st">"\n"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; lambda10  =  -0.17071 </span>
<span class="co">#&gt; lambda11  =  0 </span>
<span class="co">#&gt; lambda12  =  0 </span>
<span class="co">#&gt; lambda13  =  0 </span>
<span class="co">#&gt; lambda14  =  0 </span>
<span class="co">#&gt; lambda15  =  0.18</span></code></pre></div>
<p>With the new <code>lambda</code> values at hand, we can write down the external variables</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout_ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  <span class="co"># EXOGENOUS</span>
  
  <span class="va">rbl</span> <span class="op">~</span> <span class="fl">0.027</span>,
  <span class="va">rb</span> <span class="op">~</span> <span class="fl">0.023</span>,
  <span class="va">pr</span> <span class="op">~</span> <span class="fl">1</span>,
  <span class="va">g</span> <span class="op">~</span> <span class="fl">25</span>,
  <span class="va">Nfe</span> <span class="op">~</span> <span class="fl">133.28</span>, <span class="co">## Zezza supplies this exogenous full employment value</span>
  <span class="co">#Nfe ~ 142.75,</span>
  
  <span class="co"># In model DISING Nfe was defined as `s / pr` but it doesn't work here.</span>
  <span class="co"># I discuss this issue in experiment #2.</span>
  
  <span class="co"># PARAMETERS</span>
  
  <span class="va">alpha0</span> <span class="op">~</span> <span class="fl">0</span>,
  <span class="va">alpha1</span> <span class="op">~</span> <span class="fl">0.95</span>,
  <span class="va">alpha2</span> <span class="op">~</span> <span class="fl">0.05</span>,
  <span class="va">beta</span> <span class="op">~</span> <span class="fl">0.5</span>,
  bot <span class="op">=</span> <span class="va">bot</span> <span class="op">~</span> <span class="fl">0.02</span>,
  botpm <span class="op">=</span> <span class="va">botpm</span> <span class="op">~</span> <span class="fl">0.003</span>,
  <span class="va">epsilon</span> <span class="op">~</span> <span class="fl">0.5</span>,
  <span class="va">gamma</span> <span class="op">~</span> <span class="fl">0.5</span>,
  <span class="va">lambdac</span> <span class="op">~</span> <span class="fl">0.1</span>,
  <span class="va">phi</span> <span class="op">~</span> <span class="fl">0.1</span>,
  <span class="va">ro1</span> <span class="op">~</span> <span class="fl">0.1</span>,
  <span class="va">ro2</span> <span class="op">~</span> <span class="fl">0.1</span>,
  <span class="va">sigma0</span> <span class="op">~</span> <span class="fl">0.3612</span>,
  <span class="va">sigma1</span> <span class="op">~</span> <span class="fl">3</span>,
  <span class="va">tau</span> <span class="op">~</span> <span class="fl">0.25</span>,
  <span class="va">zetab</span> <span class="op">~</span>  <span class="fl">0.9</span>,
  <span class="va">zetal</span> <span class="op">~</span>  <span class="fl">0.0002</span>,
  <span class="va">zetam</span> <span class="op">~</span>  <span class="fl">0.0002</span>,
  <span class="va">Omega0</span> <span class="op">~</span> <span class="op">-</span><span class="fl">0.32549</span>,
  <span class="va">Omega1</span> <span class="op">~</span> <span class="fl">1</span>,
  <span class="va">Omega2</span> <span class="op">~</span> <span class="fl">1.5</span>,
  <span class="va">Omega3</span> <span class="op">~</span> <span class="fl">0.1</span>,
  <span class="co">#top ~ 0.04, # Zezza's top</span>
  top <span class="op">=</span> <span class="va">top</span> <span class="op">~</span>  <span class="fl">0.06</span>,
  toppm <span class="op">=</span> <span class="va">toppm</span> <span class="op">~</span> <span class="fl">0.005</span>,
  
  
  
  <span class="co"># PORTFOLIO PARAMETERS</span>
  
  <span class="co"># (note that the sfcr package does not evaluate variables defined in the global environment when setting the external variables.</span>
  <span class="co"># Therefore, the parameters' values must be added by hand here.)</span>
  
  <span class="va">lambda10</span> <span class="op">~</span> <span class="op">-</span><span class="fl">0.17071</span>,
  <span class="va">lambda11</span> <span class="op">~</span> <span class="fl">0</span>,
  <span class="va">lambda12</span> <span class="op">~</span> <span class="fl">0</span>,
  <span class="va">lambda13</span> <span class="op">~</span> <span class="fl">0</span>,
  <span class="va">lambda14</span> <span class="op">~</span> <span class="fl">0</span>,
  <span class="va">lambda15</span> <span class="op">~</span> <span class="fl">0.18</span>,
  <span class="va">lambda20</span> <span class="op">~</span> <span class="fl">0.52245</span>,
  <span class="va">lambda21</span> <span class="op">~</span> <span class="fl">0</span>,
  <span class="va">lambda22</span> <span class="op">~</span> <span class="fl">30</span>,
  <span class="va">lambda23</span> <span class="op">~</span> <span class="op">-</span><span class="fl">15</span>,
  <span class="va">lambda24</span> <span class="op">~</span> <span class="op">-</span><span class="fl">15</span>,
  <span class="va">lambda25</span> <span class="op">~</span> <span class="op">-</span><span class="fl">0.06</span>,
  <span class="va">lambda30</span> <span class="op">~</span> <span class="fl">0.47311</span>,
  <span class="va">lambda31</span> <span class="op">~</span> <span class="fl">0</span>,
  <span class="va">lambda32</span> <span class="op">~</span> <span class="op">-</span><span class="fl">15</span>,
  <span class="va">lambda33</span> <span class="op">~</span> <span class="fl">30</span>,
  <span class="va">lambda34</span> <span class="op">~</span> <span class="op">-</span><span class="fl">15</span>,
  <span class="va">lambda35</span> <span class="op">~</span> <span class="op">-</span><span class="fl">0.06</span>,
  <span class="va">lambda40</span> <span class="op">~</span> <span class="fl">0.17515</span>,
  <span class="va">lambda41</span> <span class="op">~</span> <span class="fl">0</span>,
  <span class="va">lambda42</span> <span class="op">~</span> <span class="op">-</span><span class="fl">15</span>,
  <span class="va">lambda43</span> <span class="op">~</span> <span class="op">-</span><span class="fl">15</span>,
  <span class="va">lambda44</span> <span class="op">~</span> <span class="fl">30</span>,
  <span class="va">lambda45</span> <span class="op">~</span> <span class="op">-</span><span class="fl">0.06</span>
  
<span class="op">)</span></code></pre></div>
<p>And next the equations of the system:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout_eqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
  
  <span class="co"># Firm's behavioral equations</span>
  
  <span class="va">y</span> <span class="op">~</span> <span class="va">sE</span> <span class="op">+</span> <span class="op">(</span><span class="va">invE</span> <span class="op">-</span> <span class="va">inv</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
  <span class="va">N</span> <span class="op">~</span> <span class="va">y</span> <span class="op">/</span> <span class="va">pr</span>,
  <span class="va">WB</span> <span class="op">~</span> <span class="va">N</span> <span class="op">*</span> <span class="va">W</span>,
  <span class="va">UC</span> <span class="op">~</span> <span class="va">WB</span> <span class="op">/</span> <span class="va">y</span>,
  <span class="va">sE</span> <span class="op">~</span> <span class="va">beta</span> <span class="op">*</span> <span class="va">s</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">beta</span><span class="op">)</span> <span class="op">*</span> <span class="va">sE</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">invT</span> <span class="op">~</span> <span class="va">sigmaT</span> <span class="op">*</span> <span class="va">sE</span>,
  <span class="va">sigmaT</span> <span class="op">~</span> <span class="va">sigma0</span> <span class="op">-</span> <span class="va">sigma1</span> <span class="op">*</span> <span class="va">rl</span>,
  <span class="co">#rrl ~ ((1 + rl) / (1 + pi)) - 1,</span>
  <span class="va">invE</span> <span class="op">~</span> <span class="va">inv</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">gamma</span> <span class="op">*</span> <span class="op">(</span><span class="va">invT</span> <span class="op">-</span> <span class="va">inv</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
  <span class="va">p</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">tau</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">phi</span><span class="op">)</span> <span class="op">*</span> <span class="va">NHUC</span>,
  <span class="va">NHUC</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">sigmaT</span><span class="op">)</span> <span class="op">*</span> <span class="va">UC</span> <span class="op">+</span> <span class="va">sigmaT</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">rl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">UC</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="co">## rl[-1] instead of rl</span>
  <span class="co"># FXfE ~ (phi / (1 + phi)) * (1 / (1 + tau)) * p * sE,</span>
  <span class="co"># OK</span>
  
  <span class="co"># Firm's realized outcomes</span>
  
  <span class="va">s</span> <span class="op">~</span> <span class="va">c</span> <span class="op">+</span> <span class="va">g</span>,
  <span class="va">S</span> <span class="op">~</span> <span class="va">s</span> <span class="op">*</span> <span class="va">p</span>,
  <span class="va">inv</span> <span class="op">~</span> <span class="va">inv</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">y</span> <span class="op">-</span> <span class="va">s</span>,
  <span class="va">sigmas</span> <span class="op">~</span> <span class="va">inv</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">s</span>,
  <span class="va">INV</span> <span class="op">~</span> <span class="va">inv</span> <span class="op">*</span> <span class="va">UC</span>,
  <span class="va">Ld</span> <span class="op">~</span> <span class="va">INV</span>,
  <span class="va">FXf</span> <span class="op">~</span> <span class="va">S</span> <span class="op">-</span> <span class="va">TX</span> <span class="op">-</span> <span class="va">WB</span> <span class="op">+</span> <span class="op">(</span><span class="va">INV</span> <span class="op">-</span> <span class="va">INV</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="va">rl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">INV</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="co"># rl[-1] instead of rl</span>
  <span class="va">pi</span> <span class="op">~</span> <span class="op">(</span><span class="va">p</span> <span class="op">/</span> <span class="va">p</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,
  <span class="co"># OK</span>
  
  <span class="co"># Households realized outcomes</span>
  
  <span class="va">YDr</span> <span class="op">~</span> <span class="va">FX</span> <span class="op">+</span> <span class="va">WB</span> <span class="op">+</span> <span class="va">rm</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">M2h</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">rb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bhh</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">BLh</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="co">## Here's a mistake in Zezza's code. It should be M2h[-1] as in G&amp;L and NOT M2d.</span>
  <span class="va">CG</span> <span class="op">~</span> <span class="op">(</span><span class="va">pbl</span> <span class="op">-</span> <span class="va">pbl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">BLh</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">YDhs</span> <span class="op">~</span> <span class="va">YDr</span> <span class="op">+</span> <span class="va">CG</span>,
  <span class="va">FX</span> <span class="op">~</span> <span class="va">FXf</span> <span class="op">+</span> <span class="va">FXb</span>,
  <span class="va">V</span> <span class="op">~</span> <span class="va">V</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">YDhs</span> <span class="op">-</span> <span class="va">C</span>,
  <span class="va">Vnc</span> <span class="op">~</span> <span class="va">V</span> <span class="op">-</span> <span class="va">Hhh</span>, <span class="co">## Zezza writes it as Hhd instead of Hhh. Here it is harmless, but theoretically it should be Hhh and not Hhd as what matters for wealth net of cash is the realized holdings of cash.</span>
  <span class="va">ydr</span> <span class="op">~</span> <span class="va">YDr</span><span class="op">/</span><span class="va">p</span> <span class="op">-</span> <span class="va">pi</span> <span class="op">*</span> <span class="op">(</span><span class="va">V</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">p</span><span class="op">)</span>,
  <span class="va">ydhs</span> <span class="op">~</span> <span class="op">(</span><span class="va">YDr</span> <span class="op">-</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">V</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">CG</span><span class="op">)</span> <span class="op">/</span> <span class="va">p</span>,
  <span class="co">#ydhs ~ c + v - v[-1], # Equation 10.27A</span>
  <span class="va">v</span> <span class="op">~</span> <span class="va">V</span><span class="op">/</span><span class="va">p</span>,
  <span class="co"># OK</span>
  
  <span class="co"># Households behavioral</span>
  
  <span class="va">c</span> <span class="op">~</span> <span class="va">alpha0</span> <span class="op">+</span> <span class="va">alpha1</span> <span class="op">*</span> <span class="va">ydrE</span> <span class="op">+</span> <span class="va">alpha2</span> <span class="op">*</span> <span class="va">v</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">ydrE</span> <span class="op">~</span> <span class="va">epsilon</span> <span class="op">*</span> <span class="va">ydr</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">epsilon</span><span class="op">)</span> <span class="op">*</span> <span class="va">ydrE</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">C</span> <span class="op">~</span> <span class="va">p</span> <span class="op">*</span> <span class="va">c</span>,
  <span class="va">YDrE</span> <span class="op">~</span> <span class="va">p</span> <span class="op">*</span> <span class="va">ydrE</span> <span class="op">+</span> <span class="va">pi</span> <span class="op">*</span> <span class="op">(</span><span class="va">V</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">p</span><span class="op">)</span>,
  <span class="va">VE</span> <span class="op">~</span> <span class="va">V</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">YDrE</span> <span class="op">-</span> <span class="va">C</span><span class="op">)</span>, 
  <span class="va">Hhd</span> <span class="op">~</span> <span class="va">lambdac</span> <span class="op">*</span> <span class="va">C</span>,
  <span class="va">VncE</span> <span class="op">~</span> <span class="va">VE</span> <span class="op">-</span> <span class="va">Hhd</span>,
  <span class="va">ERrbl</span> <span class="op">~</span> <span class="va">rbl</span>, <span class="co">## ERrbl is not on the list of equations. I kept it simple.</span>
  <span class="co"># OK</span>
  
  <span class="co"># Households' portfolio equations</span>
  
  <span class="co"># There's no M1d equation in Zezza's code as they are not necessary</span>
  <span class="va">M2d</span> <span class="op">~</span> <span class="va">VncE</span> <span class="op">*</span> <span class="op">(</span><span class="va">lambda20</span> <span class="op">+</span> <span class="va">lambda22</span> <span class="op">*</span> <span class="va">rm</span> <span class="op">+</span> <span class="va">lambda23</span> <span class="op">*</span> <span class="va">rb</span> <span class="op">+</span> <span class="va">lambda24</span> <span class="op">*</span> <span class="va">ERrbl</span> <span class="op">+</span> <span class="va">lambda25</span> <span class="op">*</span> <span class="op">(</span><span class="va">YDrE</span> <span class="op">/</span> <span class="va">VncE</span><span class="op">)</span><span class="op">)</span>,
  <span class="va">Bhd</span> <span class="op">~</span> <span class="va">VncE</span> <span class="op">*</span> <span class="op">(</span><span class="va">lambda30</span> <span class="op">+</span> <span class="va">lambda32</span> <span class="op">*</span> <span class="va">rm</span> <span class="op">+</span> <span class="va">lambda33</span> <span class="op">*</span> <span class="va">rb</span> <span class="op">+</span> <span class="va">lambda34</span> <span class="op">*</span> <span class="va">ERrbl</span> <span class="op">+</span> <span class="va">lambda35</span> <span class="op">*</span> <span class="op">(</span><span class="va">YDrE</span> <span class="op">/</span> <span class="va">VncE</span><span class="op">)</span><span class="op">)</span>,
  <span class="va">BLd</span> <span class="op">~</span> <span class="op">(</span><span class="va">VncE</span> <span class="op">/</span> <span class="va">pbl</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">lambda40</span> <span class="op">+</span> <span class="va">lambda42</span> <span class="op">*</span> <span class="va">rm</span> <span class="op">+</span> <span class="va">lambda43</span> <span class="op">*</span> <span class="va">rb</span> <span class="op">+</span> <span class="va">lambda44</span> <span class="op">*</span> <span class="va">ERrbl</span> <span class="op">+</span> <span class="va">lambda45</span> <span class="op">*</span> <span class="op">(</span><span class="va">YDrE</span> <span class="op">/</span> <span class="va">VncE</span><span class="op">)</span><span class="op">)</span>,
  <span class="co"># OK</span>
  
  <span class="co"># However, it is a good exercise to write them down. If all values are correct, the equations </span>
  <span class="co"># below must be equal.</span>
  <span class="va">M1d</span> <span class="op">~</span> <span class="va">VncE</span> <span class="op">*</span> <span class="op">(</span><span class="va">lambda10</span> <span class="op">+</span> <span class="va">lambda12</span> <span class="op">*</span> <span class="va">rm</span> <span class="op">+</span> <span class="va">lambda13</span> <span class="op">*</span> <span class="va">rb</span> <span class="op">+</span> <span class="va">lambda14</span> <span class="op">*</span> <span class="va">ERrbl</span> <span class="op">+</span> <span class="va">lambda15</span> <span class="op">*</span> <span class="op">(</span><span class="va">YDrE</span> <span class="op">/</span> <span class="va">VncE</span><span class="op">)</span><span class="op">)</span>,
  <span class="va">M1d2</span> <span class="op">~</span> <span class="va">VncE</span> <span class="op">-</span> <span class="va">M2d</span> <span class="op">-</span> <span class="va">Bhd</span> <span class="op">-</span> <span class="va">pbl</span> <span class="op">*</span> <span class="va">BLd</span>,
  
  
  <span class="co"># Realized portfolio asset holdings</span>
  
  <span class="co"># Bhs ~ Bhd, # Not explicit in GL</span>
  <span class="va">Hhh</span> <span class="op">~</span> <span class="va">Hhd</span>, 
  <span class="va">Bhh</span> <span class="op">~</span> <span class="va">Bhd</span>,  
  <span class="va">BLh</span> <span class="op">~</span> <span class="va">BLd</span>,  
  <span class="va">M1hN</span> <span class="op">~</span> <span class="va">Vnc</span> <span class="op">-</span> <span class="va">M2d</span> <span class="op">-</span> <span class="va">Bhd</span> <span class="op">-</span> <span class="va">pbl</span> <span class="op">*</span> <span class="va">BLd</span>,
  <span class="va">z1</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="va">M1hN</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="fl">0</span><span class="op">}</span>,
  <span class="va">z2</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">z1</span>,
  <span class="va">M1h</span> <span class="op">~</span> <span class="va">M1hN</span> <span class="op">*</span> <span class="va">z1</span>,
  <span class="va">M2hN</span> <span class="op">~</span> <span class="va">M2d</span>,
  <span class="va">M2h</span> <span class="op">~</span> <span class="va">M2d</span> <span class="op">*</span> <span class="va">z1</span> <span class="op">+</span> <span class="op">(</span><span class="va">Vnc</span> <span class="op">-</span> <span class="va">Bhh</span> <span class="op">-</span> <span class="va">pbl</span> <span class="op">*</span> <span class="va">BLd</span><span class="op">)</span> <span class="op">*</span> <span class="va">z2</span>,
  <span class="co"># OK</span>
  
  <span class="co"># Government's equations</span>
  
  <span class="va">TX</span> <span class="op">~</span> <span class="va">S</span> <span class="op">*</span> <span class="op">(</span><span class="va">tau</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">tau</span><span class="op">)</span><span class="op">)</span>,
  <span class="va">G</span> <span class="op">~</span> <span class="va">p</span> <span class="op">*</span> <span class="va">g</span>,
  <span class="va">PSBR</span> <span class="op">~</span> <span class="va">G</span> <span class="op">+</span> <span class="va">rb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">BLs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="op">(</span><span class="va">TX</span> <span class="op">+</span> <span class="va">FXcb</span><span class="op">)</span>,
  <span class="va">Bs</span> <span class="op">~</span> <span class="va">Bs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">PSBR</span> <span class="op">-</span> <span class="op">(</span><span class="va">BLs</span> <span class="op">-</span> <span class="va">BLs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">pbl</span>,
  <span class="va">BLs</span> <span class="op">~</span> <span class="va">BLd</span>,
  <span class="va">pbl</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">rbl</span>,
  
  <span class="va">GD</span> <span class="op">~</span> <span class="va">GD</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">PSBR</span>, <span class="co"># Not in the equations list, but I added to check BS consistency</span>
  <span class="co"># OK</span>
  
  <span class="co"># Central bank's equations</span>
  
  <span class="va">Hs</span> <span class="op">~</span> <span class="va">Bcb</span> <span class="op">+</span> <span class="va">As</span>,
  <span class="va">Hbs</span> <span class="op">~</span> <span class="va">Hs</span> <span class="op">-</span> <span class="va">Hhs</span>,
  <span class="va">Bcb</span> <span class="op">~</span> <span class="va">Bs</span> <span class="op">-</span> <span class="va">Bhh</span> <span class="op">-</span> <span class="va">Bbd</span>,
  <span class="va">As</span> <span class="op">~</span> <span class="va">Ad</span>,
  <span class="va">ra</span> <span class="op">~</span> <span class="va">rb</span>,
  <span class="va">FXcb</span> <span class="op">~</span> <span class="va">rb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bcb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ra</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">As</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="co"># OK</span>
  
  <span class="co"># Bank's realized (supply) equations</span>
  
  <span class="va">Hhs</span> <span class="op">~</span> <span class="va">Hhd</span>,
  <span class="va">M1s</span> <span class="op">~</span> <span class="va">M1h</span>, <span class="co">## M1h instead of M1d as in Zezza. Bank's supply the realized portfolio holdings and NOT its notional demand.</span>
  <span class="va">M2s</span> <span class="op">~</span> <span class="va">M2h</span>, <span class="co">## M2h instead of M2d as in Zezza. Bank's supply the realized portfolio holdings and NOT its notional demand.</span>
  
  <span class="co"># Otherwise, the model would not close because M1d depends on EXPECTED wealth but the REALIZED demand for deposits depends</span>
  <span class="co"># on REALIZED wealth. It is a residual variable. The bank's supply the deposits that are ACTUALLY needed.</span>
  <span class="co"># You can check that M1d, however measured, only equals M1h in the stationary state.</span>
  
  <span class="va">Ls</span> <span class="op">~</span> <span class="va">Ld</span>,
  <span class="va">Hbd</span> <span class="op">~</span> <span class="va">ro1</span> <span class="op">*</span> <span class="va">M1s</span> <span class="op">+</span> <span class="va">ro2</span> <span class="op">*</span> <span class="va">M2s</span>,
  <span class="co"># OK</span>
  
  <span class="co"># Bank's balance sheet constraints</span>
  
  <span class="va">BbdN</span> <span class="op">~</span> <span class="va">M1s</span> <span class="op">+</span> <span class="va">M2s</span> <span class="op">-</span> <span class="va">Ls</span> <span class="op">-</span> <span class="va">Hbd</span>,
  <span class="va">BLRN</span> <span class="op">~</span> <span class="va">BbdN</span> <span class="op">/</span> <span class="op">(</span><span class="va">M1s</span> <span class="op">+</span> <span class="va">M2s</span><span class="op">)</span>,
  <span class="va">Ad</span> <span class="op">~</span> <span class="op">(</span><span class="va">bot</span> <span class="op">*</span> <span class="op">(</span><span class="va">M1s</span> <span class="op">+</span> <span class="va">M2s</span><span class="op">)</span> <span class="op">-</span> <span class="va">BbdN</span><span class="op">)</span> <span class="op">*</span> <span class="va">z3</span>, <span class="co">## Z3 instead of Z4</span>
  <span class="va">z3</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="va">BLRN</span> <span class="op">&lt;</span> <span class="va">bot</span><span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="fl">0</span><span class="op">}</span>,
  <span class="va">Bbd</span> <span class="op">~</span> <span class="va">Ad</span> <span class="op">+</span> <span class="va">M1s</span> <span class="op">+</span> <span class="va">M2s</span> <span class="op">-</span> <span class="va">Ls</span> <span class="op">-</span> <span class="va">Hbd</span>,
  <span class="va">BLR</span> <span class="op">~</span> <span class="va">Bbd</span> <span class="op">/</span> <span class="op">(</span><span class="va">M1s</span> <span class="op">+</span> <span class="va">M2s</span><span class="op">)</span>,
  <span class="co"># OK</span>
  
  <span class="co"># Determination of interest rates by banks</span>
  
  <span class="va">rm</span> <span class="op">~</span> <span class="va">rm</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">zetam</span> <span class="op">*</span> <span class="op">(</span><span class="va">z4</span> <span class="op">-</span> <span class="va">z5</span><span class="op">)</span> <span class="op">+</span> <span class="va">zetab</span> <span class="op">*</span> <span class="op">(</span><span class="va">rb</span> <span class="op">-</span> <span class="va">rb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
  <span class="va">z4</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="va">BLRN</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">bot</span><span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="fl">0</span><span class="op">}</span>,
  <span class="va">z5</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="va">BLRN</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">&gt;</span> <span class="va">top</span><span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="fl">0</span><span class="op">}</span>,
  <span class="va">FXb</span> <span class="op">~</span> <span class="va">rl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Ls</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">rb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Bbd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">rm</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">M2s</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">ra</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">Ad</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">rl</span> <span class="op">~</span> <span class="va">rl</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">zetal</span> <span class="op">*</span> <span class="op">(</span><span class="va">z6</span> <span class="op">-</span> <span class="va">z7</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">rb</span> <span class="op">-</span> <span class="va">rb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
  <span class="va">z6</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="va">BPM</span> <span class="op">&lt;</span> <span class="va">botpm</span><span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="fl">0</span><span class="op">}</span>,
  <span class="va">z7</span> <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="va">BPM</span> <span class="op">&gt;</span> <span class="va">toppm</span><span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="fl">0</span><span class="op">}</span>,
  <span class="co"># Since the sfcr package does not accept more than 1 lag directly,</span>
  <span class="co"># we need to create two auxiliary values that are lags of endogenous</span>
  <span class="co"># variables and then take the lag of these variables</span>
  <span class="va">lM1s</span> <span class="op">~</span> <span class="va">M1s</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">lM2s</span> <span class="op">~</span> <span class="va">M2s</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
  <span class="va">BPM</span> <span class="op">~</span> <span class="op">(</span><span class="va">FXb</span> <span class="op">+</span> <span class="va">FXb</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">lM1s</span> <span class="op">+</span> <span class="va">lM1s</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">lM2s</span> <span class="op">+</span> <span class="va">lM2s</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
  <span class="co"># OK</span>
  
  <span class="co"># Inflationary forces</span>
  
  <span class="co">#omegaT ~ Omega0 + Omega1 * pr + Omega2 * (N / Nfe),</span>
  <span class="va">omegaT</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">Omega0</span> <span class="op">+</span> <span class="va">Omega1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">pr</span><span class="op">)</span> <span class="op">+</span> <span class="va">Omega2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">N</span> <span class="op">/</span> <span class="va">Nfe</span><span class="op">)</span><span class="op">)</span>, <span class="co">## Zezza's equation</span>
  
  <span class="co"># The model explodes if G&amp;L's definition of omegaT is used.</span>
  
  <span class="va">W</span> <span class="op">~</span> <span class="va">W</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">Omega3</span> <span class="op">*</span> <span class="op">(</span><span class="va">omegaT</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="op">(</span><span class="va">W</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">p</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  <span class="co"># Nfe ~ s / pr, ## Zezza's definition in model DISINF. Doesn't work here.</span>
  <span class="co"># Nfe ~ s[-1] / pr, ## One possible solution</span>
  <span class="va">Y</span> <span class="op">~</span> <span class="va">p</span> <span class="op">*</span> <span class="va">s</span> <span class="op">+</span> <span class="va">UC</span> <span class="op">*</span> <span class="op">(</span><span class="va">inv</span> <span class="op">-</span> <span class="va">inv</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
  
<span class="op">)</span></code></pre></div>
<p>As usual, let’s make a helper function to simplify the plotting:</p>
<p>(programming tip: keep coming back to this function and adding the names and the transformations you want. The final version will have all the transformations you use in your analysis)</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">do_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span>, <span class="va">variables</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="co"># The lookup_names table has the code of the variables</span>
  <span class="co"># and the name I wanted displayed in the Figures.</span>
  
  
  <span class="va">lookup_names</span> <span class="op">&lt;-</span> <span class="fu">tribble</span><span class="op">(</span>
    <span class="op">~</span><span class="va">name</span>, <span class="op">~</span><span class="va">Var</span>,
    <span class="st">"dBhh"</span>, <span class="st">"HH. Bills"</span>,
    <span class="st">"dV"</span>, <span class="st">"Wealth"</span>,
    <span class="st">"dM1s"</span>, <span class="st">"Checking deposits"</span>,
    <span class="st">"dM2s"</span>, <span class="st">"Time deposits"</span>,
    <span class="st">"dHhs"</span>, <span class="st">"Cash"</span>,
    <span class="st">"dBLh"</span>, <span class="st">"HH. Bonds"</span>,
    <span class="st">"yr"</span>, <span class="st">"Real output"</span>,
    <span class="st">"cr"</span>, <span class="st">"Real consumption"</span>,
    <span class="st">"ydr"</span>, <span class="st">"Real disposable income"</span>,
    <span class="st">"c"</span>, <span class="st">"Real consumption"</span>,
    <span class="st">"v"</span>, <span class="st">"Real wealth"</span>,
    <span class="st">"rm"</span>, <span class="st">"Interest on term deposits"</span>,
    <span class="st">"rb"</span>, <span class="st">"Interest on bills"</span>,
    <span class="st">"rl"</span>, <span class="st">"Interest on loans"</span>,
    <span class="st">"rbl"</span>, <span class="st">"Interest on bonds"</span>,
    <span class="st">"dLs"</span>, <span class="st">"Loans"</span>,
    <span class="st">"dM"</span>, <span class="st">"All money deposits"</span>,
    <span class="st">"M"</span>, <span class="st">"All money deposits"</span>,
    <span class="st">"dAs"</span>, <span class="st">"CB advances"</span>,
    <span class="st">"dHbs"</span>, <span class="st">"Reserves"</span>,
    <span class="st">"dBbd"</span>, <span class="st">"B. Bills"</span>,
    <span class="st">"BLRN"</span>, <span class="st">"Net bank liq. ratio"</span>,
    <span class="st">"BPM"</span>, <span class="st">"Bank profit margin"</span>,
    <span class="st">"dGb"</span>, <span class="st">"Government budget balance"</span>,
    <span class="st">"Bcb"</span>, <span class="st">"CB. Bills"</span>,
    <span class="st">"dPSBR"</span>, <span class="st">"Deflated PSBR"</span>,
    <span class="st">"pi"</span>, <span class="st">"Inflation"</span>,
    <span class="st">"gr"</span>, <span class="st">"Real govt. budget balance - Book"</span>,
    <span class="st">"gr2"</span>, <span class="st">"Real govt. budget balance - tav"</span>,
    <span class="st">"gr3"</span>, <span class="st">"Real govt. budget balance - cb adj."</span>,
    <span class="st">"BYR"</span>, <span class="st">"Debt to GDP ratio"</span>,
    <span class="st">"dCB"</span>, <span class="st">"Change in the CB' stock of bills"</span>,
    <span class="st">"ddAs"</span>, <span class="st">"Change in Advances to banks"</span>,
    <span class="st">"y"</span>, <span class="st">"Real output"</span>,
    <span class="st">"s"</span>, <span class="st">"Real sales"</span>
  <span class="op">)</span>
  
  <span class="va">model</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>yr <span class="op">=</span> <span class="va">y</span> <span class="op">/</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
           cr <span class="op">=</span> <span class="va">c</span> <span class="op">/</span> <span class="va">c</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
           dV <span class="op">=</span> <span class="va">V</span> <span class="op">-</span> <span class="va">V</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
           dM1s <span class="op">=</span> <span class="va">M1s</span> <span class="op">-</span> <span class="va">M1s</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
           dM2s <span class="op">=</span> <span class="va">M2s</span> <span class="op">-</span> <span class="va">M2s</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
           dBhh <span class="op">=</span> <span class="va">Bhh</span> <span class="op">-</span> <span class="va">Bhh</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
           dHhs <span class="op">=</span> <span class="va">Hhs</span> <span class="op">-</span> <span class="va">Hhs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
           dBLh <span class="op">=</span> <span class="op">(</span><span class="va">pbl</span> <span class="op">*</span> <span class="va">BLh</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">pbl</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">BLh</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
           dLs <span class="op">=</span> <span class="va">Ls</span> <span class="op">-</span> <span class="va">Ls</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
           M <span class="op">=</span> <span class="va">M1s</span> <span class="op">+</span> <span class="va">M2s</span>,
           dM <span class="op">=</span> <span class="va">M</span> <span class="op">-</span> <span class="va">M</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
           dAs <span class="op">=</span> <span class="va">As</span> <span class="op">-</span> <span class="va">As</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
           dHbs <span class="op">=</span> <span class="va">Hbs</span> <span class="op">-</span> <span class="va">Hbs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
           dBbd <span class="op">=</span> <span class="va">Bbd</span> <span class="op">-</span> <span class="va">Bbd</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
           dGb <span class="op">=</span> <span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="op">(</span><span class="va">PSBR</span> <span class="op">-</span> <span class="va">PSBR</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
           dPSBR <span class="op">=</span> <span class="va">PSBR</span> <span class="op">/</span> <span class="va">p</span>,
           tav <span class="op">=</span> <span class="op">(</span><span class="va">p</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">p</span>,
           gr <span class="op">=</span> <span class="op">(</span><span class="op">(</span><span class="va">p</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">Bs</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">BLs</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">pbl</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="va">PSBR</span><span class="op">)</span> <span class="op">/</span> <span class="va">p</span>,
           gr2 <span class="op">=</span> <span class="op">(</span><span class="va">tav</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">Bs</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">BLs</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">pbl</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="va">PSBR</span><span class="op">)</span> <span class="op">/</span> <span class="va">p</span>,
           gr3 <span class="op">=</span> <span class="op">(</span><span class="va">tav</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">Bs</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">Bcb</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">BLs</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">pbl</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">As</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="va">PSBR</span><span class="op">)</span><span class="op">/</span><span class="va">p</span>,
           BYR <span class="op">=</span> <span class="op">(</span><span class="va">Bs</span> <span class="op">+</span> <span class="va">pbl</span> <span class="op">*</span> <span class="va">BLs</span><span class="op">)</span> <span class="op">/</span> <span class="va">Y</span>,
           dCB <span class="op">=</span> <span class="va">Bcb</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">Bcb</span><span class="op">)</span>,
           ddAs <span class="op">=</span> <span class="va">As</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">As</span><span class="op">)</span>
           <span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">select</span><span class="op">(</span><span class="va">period</span>, <span class="fu">all_of</span><span class="op">(</span><span class="va">variables</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">period</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="co"># Left-join the lookup_names table</span>
    <span class="fu">left_join</span><span class="op">(</span><span class="va">lookup_names</span>, by <span class="op">=</span> <span class="st">"name"</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">mutate</span><span class="op">(</span>Var <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Var</span><span class="op">)</span>, <span class="va">name</span>, <span class="va">Var</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">Var</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">scale_color_brewer</span><span class="op">(</span><span class="st">"Variable"</span>, type <span class="op">=</span> <span class="st">'qual'</span>, palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>We are now ready to estimate the model:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span>
  equations <span class="op">=</span> <span class="va">insout_eqs</span>,
  external <span class="op">=</span> <span class="va">insout_ext</span>,
  periods <span class="op">=</span> <span class="fl">210</span>,
  initial <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">p</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">W</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">UC</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">BPM</span> <span class="op">~</span> <span class="fl">0.0035</span><span class="op">)</span>,
  hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hbd"</span> <span class="op">=</span> <span class="st">"Hbs"</span><span class="op">)</span>,
  tol <span class="op">=</span> <span class="fl">1e-15</span>
<span class="op">)</span></code></pre></div>
<p>Fulfilling the hidden equation is a good sign. But did the model arrive to a sensible steady state?</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">period</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="st">"y"</span>, <span class="st">"s"</span>, <span class="st">"inv"</span>, <span class="st">"pi"</span>, <span class="st">"Bs"</span>, <span class="st">"M1s"</span>, <span class="st">"M2s"</span>, <span class="st">"V"</span>, <span class="st">"INV"</span>, <span class="st">"FXf"</span>, <span class="st">"FXb"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT"</span>, subtitle <span class="op">=</span> <span class="st">"Stable steady state"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>So far, so good. But what about the variables that depend on <code>bot</code>, <code>top</code>, <code>botpm</code>, <code>toppm</code>? We need to check that the margins are not too tight. If they are, BLRN becomes a ping pong, as in the example below:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout_ext</span><span class="op">$</span><span class="va">top</span> <span class="op">&lt;-</span> <span class="va">top</span> <span class="op">~</span> <span class="fl">0.03</span>
<span class="va">insout_ext</span><span class="op">$</span><span class="va">bot</span> <span class="op">&lt;-</span> <span class="va">bot</span> <span class="op">~</span> <span class="fl">0.02</span>

<span class="va">pingpong</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_baseline.html">sfcr_baseline</a></span><span class="op">(</span>
  equations <span class="op">=</span> <span class="va">insout_eqs</span>,
  external <span class="op">=</span> <span class="va">insout_ext</span>,
  periods <span class="op">=</span> <span class="fl">200</span>,
  initial <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span><span class="va">p</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">W</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">UC</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>,
  hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hbd"</span> <span class="op">=</span> <span class="st">"Hbs"</span><span class="op">)</span>,
  tol <span class="op">=</span> <span class="fl">1e-25</span>,
  method <span class="op">=</span> <span class="st">"Broyden"</span>
<span class="op">)</span>

<span class="co"># Some values are cut out given the limits I set to this plot</span>
<span class="va">pingpong</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BLRN"</span>, <span class="st">"bot"</span>, <span class="st">"top"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Ping pong is bad because it prevents a stable steady state where we wanna run our scenarios.</p>
<p>Setting <code>top</code> to 0.1 solves the problem:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BLRN"</span>, <span class="st">"bot"</span>, <span class="st">"top"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>What about <code>BPM</code> and <code>toppm</code> and <code>botpm</code>?</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BPM"</span>, <span class="st">"toppm"</span>, <span class="st">"botpm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.01</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>Here we see that the margins are fine.</p>
<p>We can use the <code>sfcr</code> package to visualize the transactions-flow matrix as a Sankey’s diagram:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../reference/sfcr_sankey.html">sfcr_sankey</a></span><span class="op">(</span><span class="va">tfm_insout</span>, <span class="va">insout</span>, <span class="st">"start"</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-d75693d02628a95bf363" style="width:700px;height:432.632880098888px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-d75693d02628a95bf363">{"x":{"links":{"source":[20,23,22,21,21,21,26,24,26,26,23,23,27,20,27,27,20,20,25,27,20,0,1,2,3,4,5,6,7,9,10,11,11,11,12,14,15,16,17,18,19],"target":[0,1,2,3,4,5,6,7,9,10,11,12,14,15,15,16,17,18,18,18,19,29,29,29,31,28,28,28,31,29,28,28,32,34,28,30,33,28,35,31,31],"value":[23.96648,25.927834,0.397948,9.978863,34.415903,6.386997,0.411524,0.097802,0.4895,0.185905,1.42998,0.207498,0.397948,0.967192,0.481475,0.794522,5.609276,7.018212,1.448668,3.935331,5.086437,23.96648,25.927834,0.397948,9.978863,34.415903,6.386997,0.411524,0.097802,0.4895,0.185905,0.245249,0.097802,1.086929,0.207498,0.397948,1.448668,0.794522,5.609276,12.40221,5.086437]},"nodes":{"name":["Consumption","Govt. Expenditures","Ch. Inv","Taxes","Wages","Entrepreneurial profits","Bank profits","CB profits","int. advances","int. loans","int. deposits","int. bills","int. bonds","Ch. advances","Ch. loans","Ch. cash","Ch. M","Ch. M2","Ch. bills","Ch. bonds","Households","Firms current","Firms capital","Govt.","CB current","CB capital","Banks current","Banks capital","Households","Firms current","Firms capital","Govt.","CB current","CB capital","Banks current","Banks capital"],"group":["Consumption","Govt. Expenditures","Ch. Inv","Taxes","Wages","Entrepreneurial profits","Bank profits","CB profits","int. advances","int. loans","int. deposits","int. bills","int. bonds","Ch. advances","Ch. loans","Ch. cash","Ch. M","Ch. M2","Ch. bills","Ch. bonds","Households","Firms current","Firms capital","Govt.","CB current","CB capital","Banks current","Banks capital","Households","Firms current","Firms capital","Govt.","CB current","CB capital","Banks current","Banks capital"]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":14,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"dollars","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><p>Let’s take a look at the structure of this model:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_dag_cycles_plot.html">sfcr_dag_cycles_plot</a></span><span class="op">(</span><span class="va">insout_eqs</span>, size <span class="op">=</span> <span class="fl">7.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span>
<span class="va">p1</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-14-1.png" width="1056"></p>
<p>As can be seen, this model is entirely acyclical.</p>
<p>This plot shows a common problem in plotting SFC models as DAGs: they become too cluttered to be understandable. I provided a small workaround by changing the size of the points in the plots.</p>
<p>Let’s add scenarios to this model:</p>
<div id="simulation-1-an-increase-in-the-targeted-inventories-to-sale-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation-1-an-increase-in-the-targeted-inventories-to-sale-ratio" class="anchor"></a>Simulation 1: An increase in the targeted inventories to sale ratio</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
    <span class="va">sigma0</span> <span class="op">~</span> <span class="fl">0.4</span>
  <span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">70</span>
<span class="op">)</span>

<span class="va">insout1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span>
  baseline <span class="op">=</span> <span class="va">insout</span>,
  periods <span class="op">=</span> <span class="fl">70</span>,
  scenario <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">shock1</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout1</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"INV"</span>, <span class="st">"Ls"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'INSOUT1'</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of inventories and bank loans"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout1</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"yr"</span>, <span class="st">"cr"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT1"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of real consumption and output"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">period</span> <span class="op">&gt;</span> <span class="fl">2</span>, <span class="va">period</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dV"</span>, <span class="st">"dBhh"</span>, <span class="st">"dBLh"</span>, <span class="st">"dM1s"</span>, <span class="st">"dM2s"</span>, <span class="st">"dHhs"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#facet_wrap(~name, scales = "free_y") +</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT1"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of household wealth and its components"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout1</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rb"</span>, <span class="st">"rm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT1"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of short-term interest rates"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout1</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">period</span> <span class="op">&gt;</span> <span class="fl">3</span>, <span class="va">period</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dM"</span>, <span class="st">"dLs"</span>, <span class="st">"dAs"</span>, <span class="st">"dHbs"</span>, <span class="st">"dBbd"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT1"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of banks' balance sheet"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout1</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BLRN"</span>, <span class="st">"bot"</span>, <span class="st">"top"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT1"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of net bank liquidity ratio"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout1</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BPM"</span>, <span class="st">"toppm"</span>, <span class="st">"botpm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT1"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of the bank profitability margin"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout1</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="st">"dGb"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT1"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of the government budget balance"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout1</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="st">"Bcb"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT1"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of the stock of treasury bills hend by the central bank"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<p>I’ll run one sensitivity test here to show that there’s nothing in the model that prevents the interest rate on deposits to become higher than the interest rate on bills:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sigma0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.37</span>, <span class="fl">0.55</span>, <span class="fl">0.02</span><span class="op">)</span>

<span class="va">m.shock1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_expand.html">sfcr_expand</a></span><span class="op">(</span><span class="va">shock1</span>, <span class="st">"sigma0"</span>, <span class="va">sigma0</span><span class="op">)</span>

<span class="va">m.insout1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_multis.html">sfcr_multis</a></span><span class="op">(</span>
  expanded <span class="op">=</span> <span class="va">m.shock1</span>,
  fixed <span class="op">=</span> <span class="va">insout</span>, 
  periods <span class="op">=</span> <span class="fl">70</span>
  <span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span>

<span class="va">mypal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"GnBu"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>
<span class="va">mypal2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"OrRd"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>

<span class="va">m.insout1</span> <span class="op">%&gt;%</span>
  <span class="fu">bind_rows</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">simulation</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="va">ungroup</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">period</span>, <span class="va">simulation</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rm"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>inter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html">interaction</a></span><span class="op">(</span><span class="fu">as_factor</span><span class="op">(</span><span class="va">simulation</span><span class="op">)</span>, <span class="fu">as_factor</span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co">#mutate(inter = as.numeric(inter)) %&gt;%</span>
  <span class="co">#mutate(inter = interaction(simulation, name)) %&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">period</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"darksalmon"</span>, yintercept <span class="op">=</span> <span class="fl">0.023</span>, size <span class="op">=</span> <span class="fl">1.5</span>, alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">inter</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1.5</span>, alpha <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#facet_wrap(~simulation, scales = "free_y") +</span>
  <span class="co">#scale_colour_steps() +</span>
  <span class="fu">scale_color_manual</span><span class="op">(</span><span class="st">"Sigma 0"</span>, 
                     values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">mypal</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">sigma0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">sigma0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">4</span>, y <span class="op">=</span> <span class="fl">0.0235</span>, label <span class="op">=</span> <span class="st">"Rate on bills"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">47</span>, y <span class="op">=</span> <span class="fl">0.027</span>, label <span class="op">=</span> <span class="st">"Rate on deposits"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT1"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of short-term interest rates"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">guides</span><span class="op">(</span>color <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<p>This experiment shows that nothing <strong>prevents</strong> the interest rate on deposits to cross the interest rate on bills. However, one should also wonder about the economic meaning of the different <code>sigma0</code> values when judging the model.</p>
</div>
<div id="simulation-2-an-increase-in-pure-government-expenditure" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation-2-an-increase-in-pure-government-expenditure" class="anchor"></a>Simulation 2: An increase in pure government expenditure</h2>
<p>Let’s increase the real pure government expenditures by 20%:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
    <span class="va">g</span> <span class="op">~</span> <span class="fl">30</span>
  <span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">55</span>
<span class="op">)</span>


<span class="va">insout2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">insout</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">shock2</span><span class="op">)</span>, periods <span class="op">=</span> <span class="fl">55</span>, tol <span class="op">=</span> <span class="fl">1e-15</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout2</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="st">"v"</span>, <span class="st">"ydr"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">'INSOUT2'</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of HH. real consumption, disp. income, and wealth"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout2</span> <span class="op">%&gt;%</span>
  <span class="co">#mutate(PSBR = PSBR / p) %&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dPSBR"</span>, <span class="st">"PSBR"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT2"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of deflated PSBR"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<p>The next experiment checks the impact of an increase in government expenditures on the inflation rate. When I first tried this experiment, I defined <code>Nfe</code> as <code>s / pr</code>, as in model DISINF. With this definition, I was getting the strange result that an increase in <code>g</code> was actually deflationary. When I defined <code>Nfe</code> as an exogenous variable, the result was similar to the one found in <span class="citation">Godley and Lavoie (2007)</span>.</p>
<p>The reason is that <code>g</code> directly affect <code>s</code> is model INSOUT. Hence, an increase in <code>g</code> directly increase <code>Nfe</code>, while <code>N</code> reacts with a lag. The increase in the gap <code>N / Nfe</code> negatively affects <code>omegaT</code> (the target real wage of workers), which will ultimately lead to lower <code>W</code> and hence lower <code>UC</code>, affecting <code>NHUC</code> which ultimately affects <code>p</code>.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout2</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pi"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"INSOUT2"</span>,
    subtitle <span class="op">=</span> <span class="st">"Evolution of the price inflation rate"</span>
  <span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
<p>The following figure replicates Figure 10.2D in <span class="citation">Godley and Lavoie (2007, 353)</span>. However, I’m almost certain that there is a typo in the <em>real government budget balance</em> definition.</p>
<p>In the book, it is defined as:</p>
<p><span class="math display">\[
gr = \frac{-PSBR + (\Delta p) \cdot (B_{s-1} + BL_{s-1} * p_{bL-1})}{p}
\]</span></p>
<p>I think that the correct definition should be:</p>
<p><span class="math display">\[
gr2 = \frac{-PSBR + tav \cdot (B_{s-1} + BL_{s-1} * p_{bL-1})}{p}
\]</span></p>
<p>where <span class="math inline">\(tav = (\Delta p) / p\)</span>.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout2</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gr"</span>, <span class="st">"gr2"</span>, <span class="st">"gr3"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT2"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of the real budget balance"</span>,
       caption <span class="op">=</span> <span class="st">"Takes into account the capital gains due to the erosion of the public debt\n by price inflation."</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 3 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
<p>A possible third definition would remove the bills and the advances held by the BCB from the inflation capital gains. It seems reasonable to me and consistent with equation 10.96 <span class="citation">(Godley and Lavoie 2007)</span> [p. 368] that describes the steady state with inflation:</p>
<p><span class="math display">\[
g + \breve{r} \left[ v - in \cdot \frac{UC}{p} \right] - tav \left[ v - in \cdot \frac{UC}{p} \right] = \frac{T}{p} 
\]</span></p>
<p>However, as can be seen above, it does not converges to zero (although converges to a steady state). In the remaining of this notebook, I will use <code>gr2</code> definition</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout2</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="st">"BYR"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT2"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout2</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rl"</span>, <span class="st">"rm"</span>, <span class="st">"rb"</span>, <span class="st">"rbl"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT2"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of interest rates"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout2</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">period</span> <span class="op">&gt;</span> <span class="fl">3</span>, <span class="va">period</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dBbd"</span>, <span class="st">"dM1s"</span>, <span class="st">"dM2s"</span>, <span class="st">"dLs"</span>, <span class="st">"dHbs"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT2"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of banks' balance sheet"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout2</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BLRN"</span>, <span class="st">"top"</span>, <span class="st">"bot"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT2"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of the net bank liquidity ratio"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-35-1.png" width="700"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout2</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BPM"</span>, <span class="st">"toppm"</span>, <span class="st">"botpm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT2"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of the bank profitability margin"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-36-1.png" width="700"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout2</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dCB"</span>, <span class="st">"ddAs"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT2"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of the central bank balance sheet"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-37-1.png" width="700"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout2</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Bcb</span>, <span class="va">Bs</span>, <span class="va">Bhh</span>, <span class="va">Bbd</span><span class="op">)</span>, <span class="op">~</span><span class="va">.x</span> <span class="op">/</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bcb"</span>, <span class="st">"Bs"</span>, <span class="st">"Bhh"</span>, <span class="st">"Bbd"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT2"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of deflated bills"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-38-1.png" width="700"></p>
</div>
<div id="simulation-3-an-increase-in-the-compulsory-reserve-ratios" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation-3-an-increase-in-the-compulsory-reserve-ratios" class="anchor"></a>Simulation 3: An increase in the compulsory reserve ratios</h2>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
    <span class="va">ro1</span> <span class="op">~</span> <span class="fl">0.2</span>,
    <span class="va">ro2</span> <span class="op">~</span> <span class="fl">0.2</span>
  <span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">70</span>
<span class="op">)</span>

<span class="va">insout3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">insout</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">shock3</span><span class="op">)</span>, <span class="fl">70</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout3</span> <span class="op">%&gt;%</span>
  <span class="co">#select(period, M1s, M2s, As, Ls)</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">period</span> <span class="op">&gt;</span> <span class="fl">2</span>, <span class="va">period</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dM"</span>, <span class="st">"dLs"</span>, <span class="st">"dAs"</span>, <span class="st">"dHbs"</span>, <span class="st">"dBbd"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT3"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of banks' balance sheet"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-40-1.png" width="700"></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout3</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"top"</span>, <span class="st">"bot"</span>, <span class="st">"BLRN"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT3"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of net bank liquidity ratio"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-41-1.png" width="700"></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout3</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rm"</span>, <span class="st">"rb"</span>, <span class="st">"rl"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT3"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of interest rates"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-42-1.png" width="700"></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout3</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"toppm"</span>, <span class="st">"botpm"</span>, <span class="st">"BPM"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT3"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of bank profitability margin"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-43-1.png" width="700"></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout3</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT3"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of money deposits"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-44-1.png" width="700"></p>
</div>
<div id="simulation-4-an-increase-in-the-acceptable-bank-liquidity-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation-4-an-increase-in-the-acceptable-bank-liquidity-ratio" class="anchor"></a>Simulation 4: An increase in the acceptable bank liquidity ratio</h2>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
    <span class="va">top</span> <span class="op">~</span> <span class="fl">0.24</span>,
    <span class="va">bot</span> <span class="op">~</span> <span class="fl">0.2</span>
  <span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">70</span>
<span class="op">)</span>

<span class="va">insout4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">insout</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">shock4</span><span class="op">)</span>, <span class="fl">70</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout4</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="st">"BLRN"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">map</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="fl">0.06</span>, <span class="fl">0.2</span>, <span class="fl">0.24</span><span class="op">)</span>, <span class="op">~</span><span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">.x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT4"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of net bank liquidity ratio"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-46-1.png" width="700"></p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout4</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rl"</span>, <span class="st">"rb"</span>, <span class="st">"rm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT4"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of interest rates"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-47-1.png" width="700"></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout4</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dM"</span>, <span class="st">"dLs"</span>, <span class="st">"dAs"</span>, <span class="st">"dHbs"</span>, <span class="st">"dBbd"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT4"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of banks' balance sheet"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-48-1.png" width="700"></p>
</div>
<div id="simulation-5-a-decrease-in-the-propensity-to-consume-out-of-real-disposable-income" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation-5-a-decrease-in-the-propensity-to-consume-out-of-real-disposable-income" class="anchor"></a>Simulation 5: A decrease in the propensity to consume out of real disposable income</h2>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
    <span class="va">alpha1</span> <span class="op">~</span> <span class="fl">0.8</span>
  <span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">70</span>
<span class="op">)</span>

<span class="va">insout5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">insout</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">shock5</span><span class="op">)</span>, <span class="fl">70</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout5</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ydr"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT5"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of consumption and income"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-50-1.png" width="700"></p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout5</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="st">"gr2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT5"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 1 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-51-1.png" width="700"></p>
</div>
<div id="simulation-6-an-exogenous-increase-in-the-rate-of-inflation" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation-6-an-exogenous-increase-in-the-rate-of-inflation" class="anchor"></a>Simulation 6: An exogenous increase in the rate of inflation</h2>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
    <span class="va">Omega0</span> <span class="op">~</span> <span class="op">-</span><span class="fl">0.2</span>
  <span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">70</span>
<span class="op">)</span>

<span class="va">insout6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">insout</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">shock6</span><span class="op">)</span>, <span class="fl">70</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout6</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="st">"pi"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT6"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-53-1.png" width="700"></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout6</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="st">"s"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT6"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of output and sales"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-54-1.png" width="700"></p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout6</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dPSBR"</span>, <span class="st">"PSBR"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT6"</span>,
       subtitle <span class="op">=</span> <span class="st">"Evolution of public sector borrowing requirements"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-55-1.png" width="700"></p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout6</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gr"</span>, <span class="st">"gr2"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-56-1.png" width="700"></p>
</div>
<div id="simulation-7-increase-in-the-target-real-wage-followed-by-an-increase-in-interest-rates" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation-7-increase-in-the-target-real-wage-followed-by-an-increase-in-interest-rates" class="anchor"></a>Simulation 7: Increase in the target real wage followed by an increase in interest rates</h2>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">shock6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
    <span class="va">Omega0</span> <span class="op">~</span> <span class="op">-</span><span class="fl">0.2</span>
  <span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">4</span>,
  end <span class="op">=</span> <span class="fl">55</span>
<span class="op">)</span>

<span class="va">shock7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_shock.html">sfcr_shock</a></span><span class="op">(</span>
  variables <span class="op">=</span> <span class="fu"><a href="../../reference/sfcr_set.html">sfcr_set</a></span><span class="op">(</span>
    <span class="va">rb</span> <span class="op">~</span> <span class="fl">0.03</span>,
    <span class="va">rbl</span> <span class="op">~</span> <span class="fl">0.039</span>
  <span class="op">)</span>,
  start <span class="op">=</span> <span class="fl">5</span>,
  end <span class="op">=</span> <span class="fl">55</span>
<span class="op">)</span>

<span class="va">insout7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/sfcr_scenario.html">sfcr_scenario</a></span><span class="op">(</span><span class="va">insout</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">shock6</span>, <span class="va">shock7</span><span class="op">)</span>, <span class="fl">55</span>, tol <span class="op">=</span> <span class="fl">1e-30</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout7</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="st">"pi"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT7"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-58-1.png" width="700"></p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout7</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="st">"s"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT7"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-59-1.png" width="700"></p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout7</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>`Deflated government debt` <span class="op">=</span> <span class="op">(</span><span class="va">Bs</span> <span class="op">+</span> <span class="va">pbl</span> <span class="op">*</span> <span class="va">BLs</span><span class="op">)</span> <span class="op">/</span> <span class="va">p</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"v"</span>, <span class="st">"Deflated government debt"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT7"</span><span class="op">)</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-60-1.png" width="700"></p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">insout7</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>`deflated balance` <span class="op">=</span> <span class="op">-</span><span class="va">PSBR</span> <span class="op">/</span> <span class="va">p</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">do_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"deflated balance"</span>, <span class="st">"gr2"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"INSOUT7"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 1 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="insout_files/figure-html/unnamed-chunk-61-1.png" width="700"></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-godley2007monetary">
<p>Godley, Wynne, and Marc Lavoie. 2007. <em>Monetary Economics: An Integrated Approach to Credit, Money, Income, Production and Wealth</em>. Palgrave Macmillan.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Joao Macalos.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
